

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>10. Iforce Protocol &mdash; The Linux Kernel 5.11.0+ documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="11. Parallel Port Joystick Drivers" href="joystick-parport.html" />
    <link rel="prev" title="9. Elantech Touchpad Driver" href="elantech.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicetree/index.html">Open Firmware and Device Tree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">The Linux Input Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../input_uapi.html">Linux Input Subsystem userspace API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input_kapi.html">Linux Input Subsystem kernel API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Driver-specific documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="alps.html">1. ALPS Touchpad Protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="amijoy.html">2. Amiga joystick extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="appletouch.html">3. Apple Touchpad Driver (appletouch)</a></li>
<li class="toctree-l3"><a class="reference internal" href="atarikbd.html">4. Intelligent Keyboard (ikbd) Protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="bcm5974.html">5. BCM5974 Driver (bcm5974)</a></li>
<li class="toctree-l3"><a class="reference internal" href="cma3000_d0x.html">6. CMA3000-D0x Accelerometer</a></li>
<li class="toctree-l3"><a class="reference internal" href="cs461x.html">7. Crystal SoundFusion CS4610/CS4612/CS461 joystick</a></li>
<li class="toctree-l3"><a class="reference internal" href="edt-ft5x06.html">8. EDT ft5x06 based Polytouch devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="elantech.html">9. Elantech Touchpad Driver</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">10. Iforce Protocol</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">10.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#preliminary-notes">10.2. Preliminary Notes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#device-input-state">10.3. Device input state</a></li>
<li class="toctree-l4"><a class="reference internal" href="#device-effects-states">10.4. Device effects states</a></li>
<li class="toctree-l4"><a class="reference internal" href="#appendix-how-to-study-the-protocol">10.5. Appendix: How to study the protocol?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#urls">10.6. URLS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="joystick-parport.html">11. Parallel Port Joystick Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="ntrig.html">12. N-Trig touchscreen Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="pxrc.html">13. pxrc - PhoenixRC Flight Controller Adapter</a></li>
<li class="toctree-l3"><a class="reference internal" href="rotary-encoder.html">14. rotary-encoder - a generic driver for GPIO connected devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="sentelic.html">15. Sentelic Touchpad</a></li>
<li class="toctree-l3"><a class="reference internal" href="walkera0701.html">16. Walkera WK-0701 transmitter</a></li>
<li class="toctree-l3"><a class="reference internal" href="xpad.html">17. xpad - Linux USB driver for Xbox compatible controllers</a></li>
<li class="toctree-l3"><a class="reference internal" href="yealink.html">18. Driver documentation for yealink usb-p1k phones</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mhi/index.html">MHI</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arm/index.html">ARM Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../arm64/index.html">ARM64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ia64/index.html">IA-64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../m68k/index.html">m68k Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mips/index.html">MIPS-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nios2/index.html">Nios II Specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openrisc/index.html">OpenRISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parisc/index.html">PA-RISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../powerpc/index.html">powerpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../riscv/index.html">RISC-V architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../s390/index.html">s390 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sparc/index.html">Sparc Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../x86/index.html">x86-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../xtensa/index.html">Xtensa Architecture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../filesystems/ext4/index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html">Unsorted Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html#atomic-types">Atomic Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html#atomic-bitops">Atomic bitops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html#memory-barriers">Memory Barriers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../watch_queue.html">General notification mechanism</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">The Linux Input Documentation</a> &raquo;</li>
        
          <li><a href="index.html">Driver-specific documentation</a> &raquo;</li>
        
      <li><span class="section-number">10. </span>Iforce Protocol</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/input/devices/iforce-protocol.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="iforce-protocol">
<h1><span class="section-number">10. </span>Iforce Protocol<a class="headerlink" href="#iforce-protocol" title="Permalink to this headline">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Johann Deneux &lt;<a class="reference external" href="mailto:johann&#46;deneux&#37;&#52;&#48;gmail&#46;com">johann<span>&#46;</span>deneux<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
</dd>
</dl>
<p>Home page at <a class="reference external" href="http://web.archive.org/web/*/http://www.esil.univ-mrs.fr">http://web.archive.org/web/*/http://www.esil.univ-mrs.fr</a></p>
<dl class="field-list simple">
<dt class="field-odd">Additions</dt>
<dd class="field-odd"><p>by Vojtech Pavlik.</p>
</dd>
</dl>
<div class="section" id="introduction">
<h2><span class="section-number">10.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This document describes what I managed to discover about the protocol used to
specify force effects to I-Force 2.0 devices.  None of this information comes
from Immerse. That’s why you should not trust what is written in this
document. This document is intended to help understanding the protocol.
This is not a reference. Comments and corrections are welcome.  To contact me,
send an email to: <a class="reference external" href="mailto:johann&#46;deneux&#37;&#52;&#48;gmail&#46;com">johann<span>&#46;</span>deneux<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>I shall not be held responsible for any damage or harm caused if you try to
send data to your I-Force device based on what you read in this document.</p>
</div>
</div>
<div class="section" id="preliminary-notes">
<h2><span class="section-number">10.2. </span>Preliminary Notes<a class="headerlink" href="#preliminary-notes" title="Permalink to this headline">¶</a></h2>
<p>All values are hexadecimal with big-endian encoding (msb on the left). Beware,
values inside packets are encoded using little-endian.  Bytes whose roles are
unknown are marked ???  Information that needs deeper inspection is marked (?)</p>
<div class="section" id="general-form-of-a-packet">
<h3><span class="section-number">10.2.1. </span>General form of a packet<a class="headerlink" href="#general-form-of-a-packet" title="Permalink to this headline">¶</a></h3>
<p>This is how packets look when the device uses the rs232 to communicate.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 23%" />
<col style="width: 31%" />
<col style="width: 15%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>2B</p></td>
<td><p>OP</p></td>
<td><p>LEN</p></td>
<td><p>DATA</p></td>
<td><p>CS</p></td>
</tr>
</tbody>
</table>
<p>CS is the checksum. It is equal to the exclusive or of all bytes.</p>
<p>When using USB:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 67%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>OP</p></td>
<td><p>DATA</p></td>
</tr>
</tbody>
</table>
<p>The 2B, LEN and CS fields have disappeared, probably because USB handles
frames and data corruption is handled or unsignificant.</p>
<p>First, I describe effects that are sent by the device to the computer</p>
</div>
</div>
<div class="section" id="device-input-state">
<h2><span class="section-number">10.3. </span>Device input state<a class="headerlink" href="#device-input-state" title="Permalink to this headline">¶</a></h2>
<p>This packet is used to indicate the state of each button and the value of each
axis:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OP= 01 for a joystick, 03 for a wheel
LEN= Varies from device to device
00 X-Axis lsb
01 X-Axis msb
02 Y-Axis lsb, or gas pedal for a wheel
03 Y-Axis msb, or brake pedal for a wheel
04 Throttle
05 Buttons
06 Lower 4 bits: Buttons
   Upper 4 bits: Hat
07 Rudder
</pre></div>
</div>
</div>
<div class="section" id="device-effects-states">
<h2><span class="section-number">10.4. </span>Device effects states<a class="headerlink" href="#device-effects-states" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OP= 02
LEN= Varies
00 ? Bit 1 (Value 2) is the value of the deadman switch
01 Bit 8 is set if the effect is playing. Bits 0 to 7 are the effect id.
02 ??
03 Address of parameter block changed (lsb)
04 Address of parameter block changed (msb)
05 Address of second parameter block changed (lsb)
... depending on the number of parameter blocks updated
</pre></div>
</div>
<div class="section" id="force-effect">
<h3><span class="section-number">10.4.1. </span>Force effect<a class="headerlink" href="#force-effect" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OP=  01
LEN= 0e
00 Channel (when playing several effects at the same time, each must
            be assigned a channel)
01 Wave form
        Val 00 Constant
        Val 20 Square
        Val 21 Triangle
        Val 22 Sine
        Val 23 Sawtooth up
        Val 24 Sawtooth down
        Val 40 Spring (Force = f(pos))
        Val 41 Friction (Force = f(velocity)) and Inertia
               (Force = f(acceleration))


02 Axes affected and trigger
        Bits 4-7: Val 2 = effect along one axis. Byte 05 indicates direction
                Val 4 = X axis only. Byte 05 must contain 5a
                Val 8 = Y axis only. Byte 05 must contain b4
                Val c = X and Y axes. Bytes 05 must contain 60
        Bits 0-3: Val 0 = No trigger
                Val x+1 = Button x triggers the effect
        When the whole byte is 0, cancel the previously set trigger

03-04 Duration of effect (little endian encoding, in ms)

05 Direction of effect, if applicable. Else, see 02 for value to assign.

06-07 Minimum time between triggering.

08-09 Address of periodicity or magnitude parameters
0a-0b Address of attack and fade parameters, or ffff if none.
*or*
08-09 Address of interactive parameters for X-axis,
      or ffff if not applicable
0a-0b Address of interactive parameters for Y-axis,
      or ffff if not applicable

0c-0d Delay before execution of effect (little endian encoding, in ms)
</pre></div>
</div>
</div>
<div class="section" id="time-based-parameters">
<h3><span class="section-number">10.4.2. </span>Time based parameters<a class="headerlink" href="#time-based-parameters" title="Permalink to this headline">¶</a></h3>
<div class="section" id="attack-and-fade">
<h4><span class="section-number">10.4.2.1. </span>Attack and fade<a class="headerlink" href="#attack-and-fade" title="Permalink to this headline">¶</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OP=  02
LEN= 08
00-01 Address where to store the parameters
02-03 Duration of attack (little endian encoding, in ms)
04 Level at end of attack. Signed byte.
05-06 Duration of fade.
07 Level at end of fade.
</pre></div>
</div>
</div>
<div class="section" id="magnitude">
<h4><span class="section-number">10.4.2.2. </span>Magnitude<a class="headerlink" href="#magnitude" title="Permalink to this headline">¶</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OP=  03
LEN= 03
00-01 Address
02 Level. Signed byte.
</pre></div>
</div>
</div>
<div class="section" id="periodicity">
<h4><span class="section-number">10.4.2.3. </span>Periodicity<a class="headerlink" href="#periodicity" title="Permalink to this headline">¶</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OP=  04
LEN= 07
00-01 Address
02 Magnitude. Signed byte.
03 Offset. Signed byte.
04 Phase. Val 00 = 0 deg, Val 40 = 90 degs.
05-06 Period (little endian encoding, in ms)
</pre></div>
</div>
</div>
</div>
<div class="section" id="interactive-parameters">
<h3><span class="section-number">10.4.3. </span>Interactive parameters<a class="headerlink" href="#interactive-parameters" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OP=  05
LEN= 0a
00-01 Address
02 Positive Coeff
03 Negative Coeff
04+05 Offset (center)
06+07 Dead band (Val 01F4 = 5000 (decimal))
08 Positive saturation (Val 0a = 1000 (decimal) Val 64 = 10000 (decimal))
09 Negative saturation
</pre></div>
</div>
<p>The encoding is a bit funny here: For coeffs, these are signed values. The
maximum value is 64 (100 decimal), the min is 9c.
For the offset, the minimum value is FE0C, the maximum value is 01F4.
For the deadband, the minimum value is 0, the max is 03E8.</p>
</div>
<div class="section" id="controls">
<h3><span class="section-number">10.4.4. </span>Controls<a class="headerlink" href="#controls" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OP=  41
LEN= 03
00 Channel
01 Start/Stop
        Val 00: Stop
        Val 01: Start and play once.
        Val 41: Start and play n times (See byte 02 below)
02 Number of iterations n.
</pre></div>
</div>
</div>
<div class="section" id="init">
<h3><span class="section-number">10.4.5. </span>Init<a class="headerlink" href="#init" title="Permalink to this headline">¶</a></h3>
<div class="section" id="querying-features">
<h4><span class="section-number">10.4.5.1. </span>Querying features<a class="headerlink" href="#querying-features" title="Permalink to this headline">¶</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OP=  ff
Query command. Length varies according to the query type.
The general format of this packet is:
ff 01 QUERY [INDEX] CHECKSUM
responses are of the same form:
FF LEN QUERY VALUE_QUERIED CHECKSUM2
where LEN = 1 + length(VALUE_QUERIED)
</pre></div>
</div>
<div class="section" id="query-ram-size">
<h5><span class="section-number">10.4.5.1.1. </span>Query ram size<a class="headerlink" href="#query-ram-size" title="Permalink to this headline">¶</a></h5>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QUERY = 42 (&#39;B&#39;uffer size)
</pre></div>
</div>
<p>The device should reply with the same packet plus two additional bytes
containing the size of the memory:
ff 03 42 03 e8 CS would mean that the device has 1000 bytes of ram available.</p>
</div>
<div class="section" id="query-number-of-effects">
<h5><span class="section-number">10.4.5.1.2. </span>Query number of effects<a class="headerlink" href="#query-number-of-effects" title="Permalink to this headline">¶</a></h5>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QUERY = 4e (&#39;N&#39;umber of effects)
</pre></div>
</div>
<p>The device should respond by sending the number of effects that can be played
at the same time (one byte)
ff 02 4e 14 CS would stand for 20 effects.</p>
</div>
<div class="section" id="vendor-s-id">
<h5><span class="section-number">10.4.5.1.3. </span>Vendor’s id<a class="headerlink" href="#vendor-s-id" title="Permalink to this headline">¶</a></h5>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QUERY = 4d (&#39;M&#39;anufacturer)
</pre></div>
</div>
<p>Query the vendors’id (2 bytes)</p>
</div>
<div class="section" id="product-id">
<h5><span class="section-number">10.4.5.1.4. </span>Product id<a class="headerlink" href="#product-id" title="Permalink to this headline">¶</a></h5>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QUERY = 50 (&#39;P&#39;roduct)
</pre></div>
</div>
<p>Query the product id (2 bytes)</p>
</div>
<div class="section" id="open-device">
<h5><span class="section-number">10.4.5.1.5. </span>Open device<a class="headerlink" href="#open-device" title="Permalink to this headline">¶</a></h5>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QUERY = 4f (&#39;O&#39;pen)
</pre></div>
</div>
<p>No data returned.</p>
</div>
<div class="section" id="close-device">
<h5><span class="section-number">10.4.5.1.6. </span>Close device<a class="headerlink" href="#close-device" title="Permalink to this headline">¶</a></h5>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QUERY = 43 (&#39;C&#39;)lose
</pre></div>
</div>
<p>No data returned.</p>
</div>
<div class="section" id="query-effect">
<h5><span class="section-number">10.4.5.1.7. </span>Query effect<a class="headerlink" href="#query-effect" title="Permalink to this headline">¶</a></h5>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QUERY = 45 (&#39;E&#39;)
</pre></div>
</div>
<p>Send effect type.
Returns nonzero if supported (2 bytes)</p>
</div>
<div class="section" id="firmware-version">
<h5><span class="section-number">10.4.5.1.8. </span>Firmware Version<a class="headerlink" href="#firmware-version" title="Permalink to this headline">¶</a></h5>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>QUERY = 56 (&#39;V&#39;ersion)
</pre></div>
</div>
<p>Sends back 3 bytes - major, minor, subminor</p>
</div>
</div>
<div class="section" id="initialisation-of-the-device">
<h4><span class="section-number">10.4.5.2. </span>Initialisation of the device<a class="headerlink" href="#initialisation-of-the-device" title="Permalink to this headline">¶</a></h4>
<div class="section" id="set-control">
<h5><span class="section-number">10.4.5.2.1. </span>Set Control<a class="headerlink" href="#set-control" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Device dependent, can be different on different models!</p>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OP=  40 &lt;idx&gt; &lt;val&gt; [&lt;val&gt;]
LEN= 2 or 3
00 Idx
   Idx 00 Set dead zone (0..2048)
   Idx 01 Ignore Deadman sensor (0..1)
   Idx 02 Enable comm watchdog (0..1)
   Idx 03 Set the strength of the spring (0..100)
   Idx 04 Enable or disable the spring (0/1)
   Idx 05 Set axis saturation threshold (0..2048)
</pre></div>
</div>
</div>
<div class="section" id="set-effect-state">
<h5><span class="section-number">10.4.5.2.2. </span>Set Effect State<a class="headerlink" href="#set-effect-state" title="Permalink to this headline">¶</a></h5>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OP=  42 &lt;val&gt;
LEN= 1
00 State
   Bit 3 Pause force feedback
   Bit 2 Enable force feedback
   Bit 0 Stop all effects
</pre></div>
</div>
</div>
<div class="section" id="set-overall">
<h5><span class="section-number">10.4.5.2.3. </span>Set overall<a class="headerlink" href="#set-overall" title="Permalink to this headline">¶</a></h5>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OP=  43 &lt;val&gt;
LEN= 1
00 Gain
   Val 00 = 0%
   Val 40 = 50%
   Val 80 = 100%
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parameter-memory">
<h3><span class="section-number">10.4.6. </span>Parameter memory<a class="headerlink" href="#parameter-memory" title="Permalink to this headline">¶</a></h3>
<p>Each device has a certain amount of memory to store parameters of effects.
The amount of RAM may vary, I encountered values from 200 to 1000 bytes. Below
is the amount of memory apparently needed for every set of parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>period : 0c</p></li>
<li><p>magnitude : 02</p></li>
<li><p>attack and fade : 0e</p></li>
<li><p>interactive : 08</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="appendix-how-to-study-the-protocol">
<h2><span class="section-number">10.5. </span>Appendix: How to study the protocol?<a class="headerlink" href="#appendix-how-to-study-the-protocol" title="Permalink to this headline">¶</a></h2>
<p>1. Generate effects using the force editor provided with the DirectX SDK, or
use Immersion Studio (freely available at their web site in the developer section:
www.immersion.com)
2. Start a soft spying RS232 or USB (depending on where you connected your
joystick/wheel). I used ComPortSpy from fCoder (alpha version!)
3. Play the effect, and watch what happens on the spy screen.</p>
<p>A few words about ComPortSpy:
At first glance, this software seems, hum, well… buggy. In fact, data appear with a
few seconds latency. Personally, I restart it every time I play an effect.
Remember it’s free (as in free beer) and alpha!</p>
</div>
<div class="section" id="urls">
<h2><span class="section-number">10.6. </span>URLS<a class="headerlink" href="#urls" title="Permalink to this headline">¶</a></h2>
<p>Check <a class="reference external" href="http://www.immerse.com">http://www.immerse.com</a> for Immersion Studio,
and <a class="reference external" href="http://www.fcoder.com">http://www.fcoder.com</a> for ComPortSpy.</p>
<p>I-Force is trademark of Immersion Corp.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="joystick-parport.html" class="btn btn-neutral float-right" title="11. Parallel Port Joystick Drivers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="elantech.html" class="btn btn-neutral float-left" title="9. Elantech Touchpad Driver" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright The kernel development community.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
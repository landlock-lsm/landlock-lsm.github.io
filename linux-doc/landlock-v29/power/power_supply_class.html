

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Linux power supply class &mdash; The Linux Kernel 5.11.0+ documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Runtime Power Management Framework for I/O Devices" href="runtime_pm.html" />
    <link rel="prev" title="PM Quality Of Service Interface" href="pm_qos_interface.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devicetree/index.html">Open Firmware and Device Tree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Power Management</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="apm-acpi.html">APM or ACPI?</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic-pm-debugging.html">Debugging hibernation and suspend</a></li>
<li class="toctree-l2"><a class="reference internal" href="charger-manager.html">Charger Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="drivers-testing.html">Testing suspend and resume support in device drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="energy-model.html">Energy Model of devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="freezing-of-tasks.html">Freezing of tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="opp.html">Operating Performance Points (OPP) Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="pci.html">PCI Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="pm_qos_interface.html">PM Quality Of Service Interface</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Linux power supply class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#synopsis">Synopsis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#attributes-properties">Attributes/properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#units">Units</a></li>
<li class="toctree-l3"><a class="reference internal" href="#attributes-properties-detailed">Attributes/properties detailed</a></li>
<li class="toctree-l3"><a class="reference internal" href="#battery-external-power-supply-interaction">Battery &lt;-&gt; external power supply interaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#devicetree-battery-characteristics">Devicetree battery characteristics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#qa">QA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="runtime_pm.html">Runtime Power Management Framework for I/O Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="s2ram.html">How to get s2ram working</a></li>
<li class="toctree-l2"><a class="reference internal" href="suspend-and-cpuhotplug.html">Interaction of Suspend code (S3) with the CPU hotplug infrastructure</a></li>
<li class="toctree-l2"><a class="reference internal" href="suspend-and-interrupts.html">System Suspend and Device Interrupts</a></li>
<li class="toctree-l2"><a class="reference internal" href="swsusp-and-swap-files.html">Using swap files with software suspend (swsusp)</a></li>
<li class="toctree-l2"><a class="reference internal" href="swsusp-dmcrypt.html">How to use dm-crypt and swsusp together</a></li>
<li class="toctree-l2"><a class="reference internal" href="swsusp.html">Swap suspend</a></li>
<li class="toctree-l2"><a class="reference internal" href="video.html">Video issues with S3 resume</a></li>
<li class="toctree-l2"><a class="reference internal" href="tricks.html">swsusp/S3 tricks</a></li>
<li class="toctree-l2"><a class="reference internal" href="userland-swsusp.html">Documentation for userland software suspend interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="powercap/powercap.html">Power Capping Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="powercap/dtpm.html">Dynamic Thermal Power Management framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="regulator/consumer.html">Regulator Consumer Driver Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="regulator/design.html">Regulator API design notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="regulator/machine.html">Regulator Machine Driver Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="regulator/overview.html">Linux voltage and current regulator framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="regulator/regulator.html">Regulator Driver Interface</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mhi/index.html">MHI</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arm/index.html">ARM Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arm64/index.html">ARM64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ia64/index.html">IA-64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../m68k/index.html">m68k Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mips/index.html">MIPS-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nios2/index.html">Nios II Specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openrisc/index.html">OpenRISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parisc/index.html">PA-RISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../powerpc/index.html">powerpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../riscv/index.html">RISC-V architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../s390/index.html">s390 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sparc/index.html">Sparc Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../x86/index.html">x86-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtensa/index.html">Xtensa Architecture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/ext4/index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html">Unsorted Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#atomic-types">Atomic Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#atomic-bitops">Atomic bitops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#memory-barriers">Memory Barriers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../watch_queue.html">General notification mechanism</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Power Management</a> &raquo;</li>
        
      <li>Linux power supply class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/power/power_supply_class.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="linux-power-supply-class">
<h1>Linux power supply class<a class="headerlink" href="#linux-power-supply-class" title="Permalink to this headline">¶</a></h1>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<p>Power supply class used to represent battery, UPS, AC or DC power supply
properties to user-space.</p>
<p>It defines core set of attributes, which should be applicable to (almost)
every power supply out there. Attributes are available via sysfs and uevent
interfaces.</p>
<p>Each attribute has well defined meaning, up to unit of measure used. While
the attributes provided are believed to be universally applicable to any
power supply, specific monitoring hardware may not be able to provide them
all, so any of them may be skipped.</p>
<p>Power supply class is extensible, and allows to define drivers own attributes.
The core attribute set is subject to the standard Linux evolution (i.e.
if it will be found that some attribute is applicable to many power supply
types or their drivers, it can be added to the core set).</p>
<p>It also integrates with LED framework, for the purpose of providing
typically expected feedback of battery charging/fully charged status and
AC/USB power supply online status. (Note that specific details of the
indication (including whether to use it at all) are fully controllable by
user and/or specific machine defaults, per design principles of LED
framework).</p>
</div>
<div class="section" id="attributes-properties">
<h2>Attributes/properties<a class="headerlink" href="#attributes-properties" title="Permalink to this headline">¶</a></h2>
<p>Power supply class has predefined set of attributes, this eliminates code
duplication across drivers. Power supply class insist on reusing its
predefined attributes <em>and</em> their units.</p>
<p>So, userspace gets predictable set of attributes and their units for any
kind of power supply, and can process/present them to a user in consistent
manner. Results for different power supplies and machines are also directly
comparable.</p>
<p>See drivers/power/supply/ds2760_battery.c and drivers/power/supply/pda_power.c
for the example how to declare and handle attributes.</p>
</div>
<div class="section" id="units">
<h2>Units<a class="headerlink" href="#units" title="Permalink to this headline">¶</a></h2>
<p>Quoting include/linux/power_supply.h:</p>
<blockquote>
<div><p>All voltages, currents, charges, energies, time and temperatures in µV,
µA, µAh, µWh, seconds and tenths of degree Celsius unless otherwise
stated. It’s driver’s job to convert its raw values to units in which
this class operates.</p>
</div></blockquote>
</div>
<div class="section" id="attributes-properties-detailed">
<h2>Attributes/properties detailed<a class="headerlink" href="#attributes-properties-detailed" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Charge/Energy/Capacity - how to not confuse</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>Because both “charge” (µAh) and “energy” (µWh) represents “capacity”
of battery, this class distinguish these terms. Don’t mix them!</strong></p>
<ul class="simple">
<li><dl class="simple">
<dt><cite>CHARGE_*</cite></dt><dd><p>attributes represents capacity in µAh only.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>ENERGY_*</cite></dt><dd><p>attributes represents capacity in µWh only.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>CAPACITY</cite></dt><dd><p>attribute represents capacity in <em>percents</em>, from 0 to 100.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Postfixes:</p>
<dl class="simple">
<dt>_AVG</dt><dd><p><em>hardware</em> averaged value, use it if your hardware is really able to
report averaged values.</p>
</dd>
<dt>_NOW</dt><dd><p>momentary/instantaneous values.</p>
</dd>
<dt>STATUS</dt><dd><p>this attribute represents operating status (charging, full,
discharging (i.e. powering a load), etc.). This corresponds to
<cite>BATTERY_STATUS_*</cite> values, as defined in battery.h.</p>
</dd>
<dt>CHARGE_TYPE</dt><dd><p>batteries can typically charge at different rates.
This defines trickle and fast charges.  For batteries that
are already charged or discharging, ‘n/a’ can be displayed (or
‘unknown’, if the status is not known).</p>
</dd>
<dt>AUTHENTIC</dt><dd><p>indicates the power supply (battery or charger) connected
to the platform is authentic(1) or non authentic(0).</p>
</dd>
<dt>HEALTH</dt><dd><p>represents health of the battery, values corresponds to
POWER_SUPPLY_HEALTH_*, defined in battery.h.</p>
</dd>
<dt>VOLTAGE_OCV</dt><dd><p>open circuit voltage of the battery.</p>
</dd>
<dt>VOLTAGE_MAX_DESIGN, VOLTAGE_MIN_DESIGN</dt><dd><p>design values for maximal and minimal power supply voltages.
Maximal/minimal means values of voltages when battery considered
“full”/”empty” at normal conditions. Yes, there is no direct relation
between voltage and battery capacity, but some dumb
batteries use voltage for very approximated calculation of capacity.
Battery driver also can use this attribute just to inform userspace
about maximal and minimal voltage thresholds of a given battery.</p>
</dd>
<dt>VOLTAGE_MAX, VOLTAGE_MIN</dt><dd><p>same as _DESIGN voltage values except that these ones should be used
if hardware could only guess (measure and retain) the thresholds of a
given power supply.</p>
</dd>
<dt>VOLTAGE_BOOT</dt><dd><p>Reports the voltage measured during boot</p>
</dd>
<dt>CURRENT_BOOT</dt><dd><p>Reports the current measured during boot</p>
</dd>
<dt>CHARGE_FULL_DESIGN, CHARGE_EMPTY_DESIGN</dt><dd><p>design charge values, when battery considered full/empty.</p>
</dd>
<dt>ENERGY_FULL_DESIGN, ENERGY_EMPTY_DESIGN</dt><dd><p>same as above but for energy.</p>
</dd>
<dt>CHARGE_FULL, CHARGE_EMPTY</dt><dd><p>These attributes means “last remembered value of charge when battery
became full/empty”. It also could mean “value of charge when battery
considered full/empty at given conditions (temperature, age)”.
I.e. these attributes represents real thresholds, not design values.</p>
</dd>
<dt>ENERGY_FULL, ENERGY_EMPTY</dt><dd><p>same as above but for energy.</p>
</dd>
<dt>CHARGE_COUNTER</dt><dd><p>the current charge counter (in µAh).  This could easily
be negative; there is no empty or full value.  It is only useful for
relative, time-based measurements.</p>
</dd>
<dt>PRECHARGE_CURRENT</dt><dd><p>the maximum charge current during precharge phase of charge cycle
(typically 20% of battery capacity).</p>
</dd>
<dt>CHARGE_TERM_CURRENT</dt><dd><p>Charge termination current. The charge cycle terminates when battery
voltage is above recharge threshold, and charge current is below
this setting (typically 10% of battery capacity).</p>
</dd>
<dt>CONSTANT_CHARGE_CURRENT</dt><dd><p>constant charge current programmed by charger.</p>
</dd>
<dt>CONSTANT_CHARGE_CURRENT_MAX</dt><dd><p>maximum charge current supported by the power supply object.</p>
</dd>
<dt>CONSTANT_CHARGE_VOLTAGE</dt><dd><p>constant charge voltage programmed by charger.</p>
</dd>
<dt>CONSTANT_CHARGE_VOLTAGE_MAX</dt><dd><p>maximum charge voltage supported by the power supply object.</p>
</dd>
<dt>INPUT_CURRENT_LIMIT</dt><dd><p>input current limit programmed by charger. Indicates
the current drawn from a charging source.</p>
</dd>
<dt>INPUT_VOLTAGE_LIMIT</dt><dd><p>input voltage limit programmed by charger. Indicates
the voltage limit from a charging source.</p>
</dd>
<dt>INPUT_POWER_LIMIT</dt><dd><p>input power limit programmed by charger. Indicates
the power limit from a charging source.</p>
</dd>
<dt>CHARGE_CONTROL_LIMIT</dt><dd><p>current charge control limit setting</p>
</dd>
<dt>CHARGE_CONTROL_LIMIT_MAX</dt><dd><p>maximum charge control limit setting</p>
</dd>
<dt>CALIBRATE</dt><dd><p>battery or coulomb counter calibration status</p>
</dd>
<dt>CAPACITY</dt><dd><p>capacity in percents.</p>
</dd>
<dt>CAPACITY_ALERT_MIN</dt><dd><p>minimum capacity alert value in percents.</p>
</dd>
<dt>CAPACITY_ALERT_MAX</dt><dd><p>maximum capacity alert value in percents.</p>
</dd>
<dt>CAPACITY_LEVEL</dt><dd><p>capacity level. This corresponds to POWER_SUPPLY_CAPACITY_LEVEL_*.</p>
</dd>
<dt>TEMP</dt><dd><p>temperature of the power supply.</p>
</dd>
<dt>TEMP_ALERT_MIN</dt><dd><p>minimum battery temperature alert.</p>
</dd>
<dt>TEMP_ALERT_MAX</dt><dd><p>maximum battery temperature alert.</p>
</dd>
<dt>TEMP_AMBIENT</dt><dd><p>ambient temperature.</p>
</dd>
<dt>TEMP_AMBIENT_ALERT_MIN</dt><dd><p>minimum ambient temperature alert.</p>
</dd>
<dt>TEMP_AMBIENT_ALERT_MAX</dt><dd><p>maximum ambient temperature alert.</p>
</dd>
<dt>TEMP_MIN</dt><dd><p>minimum operatable temperature</p>
</dd>
<dt>TEMP_MAX</dt><dd><p>maximum operatable temperature</p>
</dd>
<dt>TIME_TO_EMPTY</dt><dd><p>seconds left for battery to be considered empty
(i.e. while battery powers a load)</p>
</dd>
<dt>TIME_TO_FULL</dt><dd><p>seconds left for battery to be considered full
(i.e. while battery is charging)</p>
</dd>
</dl>
</div>
<div class="section" id="battery-external-power-supply-interaction">
<h2>Battery &lt;-&gt; external power supply interaction<a class="headerlink" href="#battery-external-power-supply-interaction" title="Permalink to this headline">¶</a></h2>
<p>Often power supplies are acting as supplies and supplicants at the same
time. Batteries are good example. So, batteries usually care if they’re
externally powered or not.</p>
<p>For that case, power supply class implements notification mechanism for
batteries.</p>
<p>External power supply (AC) lists supplicants (batteries) names in
“supplied_to” struct member, and each power_supply_changed() call
issued by external power supply will notify supplicants via
external_power_changed callback.</p>
</div>
<div class="section" id="devicetree-battery-characteristics">
<h2>Devicetree battery characteristics<a class="headerlink" href="#devicetree-battery-characteristics" title="Permalink to this headline">¶</a></h2>
<p>Drivers should call power_supply_get_battery_info() to obtain battery
characteristics from a devicetree battery node, defined in
Documentation/devicetree/bindings/power/supply/battery.txt. This is
implemented in drivers/power/supply/bq27xxx_battery.c.</p>
<p>Properties in struct power_supply_battery_info and their counterparts in the
battery node have names corresponding to elements in enum power_supply_property,
for naming consistency between sysfs attributes and battery node properties.</p>
</div>
<div class="section" id="qa">
<h2>QA<a class="headerlink" href="#qa" title="Permalink to this headline">¶</a></h2>
<dl>
<dt>Q:</dt><dd><p>Where is POWER_SUPPLY_PROP_XYZ attribute?</p>
</dd>
<dt>A:</dt><dd><p>If you cannot find attribute suitable for your driver needs, feel free
to add it and send patch along with your driver.</p>
<p>The attributes available currently are the ones currently provided by the
drivers written.</p>
<p>Good candidates to add in future: model/part#, cycle_time, manufacturer,
etc.</p>
</dd>
<dt>Q:</dt><dd><p>I have some very specific attribute (e.g. battery color), should I add
this attribute to standard ones?</p>
</dd>
<dt>A:</dt><dd><p>Most likely, no. Such attribute can be placed in the driver itself, if
it is useful. Of course, if the attribute in question applicable to
large set of batteries, provided by many drivers, and/or comes from
some general battery specification/standard, it may be a candidate to
be added to the core attribute set.</p>
</dd>
<dt>Q:</dt><dd><p>Suppose, my battery monitoring chip/firmware does not provides capacity
in percents, but provides charge_{now,full,empty}. Should I calculate
percentage capacity manually, inside the driver, and register CAPACITY
attribute? The same question about time_to_empty/time_to_full.</p>
</dd>
<dt>A:</dt><dd><p>Most likely, no. This class is designed to export properties which are
directly measurable by the specific hardware available.</p>
<p>Inferring not available properties using some heuristics or mathematical
model is not subject of work for a battery driver. Such functionality
should be factored out, and in fact, apm_power, the driver to serve
legacy APM API on top of power supply class, uses a simple heuristic of
approximating remaining battery capacity based on its charge, current,
voltage and so on. But full-fledged battery model is likely not subject
for kernel at all, as it would require floating point calculation to deal
with things like differential equations and Kalman filters. This is
better be handled by batteryd/libbattery, yet to be written.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="runtime_pm.html" class="btn btn-neutral float-right" title="Runtime Power Management Framework for I/O Devices" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="pm_qos_interface.html" class="btn btn-neutral float-left" title="PM Quality Of Service Interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright The kernel development community.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>6.17. Rockchip Image Signal Processor (rkisp1) &mdash; The Linux Kernel 5.11.0+ documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6.18. The saa7134 driver" href="saa7134.html" />
    <link rel="prev" title="6.16. Renesas R-Car Fine Display Processor (FDP1) Driver" href="rcar-fdp1.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">The Linux kernel user’s and administrator’s guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../README.html">Linux kernel release 5.x &lt;http://kernel.org/&gt;</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel-parameters.html">The kernel’s command-line parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devices.html">Linux allocated devices (4.x+ version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sysctl/index.html">Documentation for /proc/sys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../abi.html">Linux ABI description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features.html">Feature status on all architectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw-vuln/index.html">Hardware vulnerabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reporting-bugs.html">Reporting bugs (obsolete)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security-bugs.html">Security bugs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bug-hunting.html">Bug hunting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bug-bisect.html">Bisecting a bug</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tainted-kernels.html">Tainted kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ramoops.html">Ramoops oops/panic logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dynamic-debug-howto.html">Dynamic debug</a></li>
<li class="toctree-l2"><a class="reference internal" href="../init.html">Explaining the “No working init found.” boot hang message</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kdump/index.html">Documentation for Kdump - The kexec-based Crash Dumping Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../perf/index.html">Performance monitor support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pstore-blk.html">pstore block oops/panic logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sysfs-rules.html">Rules on how to access information in sysfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../acpi/index.html">ACPI Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aoe/index.html">ATA over Ethernet (AoE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auxdisplay/index.html">Auxiliary Display Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bcache.html">A block layer cache (bcache)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../binderfs.html">The Android binderfs Filesystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../binfmt-misc.html">Kernel Support for miscellaneous Binary Formats (binfmt_misc)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blockdev/index.html">The Linux RapidIO Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bootconfig.html">Boot Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../braille-console.html">Linux Braille Console</a></li>
<li class="toctree-l2"><a class="reference internal" href="../btmrvl.html">btmrvl driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cgroup-v1/index.html">Control Groups version 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cgroup-v2.html">Control Group v2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cifs/index.html">CIFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clearing-warn-once.html">Clearing WARN_ONCE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpu-load.html">CPU load</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cputopology.html">How CPU topology info is exported via sysfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dell_rbu.html">Dell Remote BIOS Update driver (dell_rbu)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../device-mapper/index.html">Device Mapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edid.html">EDID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../efi-stub.html">The EFI Boot Stub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ext4.html">ext4 General Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nfs/index.html">NFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpio/index.html">gpio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../highuid.html">Notes on the change from 16-bit UIDs to 32-bit UIDs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw_random.html">Linux support for random number generator in i8xx chipsets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../initrd.html">Using the initial RAM disk (initrd)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iostats.html">I/O statistics fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../java.html">Java(tm) Binary Kernel Support for Linux v1.03</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jfs.html">IBM’s Journaled File System (JFS) for Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel-per-CPU-kthreads.html">Reducing OS jitter due to per-cpu kthreads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../laptops/index.html">Laptop Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lcd-panel-cgram.html">Parallel port LCD/Keypad Panel support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ldm.html">LDM - Logical Disk Manager (Dynamic Disks)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lockup-watchdogs.html">Softlockup detector and hardlockup detector (aka nmi_watchdog)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../LSM/index.html">Linux Security Module Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../md.html">RAID arrays</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Media subsystem admin and user guide</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html#the-media-subsystem">The media subsystem</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="intro.html">1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="building.html">2. Building support for a media device</a></li>
<li class="toctree-l4"><a class="reference internal" href="remote-controller.html">3. Infrared remote control support in video4linux drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="dvb.html">4. Digital TV</a></li>
<li class="toctree-l4"><a class="reference internal" href="cardlist.html">5. Cards List</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="v4l-drivers.html">6. Video4Linux (V4L) driver-specific documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="dvb-drivers.html">7. Digital TV driver-specific documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cec-drivers.html">8. CEC driver-specific documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mm/index.html">Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module-signing.html">Kernel module signing facility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mono.html">Mono(tm) Binary Kernel Support for Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../namespaces/index.html">Namespaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numastat.html">Numa policy hit/miss statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parport.html">Parport</a></li>
<li class="toctree-l2"><a class="reference internal" href="../perf-security.html">Perf events and tool security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pm/index.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pnp.html">Linux Plug and Play Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rapidio.html">RapidIO Subsystem Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ras.html">Reliability, Availability and Serviceability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rtc.html">Real Time Clock (RTC) Drivers for Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../serial-console.html">Linux Serial Console</a></li>
<li class="toctree-l2"><a class="reference internal" href="../svga.html">Video Mode Selection Support 2.13</a></li>
<li class="toctree-l2"><a class="reference internal" href="../syscall-user-dispatch.html">Syscall User Dispatch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sysrq.html">Linux Magic System Request Key Hacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thunderbolt.html">USB4 and Thunderbolt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ufs.html">Using UFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unicode.html">Unicode support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vga-softcursor.html">Software cursor for VGA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../video-output.html">Video Output Switcher Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../xfs.html">The SGI XFS Filesystem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicetree/index.html">Open Firmware and Device Tree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mhi/index.html">MHI</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arm/index.html">ARM Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../arm64/index.html">ARM64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ia64/index.html">IA-64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../m68k/index.html">m68k Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mips/index.html">MIPS-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nios2/index.html">Nios II Specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openrisc/index.html">OpenRISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parisc/index.html">PA-RISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../powerpc/index.html">powerpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../riscv/index.html">RISC-V architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../s390/index.html">s390 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sparc/index.html">Sparc Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../x86/index.html">x86-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../xtensa/index.html">Xtensa Architecture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../filesystems/ext4/index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html">Unsorted Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html#atomic-types">Atomic Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html#atomic-bitops">Atomic bitops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html#memory-barriers">Memory Barriers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../watch_queue.html">General notification mechanism</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">The Linux kernel user’s and administrator’s guide</a> &raquo;</li>
        
          <li><a href="index.html">Media subsystem admin and user guide</a> &raquo;</li>
        
          <li><a href="v4l-drivers.html"><span class="section-number">6. </span>Video4Linux (V4L) driver-specific documentation</a> &raquo;</li>
        
      <li><span class="section-number">6.17. </span>Rockchip Image Signal Processor (rkisp1)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/admin-guide/media/rkisp1.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rockchip-image-signal-processor-rkisp1">
<h1><span class="section-number">6.17. </span>Rockchip Image Signal Processor (rkisp1)<a class="headerlink" href="#rockchip-image-signal-processor-rkisp1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2><span class="section-number">6.17.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This file documents the driver for the Rockchip ISP1 that is part of RK3288
and RK3399 SoCs. The driver is located under drivers/staging/media/rkisp1
and uses the Media-Controller API.</p>
</div>
<div class="section" id="revisions">
<h2><span class="section-number">6.17.2. </span>Revisions<a class="headerlink" href="#revisions" title="Permalink to this headline">¶</a></h2>
<p>There exist multiple smaller revisions to this ISP that got introduced in
later SoCs. Revisions can be found in the enum <a class="reference internal" href="../../userspace-api/media/v4l/pixfmt-meta-rkisp1.html#c.rkisp1_cif_isp_version" title="rkisp1_cif_isp_version"><code class="xref c c-type docutils literal notranslate"><span class="pre">rkisp1_cif_isp_version</span></code></a>
in the UAPI and the revision of the ISP inside the running SoC can be read
in the field hw_revision of struct media_device_info as returned by
ioctl MEDIA_IOC_DEVICE_INFO.</p>
<p>Versions in use are:</p>
<ul class="simple">
<li><p>RKISP1_V10: used at least in rk3288 and rk3399</p></li>
<li><p>RKISP1_V11: declared in the original vendor code, but not used</p></li>
<li><p>RKISP1_V12: used at least in rk3326 and px30</p></li>
<li><p>RKISP1_V13: used at least in rk1808</p></li>
</ul>
</div>
<div class="section" id="topology">
<h2><span class="section-number">6.17.3. </span>Topology<a class="headerlink" href="#topology" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="Diagram of the default media pipeline topology" src="../../_images/rkisp1.svg" /></div>
<p>The driver has 4 video devices:</p>
<ul class="simple">
<li><p>rkisp1_mainpath: capture device for retrieving images, usually in higher
resolution.</p></li>
<li><p>rkisp1_selfpath: capture device for retrieving images.</p></li>
<li><p>rkisp1_stats: a metadata capture device that sends statistics.</p></li>
<li><p>rkisp1_params: a metadata output device that receives parameters
configurations from userspace.</p></li>
</ul>
<p>The driver has 3 subdevices:</p>
<ul class="simple">
<li><p>rkisp1_resizer_mainpath: used to resize and downsample frames for the
mainpath capture device.</p></li>
<li><p>rkisp1_resizer_selfpath: used to resize and downsample frames for the
selfpath capture device.</p></li>
<li><p>rkisp1_isp: is connected to the sensor and is responsible for all the isp
operations.</p></li>
</ul>
<div class="section" id="rkisp1-mainpath-rkisp1-selfpath-frames-capture-video-nodes">
<h3><span class="section-number">6.17.3.1. </span>rkisp1_mainpath, rkisp1_selfpath - Frames Capture Video Nodes<a class="headerlink" href="#rkisp1-mainpath-rkisp1-selfpath-frames-capture-video-nodes" title="Permalink to this headline">¶</a></h3>
<p>Those are the <cite>mainpath</cite> and <cite>selfpath</cite> capture devices to capture frames.
Those entities are the DMA engines that write the frames to memory.
The selfpath video device can capture YUV/RGB formats. Its input is YUV encoded
stream and it is able to convert it to RGB. The selfpath is not able to
capture bayer formats.
The mainpath can capture both bayer and YUV formats but it is not able to
capture RGB formats.
Both capture videos support
the <code class="docutils literal notranslate"><span class="pre">V4L2_CAP_IO_MC</span></code> <a class="reference internal" href="../../userspace-api/media/v4l/vidioc-querycap.html#device-capabilities"><span class="std std-ref">capability</span></a>.</p>
</div>
<div class="section" id="rkisp1-resizer-mainpath-rkisp1-resizer-selfpath-resizers-subdevices-nodes">
<h3><span class="section-number">6.17.3.2. </span>rkisp1_resizer_mainpath, rkisp1_resizer_selfpath - Resizers Subdevices Nodes<a class="headerlink" href="#rkisp1-resizer-mainpath-rkisp1-resizer-selfpath-resizers-subdevices-nodes" title="Permalink to this headline">¶</a></h3>
<p>Those are resizer entities for the mainpath and the selfpath. Those entities
can scale the frames up and down and also change the YUV sampling (for example
YUV4:2:2 -&gt; YUV4:2:0). They also have cropping capability on the sink pad.
The resizers entities can only operate on YUV:4:2:2 format
(MEDIA_BUS_FMT_YUYV8_2X8).
The mainpath capture device supports capturing video in bayer formats. In that
case the resizer of the mainpath is set to ‘bypass’ mode - it just forward the
frame without operating on it.</p>
</div>
<div class="section" id="rkisp1-isp-image-signal-processing-subdevice-node">
<h3><span class="section-number">6.17.3.3. </span>rkisp1_isp - Image Signal Processing Subdevice Node<a class="headerlink" href="#rkisp1-isp-image-signal-processing-subdevice-node" title="Permalink to this headline">¶</a></h3>
<p>This is the isp entity. It is connected to the sensor on sink pad 0 and
receives the frames using the CSI-2 protocol. It is responsible of configuring
the CSI-2 protocol. It has a cropping capability on sink pad 0 that is
connected to the sensor and on source pad 2 connected to the resizer entities.
Cropping on sink pad 0 defines the image region from the sensor.
Cropping on source pad 2 defines the region for the Image Stabilizer (IS).</p>
</div>
<div class="section" id="rkisp1-stats-statistics-video-node">
<span id="rkisp1-stats"></span><h3><span class="section-number">6.17.3.4. </span>rkisp1_stats - Statistics Video Node<a class="headerlink" href="#rkisp1-stats-statistics-video-node" title="Permalink to this headline">¶</a></h3>
<p>The statistics video node outputs the 3A (auto focus, auto exposure and auto
white balance) statistics, and also histogram statistics for the frames that
are being processed by the rkisp1 to userspace applications.
Using these data, applications can implement algorithms and re-parameterize
the driver through the rkisp_params node to improve image quality during a
video stream.
The buffer format is defined by struct <a class="reference internal" href="../../userspace-api/media/v4l/pixfmt-meta-rkisp1.html#c.rkisp1_stat_buffer" title="rkisp1_stat_buffer"><code class="xref c c-type docutils literal notranslate"><span class="pre">rkisp1_stat_buffer</span></code></a>, and
userspace should set
<a class="reference internal" href="../../userspace-api/media/v4l/pixfmt-meta-rkisp1.html#v4l2-meta-fmt-rk-isp1-stat-3a"><span class="std std-ref">V4L2_META_FMT_RK_ISP1_STAT_3A</span></a> as the
dataformat.</p>
</div>
<div class="section" id="rkisp1-params-parameters-video-node">
<span id="rkisp1-params"></span><h3><span class="section-number">6.17.3.5. </span>rkisp1_params - Parameters Video Node<a class="headerlink" href="#rkisp1-params-parameters-video-node" title="Permalink to this headline">¶</a></h3>
<p>The rkisp1_params video node receives a set of parameters from userspace
to be applied to the hardware during a video stream, allowing userspace
to dynamically modify values such as black level, cross talk corrections
and others.</p>
<p>The buffer format is defined by struct <a class="reference internal" href="../../userspace-api/media/v4l/pixfmt-meta-rkisp1.html#c.rkisp1_params_cfg" title="rkisp1_params_cfg"><code class="xref c c-type docutils literal notranslate"><span class="pre">rkisp1_params_cfg</span></code></a>, and
userspace should set
<a class="reference internal" href="../../userspace-api/media/v4l/pixfmt-meta-rkisp1.html#v4l2-meta-fmt-rk-isp1-params"><span class="std std-ref">V4L2_META_FMT_RK_ISP1_PARAMS</span></a> as the
dataformat.</p>
</div>
</div>
<div class="section" id="capturing-video-frames-example">
<h2><span class="section-number">6.17.4. </span>Capturing Video Frames Example<a class="headerlink" href="#capturing-video-frames-example" title="Permalink to this headline">¶</a></h2>
<p>In the following example, the sensor connected to pad 0 of ‘rkisp1_isp’ is
imx219.</p>
<p>The following commands can be used to capture video from the selfpath video
node with dimension 900x800 planar format YUV 4:2:2. It uses all cropping
capabilities possible, (see explanation right below)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># set the links</span>
<span class="s2">&quot;media-ctl&quot;</span> <span class="s2">&quot;-d&quot;</span> <span class="s2">&quot;platform:rkisp1&quot;</span> <span class="s2">&quot;-r&quot;</span>
<span class="s2">&quot;media-ctl&quot;</span> <span class="s2">&quot;-d&quot;</span> <span class="s2">&quot;platform:rkisp1&quot;</span> <span class="s2">&quot;-l&quot;</span> <span class="s2">&quot;&#39;imx219 4-0010&#39;:0 -&gt; &#39;rkisp1_isp&#39;:0 [1]&quot;</span>
<span class="s2">&quot;media-ctl&quot;</span> <span class="s2">&quot;-d&quot;</span> <span class="s2">&quot;platform:rkisp1&quot;</span> <span class="s2">&quot;-l&quot;</span> <span class="s2">&quot;&#39;rkisp1_isp&#39;:2 -&gt; &#39;rkisp1_resizer_selfpath&#39;:0 [1]&quot;</span>
<span class="s2">&quot;media-ctl&quot;</span> <span class="s2">&quot;-d&quot;</span> <span class="s2">&quot;platform:rkisp1&quot;</span> <span class="s2">&quot;-l&quot;</span> <span class="s2">&quot;&#39;rkisp1_isp&#39;:2 -&gt; &#39;rkisp1_resizer_mainpath&#39;:0 [0]&quot;</span>

<span class="c1"># set format for imx219 4-0010:0</span>
<span class="s2">&quot;media-ctl&quot;</span> <span class="s2">&quot;-d&quot;</span> <span class="s2">&quot;platform:rkisp1&quot;</span> <span class="s2">&quot;--set-v4l2&quot;</span> <span class="s1">&#39;&quot;imx219 4-0010&quot;:0 [fmt:SRGGB10_1X10/1640x1232]&#39;</span>

<span class="c1"># set format for rkisp1_isp pads:</span>
<span class="s2">&quot;media-ctl&quot;</span> <span class="s2">&quot;-d&quot;</span> <span class="s2">&quot;platform:rkisp1&quot;</span> <span class="s2">&quot;--set-v4l2&quot;</span> <span class="s1">&#39;&quot;rkisp1_isp&quot;:0 [fmt:SRGGB10_1X10/1640x1232 crop: (0,0)/1600x1200]&#39;</span>
<span class="s2">&quot;media-ctl&quot;</span> <span class="s2">&quot;-d&quot;</span> <span class="s2">&quot;platform:rkisp1&quot;</span> <span class="s2">&quot;--set-v4l2&quot;</span> <span class="s1">&#39;&quot;rkisp1_isp&quot;:2 [fmt:YUYV8_2X8/1600x1200 crop: (0,0)/1500x1100]&#39;</span>

<span class="c1"># set format for rkisp1_resizer_selfpath pads:</span>
<span class="s2">&quot;media-ctl&quot;</span> <span class="s2">&quot;-d&quot;</span> <span class="s2">&quot;platform:rkisp1&quot;</span> <span class="s2">&quot;--set-v4l2&quot;</span> <span class="s1">&#39;&quot;rkisp1_resizer_selfpath&quot;:0 [fmt:YUYV8_2X8/1500x1100 crop: (300,400)/1400x1000]&#39;</span>
<span class="s2">&quot;media-ctl&quot;</span> <span class="s2">&quot;-d&quot;</span> <span class="s2">&quot;platform:rkisp1&quot;</span> <span class="s2">&quot;--set-v4l2&quot;</span> <span class="s1">&#39;&quot;rkisp1_resizer_selfpath&quot;:1 [fmt:YUYV8_2X8/900x800]&#39;</span>

<span class="c1"># set format for rkisp1_selfpath:</span>
<span class="s2">&quot;v4l2-ctl&quot;</span> <span class="s2">&quot;-z&quot;</span> <span class="s2">&quot;platform:rkisp1&quot;</span> <span class="s2">&quot;-d&quot;</span> <span class="s2">&quot;rkisp1_selfpath&quot;</span> <span class="s2">&quot;-v&quot;</span> <span class="s2">&quot;width=900,height=800,&quot;</span>
<span class="s2">&quot;v4l2-ctl&quot;</span> <span class="s2">&quot;-z&quot;</span> <span class="s2">&quot;platform:rkisp1&quot;</span> <span class="s2">&quot;-d&quot;</span> <span class="s2">&quot;rkisp1_selfpath&quot;</span> <span class="s2">&quot;-v&quot;</span> <span class="s2">&quot;pixelformat=422P&quot;</span>

<span class="c1"># start streaming:</span>
v4l2-ctl <span class="s2">&quot;-z&quot;</span> <span class="s2">&quot;platform:rkisp1&quot;</span> <span class="s2">&quot;-d&quot;</span> <span class="s2">&quot;rkisp1_selfpath&quot;</span> <span class="s2">&quot;--stream-mmap&quot;</span> <span class="s2">&quot;--stream-count&quot;</span> <span class="s2">&quot;10&quot;</span>
</pre></div>
</div>
<p>In the above example the sensor is configured to bayer format:
<cite>SRGGB10_1X10/1640x1232</cite>. The rkisp1_isp:0 pad should be configured to the
same mbus format and dimensions as the sensor, otherwise streaming will fail
with ‘EPIPE’ error. So it is also configured to <cite>SRGGB10_1X10/1640x1232</cite>.
In addition, the rkisp1_isp:0 pad is configured to cropping <cite>(0,0)/1600x1200</cite>.</p>
<p>The cropping dimensions are automatically propagated to be the format of the
isp source pad <cite>rkisp1_isp:2</cite>. Another cropping operation is configured on
the isp source pad: <cite>(0,0)/1500x1100</cite>.</p>
<p>The resizer’s sink pad <cite>rkisp1_resizer_selfpath</cite> should be configured to format
<cite>YUYV8_2X8/1500x1100</cite> in order to match the format on the other side of the
link. In addition a cropping <cite>(300,400)/1400x1000</cite> is configured on it.</p>
<p>The source pad of the resizer, <cite>rkisp1_resizer_selfpath:1</cite> is configured to
format <cite>YUYV8_2X8/900x800</cite>. That means that the resizer first crop a window
of <cite>(300,400)/1400x100</cite> from the received frame and then scales this window
to dimension <cite>900x800</cite>.</p>
<p>Note that the above example does not uses the stats-params control loop.
Therefore the capture frames will not go through the 3A algorithms and
probably won’t have a good quality, and can even look dark and greenish.</p>
</div>
<div class="section" id="configuring-quantization">
<h2><span class="section-number">6.17.5. </span>Configuring Quantization<a class="headerlink" href="#configuring-quantization" title="Permalink to this headline">¶</a></h2>
<p>The driver supports limited and full range quantization on YUV formats,
where limited is the default.
To switch between one or the other, userspace should use the Colorspace
Conversion API (CSC) for subdevices on source pad 2 of the
isp (<cite>rkisp1_isp:2</cite>). The quantization configured on this pad is the
quantization of the captured video frames on the mainpath and selfpath
video nodes.
Note that the resizer and capture entities will always report
<code class="docutils literal notranslate"><span class="pre">V4L2_QUANTIZATION_DEFAULT</span></code> even if the quantization is configured to full
range on <cite>rkisp1_isp:2</cite>. So in order to get the configured quantization,
application should get it from pad <cite>rkisp1_isp:2</cite>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="saa7134.html" class="btn btn-neutral float-right" title="6.18. The saa7134 driver" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="rcar-fdp1.html" class="btn btn-neutral float-left" title="6.16. Renesas R-Car Fine Display Processor (FDP1) Driver" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright The kernel development community.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; The Linux Kernel 5.2.0+ documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Kernel Maintainer Handbook</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../media/index.html">Linux Media Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../x86/index.html">x86-specific Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/ext4/index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/aoe/aoe.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>ATA over Ethernet is a network protocol that provides simple access to
block storage on the LAN.</p>
<blockquote>
<div><a class="reference external" href="http://support.coraid.com/documents/AoEr11.txt">http://support.coraid.com/documents/AoEr11.txt</a></div></blockquote>
<p>The EtherDrive (R) HOWTO for 2.6 and 3.x kernels is found at …</p>
<blockquote>
<div><a class="reference external" href="http://support.coraid.com/support/linux/EtherDrive-2.6-HOWTO.html">http://support.coraid.com/support/linux/EtherDrive-2.6-HOWTO.html</a></div></blockquote>
<p>It has many tips and hints!  Please see, especially, recommended
tunings for virtual memory:</p>
<blockquote>
<div><a class="reference external" href="http://support.coraid.com/support/linux/EtherDrive-2.6-HOWTO-5.html#ss5.19">http://support.coraid.com/support/linux/EtherDrive-2.6-HOWTO-5.html#ss5.19</a></div></blockquote>
<p>The aoetools are userland programs that are designed to work with this
driver.  The aoetools are on sourceforge.</p>
<blockquote>
<div><a class="reference external" href="http://aoetools.sourceforge.net/">http://aoetools.sourceforge.net/</a></div></blockquote>
<p>The scripts in this Documentation/aoe directory are intended to
document the use of the driver and are not necessary if you install
the aoetools.</p>
</div>
<div class="section" id="creating-device-nodes">
<h1>Creating Device Nodes<a class="headerlink" href="#creating-device-nodes" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>Users of udev should find the block device nodes created
automatically, but to create all the necessary device nodes, use the
udev configuration rules provided in udev.txt (in this directory).</p>
<p>There is a udev-install.sh script that shows how to install these
rules on your system.</p>
<p>There is also an autoload script that shows how to edit
/etc/modprobe.d/aoe.conf to ensure that the aoe module is loaded when
necessary.  Preloading the aoe module is preferable to autoloading,
however, because AoE discovery takes a few seconds.  It can be
confusing when an AoE device is not present the first time the a
command is run but appears a second later.</p>
</div></blockquote>
</div>
<div class="section" id="using-device-nodes">
<h1>Using Device Nodes<a class="headerlink" href="#using-device-nodes" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>“cat /dev/etherd/err” blocks, waiting for error diagnostic output,
like any retransmitted packets.</p>
<p>“echo eth2 eth4 &gt; /dev/etherd/interfaces” tells the aoe driver to
limit ATA over Ethernet traffic to eth2 and eth4.  AoE traffic from
untrusted networks should be ignored as a matter of security.  See
also the aoe_iflist driver option described below.</p>
<p>“echo &gt; /dev/etherd/discover” tells the driver to find out what AoE
devices are available.</p>
<p>In the future these character devices may disappear and be replaced
by sysfs counterparts.  Using the commands in aoetools insulates
users from these implementation details.</p>
<p>The block devices are named like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>e{shelf}.{slot}
e{shelf}.{slot}p{part}
</pre></div>
</div>
<p>… so that “e0.2” is the third blade from the left (slot 2) in the
first shelf (shelf address zero).  That’s the whole disk.  The first
partition on that disk would be “e0.2p1”.</p>
</div></blockquote>
</div>
<div class="section" id="using-sysfs">
<h1>Using sysfs<a class="headerlink" href="#using-sysfs" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>Each aoe block device in /sys/block has the extra attributes of
state, mac, and netif.  The state attribute is “up” when the device
is ready for I/O and “down” if detected but unusable.  The
“down,closewait” state shows that the device is still open and
cannot come up again until it has been closed.</p>
<p>The mac attribute is the ethernet address of the remote AoE device.
The netif attribute is the network interface on the localhost
through which we are communicating with the remote AoE device.</p>
<p>There is a script in this directory that formats this information in
a convenient way.  Users with aoetools should use the aoe-stat
command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root@makki root# sh Documentation/aoe/status.sh
   e10.0            eth3              up
   e10.1            eth3              up
   e10.2            eth3              up
   e10.3            eth3              up
   e10.4            eth3              up
   e10.5            eth3              up
   e10.6            eth3              up
   e10.7            eth3              up
   e10.8            eth3              up
   e10.9            eth3              up
    e4.0            eth1              up
    e4.1            eth1              up
    e4.2            eth1              up
    e4.3            eth1              up
    e4.4            eth1              up
    e4.5            eth1              up
    e4.6            eth1              up
    e4.7            eth1              up
    e4.8            eth1              up
    e4.9            eth1              up
</pre></div>
</div>
<p>Use /sys/module/aoe/parameters/aoe_iflist (or better, the driver
option discussed below) instead of /dev/etherd/interfaces to limit
AoE traffic to the network interfaces in the given
whitespace-separated list.  Unlike the old character device, the
sysfs entry can be read from as well as written to.</p>
<p>It’s helpful to trigger discovery after setting the list of allowed
interfaces.  The aoetools package provides an aoe-discover script
for this purpose.  You can also directly use the
/dev/etherd/discover special file described above.</p>
</div></blockquote>
</div>
<div class="section" id="driver-options">
<h1>Driver Options<a class="headerlink" href="#driver-options" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>There is a boot option for the built-in aoe driver and a
corresponding module parameter, aoe_iflist.  Without this option,
all network interfaces may be used for ATA over Ethernet.  Here is a
usage example for the module parameter:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>modprobe aoe_iflist=&quot;eth1 eth3&quot;
</pre></div>
</div>
<p>The aoe_deadsecs module parameter determines the maximum number of
seconds that the driver will wait for an AoE device to provide a
response to an AoE command.  After aoe_deadsecs seconds have
elapsed, the AoE device will be marked as “down”.  A value of zero
is supported for testing purposes and makes the aoe driver keep
trying AoE commands forever.</p>
<p>The aoe_maxout module parameter has a default of 128.  This is the
maximum number of unresponded packets that will be sent to an AoE
target at one time.</p>
<p>The aoe_dyndevs module parameter defaults to 1, meaning that the
driver will assign a block device minor number to a discovered AoE
target based on the order of its discovery.  With dynamic minor
device numbers in use, a greater range of AoE shelf and slot
addresses can be supported.  Users with udev will never have to
think about minor numbers.  Using aoe_dyndevs=0 allows device nodes
to be pre-created using a static minor-number scheme with the
aoe-mkshelf script in the aoetools.</p>
</div></blockquote>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Serial Devices &mdash; The Linux Kernel  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="m68k Architecture" href="../m68k/index.html" />
    <link rel="prev" title="An ad-hoc collection of notes on IA64 MCA and INIT processing" href="mca.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.10.0-rc2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devicetree/index.html">Open Firmware and Device Tree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mhi/index.html">MHI</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../arm/index.html">ARM Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arm64/index.html">ARM64 Architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">IA-64 Architecture</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ia64.html">Linux kernel release for the IA-64 Platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="aliasing.html">Memory Attribute Aliasing on IA-64</a></li>
<li class="toctree-l2"><a class="reference internal" href="efirtc.html">EFI Real Time Clock driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="err_inject.html">IPF Machine Check (MC) error inject tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="fsys.html">Light-weight System Calls for IA-64</a></li>
<li class="toctree-l2"><a class="reference internal" href="irq-redir.html">IRQ affinity on IA64 platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="mca.html">An ad-hoc collection of notes on IA64 MCA and INIT processing</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Serial Devices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#serial-device-naming">Serial Device Naming</a></li>
<li class="toctree-l3"><a class="reference internal" href="#console-selection">Console Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#early-serial-console">Early Serial Console</a></li>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting-serial-console-problems">Troubleshooting Serial Console Problems</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../m68k/index.html">m68k Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mips/index.html">MIPS-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nios2/nios2.html">Linux on the Nios II architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openrisc/index.html">OpenRISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parisc/index.html">PA-RISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../powerpc/index.html">powerpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../riscv/index.html">RISC-V architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../s390/index.html">s390 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sparc/index.html">Sparc Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../x86/index.html">x86-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtensa/index.html">Xtensa Architecture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/ext4/index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html">Unsorted Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#atomic-types">Atomic Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#atomic-bitops">Atomic bitops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#memory-barriers">Memory Barriers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../watch_queue.html">General notification mechanism</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">IA-64 Architecture</a> &raquo;</li>
        
      <li>Serial Devices</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ia64/serial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="serial-devices">
<h1>Serial Devices<a class="headerlink" href="#serial-devices" title="Permalink to this headline">¶</a></h1>
<div class="section" id="serial-device-naming">
<h2>Serial Device Naming<a class="headerlink" href="#serial-device-naming" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>As of 2.6.10, serial devices on ia64 are named based on the
order of ACPI and PCI enumeration.  The first device in the
ACPI namespace (if any) becomes /dev/ttyS0, the second becomes
/dev/ttyS1, etc., and PCI devices are named sequentially
starting after the ACPI devices.</p>
<p>Prior to 2.6.10, there were confusing exceptions to this:</p>
<blockquote>
<div><ul class="simple">
<li><p>Firmware on some machines (mostly from HP) provides an HCDP
table[1] that tells the kernel about devices that can be used
as a serial console.  If the user specified “console=ttyS0”
or the EFI ConOut path contained only UART devices, the
kernel registered the device described by the HCDP as
/dev/ttyS0.</p></li>
<li><p>If there was no HCDP, we assumed there were UARTs at the
legacy COM port addresses (I/O ports 0x3f8 and 0x2f8), so
the kernel registered those as /dev/ttyS0 and /dev/ttyS1.</p></li>
</ul>
</div></blockquote>
<p>Any additional ACPI or PCI devices were registered sequentially
after /dev/ttyS0 as they were discovered.</p>
<p>With an HCDP, device names changed depending on EFI configuration
and “console=” arguments.  Without an HCDP, device names didn’t
change, but we registered devices that might not really exist.</p>
<p>For example, an HP rx1600 with a single built-in serial port
(described in the ACPI namespace) plus an MP[2] (a PCI device) has
these ports:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>MMIO
address</p></th>
<th class="head"><p>pre-2.6.10</p>
<p>(EFI console
on builtin)</p>
</th>
<th class="head"><p>pre-2.6.10</p>
<p>(EFI console
on MP port)</p>
</th>
<th class="head"><p>2.6.10+</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>builtin</p></td>
<td><p>0xff5e0000</p></td>
<td><p>ttyS0</p></td>
<td><p>ttyS1</p></td>
<td><p>ttyS0</p></td>
</tr>
<tr class="row-odd"><td><p>MP UPS</p></td>
<td><p>0xf8031000</p></td>
<td><p>ttyS1</p></td>
<td><p>ttyS2</p></td>
<td><p>ttyS1</p></td>
</tr>
<tr class="row-even"><td><p>MP Console</p></td>
<td><p>0xf8030000</p></td>
<td><p>ttyS2</p></td>
<td><p>ttyS0</p></td>
<td><p>ttyS2</p></td>
</tr>
<tr class="row-odd"><td><p>MP 2</p></td>
<td><p>0xf8030010</p></td>
<td><p>ttyS3</p></td>
<td><p>ttyS3</p></td>
<td><p>ttyS3</p></td>
</tr>
<tr class="row-even"><td><p>MP 3</p></td>
<td><p>0xf8030038</p></td>
<td><p>ttyS4</p></td>
<td><p>ttyS4</p></td>
<td><p>ttyS4</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="console-selection">
<h2>Console Selection<a class="headerlink" href="#console-selection" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>EFI knows what your console devices are, but it doesn’t tell the
kernel quite enough to actually locate them.  The DIG64 HCDP
table[1] does tell the kernel where potential serial console
devices are, but not all firmware supplies it.  Also, EFI supports
multiple simultaneous consoles and doesn’t tell the kernel which
should be the “primary” one.</p>
<p>So how do you tell Linux which console device to use?</p>
<blockquote>
<div><ul>
<li><p>If your firmware supplies the HCDP, it is simplest to
configure EFI with a single device (either a UART or a VGA
card) as the console.  Then you don’t need to tell Linux
anything; the kernel will automatically use the EFI console.</p>
<p>(This works only in 2.6.6 or later; prior to that you had
to specify “console=ttyS0” to get a serial console.)</p>
</li>
<li><p>Without an HCDP, Linux defaults to a VGA console unless you
specify a “console=” argument.</p></li>
</ul>
</div></blockquote>
<p>NOTE: Don’t assume that a serial console device will be /dev/ttyS0.
It might be ttyS1, ttyS2, etc.  Make sure you have the appropriate
entries in /etc/inittab (for getty) and /etc/securetty (to allow
root login).</p>
</div></blockquote>
</div>
<div class="section" id="early-serial-console">
<h2>Early Serial Console<a class="headerlink" href="#early-serial-console" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The kernel can’t start using a serial console until it knows where
the device lives.  Normally this happens when the driver enumerates
all the serial devices, which can happen a minute or more after the
kernel starts booting.</p>
<p>2.6.10 and later kernels have an “early uart” driver that works
very early in the boot process.  The kernel will automatically use
this if the user supplies an argument like “console=uart,io,0x3f8”,
or if the EFI console path contains only a UART device and the
firmware supplies an HCDP.</p>
</div></blockquote>
</div>
<div class="section" id="troubleshooting-serial-console-problems">
<h2>Troubleshooting Serial Console Problems<a class="headerlink" href="#troubleshooting-serial-console-problems" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>No kernel output after elilo prints “Uncompressing Linux… done”:</p>
<blockquote>
<div><ul class="simple">
<li><p>You specified “console=ttyS0” but Linux changed the device
to which ttyS0 refers.  Configure exactly one EFI console
device[3] and remove the “console=” option.</p></li>
<li><p>The EFI console path contains both a VGA device and a UART.
EFI and elilo use both, but Linux defaults to VGA.  Remove
the VGA device from the EFI console path[3].</p></li>
<li><p>Multiple UARTs selected as EFI console devices.  EFI and
elilo use all selected devices, but Linux uses only one.
Make sure only one UART is selected in the EFI console
path[3].</p></li>
<li><p>You’re connected to an HP MP port[2] but have a non-MP UART
selected as EFI console device.  EFI uses the MP as a
console device even when it isn’t explicitly selected.
Either move the console cable to the non-MP UART, or change
the EFI console path[3] to the MP UART.</p></li>
</ul>
</div></blockquote>
<p>Long pause (60+ seconds) between “Uncompressing Linux… done” and
start of kernel output:</p>
<blockquote>
<div><ul class="simple">
<li><p>No early console because you used “console=ttyS&lt;n&gt;”.  Remove
the “console=” option if your firmware supplies an HCDP.</p></li>
<li><p>If you don’t have an HCDP, the kernel doesn’t know where
your console lives until the driver discovers serial
devices.  Use “console=uart,io,0x3f8” (or appropriate
address for your machine).</p></li>
</ul>
</div></blockquote>
<p>Kernel and init script output works fine, but no “login:” prompt:</p>
<blockquote>
<div><ul class="simple">
<li><p>Add getty entry to /etc/inittab for console tty.  Look for
the “Adding console on ttyS&lt;n&gt;” message that tells you which
device is the console.</p></li>
</ul>
</div></blockquote>
<p>“login:” prompt, but can’t login as root:</p>
<blockquote>
<div><ul class="simple">
<li><p>Add entry to /etc/securetty for console tty.</p></li>
</ul>
</div></blockquote>
<p>No ACPI serial devices found in 2.6.17 or later:</p>
<blockquote>
<div><ul class="simple">
<li><p>Turn on CONFIG_PNP and CONFIG_PNPACPI.  Prior to 2.6.17, ACPI
serial devices were discovered by 8250_acpi.  In 2.6.17,
8250_acpi was replaced by the combination of 8250_pnp and
CONFIG_PNPACPI.</p></li>
</ul>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt>[1]</dt><dd><p><a class="reference external" href="http://www.dig64.org/specifications/agreement">http://www.dig64.org/specifications/agreement</a>
The table was originally defined as the “HCDP” for “Headless
Console/Debug Port.”  The current version is the “PCDP” for
“Primary Console and Debug Port Devices.”</p>
</dd>
<dt>[2]</dt><dd><p>The HP MP (management processor) is a PCI device that provides
several UARTs.  One of the UARTs is often used as a console; the
EFI Boot Manager identifies it as “Acpi(HWP0002,700)/Pci(…)/Uart”.
The external connection is usually a 25-pin connector, and a
special dongle converts that to three 9-pin connectors, one of
which is labelled “Console.”</p>
</dd>
<dt>[3]</dt><dd><p>EFI console devices are configured using the EFI Boot Manager
“Boot option maintenance” menu.  You may have to interrupt the
boot sequence to use this menu, and you will have to reset the
box after changing console configuration.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../m68k/index.html" class="btn btn-neutral float-right" title="m68k Architecture" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mca.html" class="btn btn-neutral float-left" title="An ad-hoc collection of notes on IA64 MCA and INIT processing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright The kernel development community

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
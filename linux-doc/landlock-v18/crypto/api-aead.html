

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Authenticated Encryption With Associated Data (AEAD) Algorithm Definitions &mdash; The Linux Kernel 5.7.0-rc7+ documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Message Digest Algorithm Definitions" href="api-digest.html" />
    <link rel="prev" title="Block Cipher Algorithm Definitions" href="api-skcipher.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.7.0-rc7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../media/index.html">Linux Media Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Linux Kernel Crypto API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Kernel Crypto API Interface Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Kernel Crypto API Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="devel-algos.html">Developing Cipher Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="userspace-if.html">User Space Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="crypto_engine.html">Crypto Engine</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="api.html">Programming Interface</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="api-skcipher.html">Block Cipher Algorithm Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-skcipher.html#symmetric-key-cipher-api">Symmetric Key Cipher API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-skcipher.html#symmetric-key-cipher-request-handle">Symmetric Key Cipher Request Handle</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-skcipher.html#single-block-cipher-api">Single Block Cipher API</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Authenticated Encryption With Associated Data (AEAD) Algorithm Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#authenticated-encryption-with-associated-data-aead-cipher-api">Authenticated Encryption With Associated Data (AEAD) Cipher API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#asynchronous-aead-request-handle">Asynchronous AEAD Request Handle</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-digest.html">Message Digest Algorithm Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-digest.html#asynchronous-message-digest-api">Asynchronous Message Digest API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-digest.html#asynchronous-hash-request-handle">Asynchronous Hash Request Handle</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-digest.html#synchronous-message-digest-api">Synchronous Message Digest API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-rng.html">Random Number Algorithm Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-rng.html#crypto-api-random-number-api">Crypto API Random Number API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-akcipher.html">Asymmetric Cipher Algorithm Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-akcipher.html#asymmetric-cipher-api">Asymmetric Cipher API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-akcipher.html#asymmetric-cipher-request-handle">Asymmetric Cipher Request Handle</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-kpp.html">Key-agreement Protocol Primitives (KPP) Cipher Algorithm Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-kpp.html#key-agreement-protocol-primitives-kpp-cipher-api">Key-agreement Protocol Primitives (KPP) Cipher API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-kpp.html#key-agreement-protocol-primitives-kpp-cipher-request-handle">Key-agreement Protocol Primitives (KPP) Cipher Request Handle</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-kpp.html#ecdh-helper-functions">ECDH Helper Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-kpp.html#dh-helper-functions">DH Helper Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api-samples.html">Code Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mhi/index.html">MHI</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arm/index.html">ARM Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arm64/index.html">ARM64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ia64/index.html">IA-64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../m68k/index.html">m68k Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mips/index.html">MIPS-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nios2/nios2.html">Linux on the Nios II architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openrisc/index.html">OpenRISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parisc/index.html">PA-RISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../powerpc/index.html">powerpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../riscv/index.html">RISC-V architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../s390/index.html">s390 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sparc/index.html">Sparc Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../x86/index.html">x86-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtensa/index.html">Xtensa Architecture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/ext4/index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Linux Kernel Crypto API</a> &raquo;</li>
        
          <li><a href="api.html">Programming Interface</a> &raquo;</li>
        
      <li>Authenticated Encryption With Associated Data (AEAD) Algorithm Definitions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/crypto/api-aead.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="authenticated-encryption-with-associated-data-aead-algorithm-definitions">
<h1>Authenticated Encryption With Associated Data (AEAD) Algorithm Definitions<a class="headerlink" href="#authenticated-encryption-with-associated-data-aead-algorithm-definitions" title="Permalink to this headline">¶</a></h1>
<p>The AEAD cipher API is used with the ciphers of type CRYPTO_ALG_TYPE_AEAD
(listed as type “aead” in /proc/crypto)</p>
<p>The most prominent examples for this type of encryption is GCM and CCM.
However, the kernel supports other types of AEAD ciphers which are defined
with the following cipher string:</p>
<blockquote>
<div><p>authenc(keyed message digest, block cipher)</p>
</div></blockquote>
<p>For example: authenc(hmac(sha256), cbc(aes))</p>
<p>The example code provided for the symmetric key cipher operation
applies here as well. Naturally all <em>skcipher</em> symbols must be exchanged
the <em>aead</em> pendants discussed in the following. In addition, for the AEAD
operation, the aead_request_set_ad function must be used to set the
pointer to the associated data memory location before performing the
encryption or decryption operation. In case of an encryption, the associated
data memory is filled during the encryption operation. For decryption, the
associated data memory must contain data that is used to verify the integrity
of the decrypted data. Another deviation from the asynchronous block cipher
operation is that the caller should explicitly check for -EBADMSG of the
crypto_aead_decrypt. That error indicates an authentication error, i.e.
a breach in the integrity of the message. In essence, that -EBADMSG error
code is the key bonus an AEAD cipher has over “standard” block chaining
modes.</p>
<p>Memory Structure:</p>
<p>The source scatterlist must contain the concatenation of
associated data || plaintext or ciphertext.</p>
<p>The destination scatterlist has the same layout, except that the plaintext
(resp. ciphertext) will grow (resp. shrink) by the authentication tag size
during encryption (resp. decryption).</p>
<p>In-place encryption/decryption is enabled by using the same scatterlist
pointer for both the source and destination.</p>
<p>Even in the out-of-place case, space must be reserved in the destination for
the associated data, even though it won’t be written to.  This makes the
in-place and out-of-place cases more consistent.  It is permissible for the
“destination” associated data to alias the “source” associated data.</p>
<p>As with the other scatterlist crypto APIs, zero-length scatterlist elements
are not allowed in the used part of the scatterlist.  Thus, if there is no
associated data, the first element must point to the plaintext/ciphertext.</p>
<p>To meet the needs of IPsec, a special quirk applies to rfc4106, rfc4309,
rfc4543, and rfc7539esp ciphers.  For these ciphers, the final ‘ivsize’ bytes
of the associated data buffer must contain a second copy of the IV.  This is
in addition to the copy passed to <a class="reference internal" href="#c.aead_request_set_crypt" title="aead_request_set_crypt"><code class="xref c c-func docutils literal notranslate"><span class="pre">aead_request_set_crypt()</span></code></a>.  These two IV
copies must not differ; different implementations of the same algorithm may
behave differently in that case.  Note that the algorithm might not actually
treat the IV as associated data; nevertheless the length passed to
<a class="reference internal" href="#c.aead_request_set_ad" title="aead_request_set_ad"><code class="xref c c-func docutils literal notranslate"><span class="pre">aead_request_set_ad()</span></code></a> must include it.</p>
<dl class="type">
<dt id="c.aead_request">
struct <code class="sig-name descname">aead_request</code><a class="headerlink" href="#c.aead_request" title="Permalink to this definition">¶</a></dt>
<dd><p>AEAD request</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct aead_request {
  struct crypto_async_request base;
  unsigned int assoclen;
  unsigned int cryptlen;
  u8 *iv;
  struct scatterlist *src;
  struct scatterlist *dst;
  void *__ctx[] ;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">base</span></code></dt><dd><p>Common attributes for async crypto requests</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">assoclen</span></code></dt><dd><p>Length in bytes of associated data for authentication</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">cryptlen</span></code></dt><dd><p>Length of data to be encrypted or decrypted</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">iv</span></code></dt><dd><p>Initialisation vector</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">src</span></code></dt><dd><p>Source data</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dst</span></code></dt><dd><p>Destination data</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">__ctx</span></code></dt><dd><p>Start of private context data</p>
</dd>
</dl>
<dl class="type">
<dt id="c.aead_alg">
struct <code class="sig-name descname">aead_alg</code><a class="headerlink" href="#c.aead_alg" title="Permalink to this definition">¶</a></dt>
<dd><p>AEAD cipher definition</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct aead_alg {
  int (*setkey)(struct crypto_aead *tfm, const u8 *key, unsigned int keylen);
  int (*setauthsize)(struct crypto_aead *tfm, unsigned int authsize);
  int (*encrypt)(struct aead_request *req);
  int (*decrypt)(struct aead_request *req);
  int (*init)(struct crypto_aead *tfm);
  void (*exit)(struct crypto_aead *tfm);
  unsigned int ivsize;
  unsigned int maxauthsize;
  unsigned int chunksize;
  struct crypto_alg base;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">setkey</span></code></dt><dd><p>see struct skcipher_alg</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">setauthsize</span></code></dt><dd><p>Set authentication size for the AEAD transformation. This
function is used to specify the consumer requested size of the
authentication tag to be either generated by the transformation
during encryption or the size of the authentication tag to be
supplied during the decryption operation. This function is also
responsible for checking the authentication tag size for
validity.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">encrypt</span></code></dt><dd><p>see struct skcipher_alg</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">decrypt</span></code></dt><dd><p>see struct skcipher_alg</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">init</span></code></dt><dd><p>Initialize the cryptographic transformation object. This function
is used to initialize the cryptographic transformation object.
This function is called only once at the instantiation time, right
after the transformation context was allocated. In case the
cryptographic hardware has some special requirements which need to
be handled by software, this function shall check for the precise
requirement of the transformation and put any software fallbacks
in place.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">exit</span></code></dt><dd><p>Deinitialize the cryptographic transformation object. This is a
counterpart to <strong>init</strong>, used to remove various changes set in
<strong>init</strong>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ivsize</span></code></dt><dd><p>see struct skcipher_alg</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">maxauthsize</span></code></dt><dd><p>Set the maximum authentication tag size supported by the
transformation. A transformation may support smaller tag sizes.
As the authentication tag is a message digest to ensure the
integrity of the encrypted data, a consumer typically wants the
largest authentication tag possible as defined by this
variable.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">chunksize</span></code></dt><dd><p>see struct skcipher_alg</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">base</span></code></dt><dd><p>Definition of a generic crypto cipher algorithm.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>All fields except <strong>ivsize</strong> is mandatory and must be filled.</p>
</div>
<div class="section" id="authenticated-encryption-with-associated-data-aead-cipher-api">
<h1>Authenticated Encryption With Associated Data (AEAD) Cipher API<a class="headerlink" href="#authenticated-encryption-with-associated-data-aead-cipher-api" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="c.crypto_alloc_aead">
struct crypto_aead * <code class="sig-name descname">crypto_alloc_aead</code><span class="sig-paren">(</span>const char *<em> alg_name</em>, u32<em> type</em>, u32<em> mask</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_alloc_aead" title="Permalink to this definition">¶</a></dt>
<dd><p>allocate AEAD cipher handle</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*</span> <span class="pre">alg_name</span></code></dt><dd><p>is the cra_name / name or cra_driver_name / driver name of the
AEAD cipher</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">type</span></code></dt><dd><p>specifies the type of the cipher</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">mask</span></code></dt><dd><p>specifies the mask for the cipher</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Allocate a cipher handle for an AEAD. The returned struct
crypto_aead is the cipher handle that is required for any subsequent
API invocation for that AEAD.</p>
<p><strong>Return</strong></p>
<dl class="simple">
<dt>allocated cipher handle in case of success; IS_ERR() is true in case</dt><dd><p>of an error, PTR_ERR() returns the error code.</p>
</dd>
</dl>
<dl class="function">
<dt id="c.crypto_free_aead">
void <code class="sig-name descname">crypto_free_aead</code><span class="sig-paren">(</span>struct crypto_aead *<em> tfm</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_free_aead" title="Permalink to this definition">¶</a></dt>
<dd><p>zeroize and free aead handle</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_aead</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt><dd><p>cipher handle to be freed</p>
</dd>
</dl>
<dl class="function">
<dt id="c.crypto_aead_ivsize">
unsigned int <code class="sig-name descname">crypto_aead_ivsize</code><span class="sig-paren">(</span>struct crypto_aead *<em> tfm</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_aead_ivsize" title="Permalink to this definition">¶</a></dt>
<dd><p>obtain IV size</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_aead</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt><dd><p>cipher handle</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>The size of the IV for the aead referenced by the cipher handle is
returned. This IV size may be zero if the cipher does not need an IV.</p>
<p><strong>Return</strong></p>
<p>IV size in bytes</p>
<dl class="function">
<dt id="c.crypto_aead_authsize">
unsigned int <code class="sig-name descname">crypto_aead_authsize</code><span class="sig-paren">(</span>struct crypto_aead *<em> tfm</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_aead_authsize" title="Permalink to this definition">¶</a></dt>
<dd><p>obtain maximum authentication data size</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_aead</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt><dd><p>cipher handle</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>The maximum size of the authentication data for the AEAD cipher referenced
by the AEAD cipher handle is returned. The authentication data size may be
zero if the cipher implements a hard-coded maximum.</p>
<p>The authentication data may also be known as “tag value”.</p>
<p><strong>Return</strong></p>
<p>authentication data size / tag size in bytes</p>
<dl class="function">
<dt id="c.crypto_aead_blocksize">
unsigned int <code class="sig-name descname">crypto_aead_blocksize</code><span class="sig-paren">(</span>struct crypto_aead *<em> tfm</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_aead_blocksize" title="Permalink to this definition">¶</a></dt>
<dd><p>obtain block size of cipher</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_aead</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt><dd><p>cipher handle</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>The block size for the AEAD referenced with the cipher handle is returned.
The caller may use that information to allocate appropriate memory for the
data returned by the encryption or decryption operation</p>
<p><strong>Return</strong></p>
<p>block size of cipher</p>
<dl class="function">
<dt id="c.crypto_aead_setkey">
int <code class="sig-name descname">crypto_aead_setkey</code><span class="sig-paren">(</span>struct crypto_aead *<em> tfm</em>, const u8 *<em> key</em>, unsigned int<em> keylen</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_aead_setkey" title="Permalink to this definition">¶</a></dt>
<dd><p>set key for cipher</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_aead</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt><dd><p>cipher handle</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">u8</span> <span class="pre">*</span> <span class="pre">key</span></code></dt><dd><p>buffer holding the key</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">keylen</span></code></dt><dd><p>length of the key in bytes</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>The caller provided key is set for the AEAD referenced by the cipher
handle.</p>
<p>Note, the key length determines the cipher type. Many block ciphers implement
different cipher modes depending on the key size, such as AES-128 vs AES-192
vs. AES-256. When providing a 16 byte key for an AES cipher handle, AES-128
is performed.</p>
<p><strong>Return</strong></p>
<p>0 if the setting of the key was successful; &lt; 0 if an error occurred</p>
<dl class="function">
<dt id="c.crypto_aead_setauthsize">
int <code class="sig-name descname">crypto_aead_setauthsize</code><span class="sig-paren">(</span>struct crypto_aead *<em> tfm</em>, unsigned int<em> authsize</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_aead_setauthsize" title="Permalink to this definition">¶</a></dt>
<dd><p>set authentication data size</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_aead</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt><dd><p>cipher handle</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">authsize</span></code></dt><dd><p>size of the authentication data / tag in bytes</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Set the authentication data size / tag size. AEAD requires an authentication
tag (or MAC) in addition to the associated data.</p>
<p><strong>Return</strong></p>
<p>0 if the setting of the key was successful; &lt; 0 if an error occurred</p>
<dl class="function">
<dt id="c.crypto_aead_encrypt">
int <code class="sig-name descname">crypto_aead_encrypt</code><span class="sig-paren">(</span>struct <a class="reference internal" href="#c.aead_request" title="aead_request">aead_request</a> *<em> req</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_aead_encrypt" title="Permalink to this definition">¶</a></dt>
<dd><p>encrypt plaintext</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">aead_request</span> <span class="pre">*</span> <span class="pre">req</span></code></dt><dd><p>reference to the aead_request handle that holds all information
needed to perform the cipher operation</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Encrypt plaintext data using the aead_request handle. That data structure
and how it is filled with data is discussed with the aead_request_*
functions.</p>
<dl class="simple">
<dt>IMPORTANT NOTE The encryption operation creates the authentication data /</dt><dd><p>tag. That data is concatenated with the created ciphertext.
The ciphertext memory size is therefore the given number of
block cipher blocks + the size defined by the
crypto_aead_setauthsize invocation. The caller must ensure
that sufficient memory is available for the ciphertext and
the authentication tag.</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>0 if the cipher operation was successful; &lt; 0 if an error occurred</p>
<dl class="function">
<dt id="c.crypto_aead_decrypt">
int <code class="sig-name descname">crypto_aead_decrypt</code><span class="sig-paren">(</span>struct <a class="reference internal" href="#c.aead_request" title="aead_request">aead_request</a> *<em> req</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_aead_decrypt" title="Permalink to this definition">¶</a></dt>
<dd><p>decrypt ciphertext</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">aead_request</span> <span class="pre">*</span> <span class="pre">req</span></code></dt><dd><p>reference to the aead_request handle that holds all information
needed to perform the cipher operation</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Decrypt ciphertext data using the aead_request handle. That data structure
and how it is filled with data is discussed with the aead_request_*
functions.</p>
<dl class="simple">
<dt>IMPORTANT NOTE The caller must concatenate the ciphertext followed by the</dt><dd><p>authentication data / tag. That authentication data / tag
must have the size defined by the crypto_aead_setauthsize
invocation.</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<dl class="simple">
<dt>0 if the cipher operation was successful; -EBADMSG: The AEAD</dt><dd><p>cipher operation performs the authentication of the data during the
decryption operation. Therefore, the function returns this error if
the authentication of the ciphertext was unsuccessful (i.e. the
integrity of the ciphertext or the associated data was violated);
&lt; 0 if an error occurred.</p>
</dd>
</dl>
</div>
<div class="section" id="asynchronous-aead-request-handle">
<h1>Asynchronous AEAD Request Handle<a class="headerlink" href="#asynchronous-aead-request-handle" title="Permalink to this headline">¶</a></h1>
<p>The aead_request data structure contains all pointers to data required for
the AEAD cipher operation. This includes the cipher handle (which can be
used by multiple aead_request instances), pointer to plaintext and
ciphertext, asynchronous callback function, etc. It acts as a handle to the
aead_request_* API calls in a similar way as AEAD handle to the
crypto_aead_* API calls.</p>
<dl class="function">
<dt id="c.crypto_aead_reqsize">
unsigned int <code class="sig-name descname">crypto_aead_reqsize</code><span class="sig-paren">(</span>struct crypto_aead *<em> tfm</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_aead_reqsize" title="Permalink to this definition">¶</a></dt>
<dd><p>obtain size of the request data structure</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_aead</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt><dd><p>cipher handle</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>number of bytes</p>
<dl class="function">
<dt id="c.aead_request_set_tfm">
void <code class="sig-name descname">aead_request_set_tfm</code><span class="sig-paren">(</span>struct <a class="reference internal" href="#c.aead_request" title="aead_request">aead_request</a> *<em> req</em>, struct crypto_aead *<em> tfm</em><span class="sig-paren">)</span><a class="headerlink" href="#c.aead_request_set_tfm" title="Permalink to this definition">¶</a></dt>
<dd><p>update cipher handle reference in request</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">aead_request</span> <span class="pre">*</span> <span class="pre">req</span></code></dt><dd><p>request handle to be modified</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_aead</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt><dd><p>cipher handle that shall be added to the request handle</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Allow the caller to replace the existing aead handle in the request
data structure with a different one.</p>
<dl class="function">
<dt id="c.aead_request_alloc">
struct <a class="reference internal" href="#c.aead_request" title="aead_request">aead_request</a> * <code class="sig-name descname">aead_request_alloc</code><span class="sig-paren">(</span>struct crypto_aead *<em> tfm</em>, gfp_t<em> gfp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.aead_request_alloc" title="Permalink to this definition">¶</a></dt>
<dd><p>allocate request data structure</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_aead</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt><dd><p>cipher handle to be registered with the request</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">gfp_t</span> <span class="pre">gfp</span></code></dt><dd><p>memory allocation flag that is handed to kmalloc by the API call.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Allocate the request data structure that must be used with the AEAD
encrypt and decrypt API calls. During the allocation, the provided aead
handle is registered in the request data structure.</p>
<p><strong>Return</strong></p>
<p>allocated request handle in case of success, or NULL if out of memory</p>
<dl class="function">
<dt id="c.aead_request_free">
void <code class="sig-name descname">aead_request_free</code><span class="sig-paren">(</span>struct <a class="reference internal" href="#c.aead_request" title="aead_request">aead_request</a> *<em> req</em><span class="sig-paren">)</span><a class="headerlink" href="#c.aead_request_free" title="Permalink to this definition">¶</a></dt>
<dd><p>zeroize and free request data structure</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">aead_request</span> <span class="pre">*</span> <span class="pre">req</span></code></dt><dd><p>request data structure cipher handle to be freed</p>
</dd>
</dl>
<dl class="function">
<dt id="c.aead_request_set_callback">
void <code class="sig-name descname">aead_request_set_callback</code><span class="sig-paren">(</span>struct <a class="reference internal" href="#c.aead_request" title="aead_request">aead_request</a> *<em> req</em>, u32<em> flags</em>, crypto_completion_t<em> compl</em>, void *<em> data</em><span class="sig-paren">)</span><a class="headerlink" href="#c.aead_request_set_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>set asynchronous callback function</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">aead_request</span> <span class="pre">*</span> <span class="pre">req</span></code></dt><dd><p>request handle</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">flags</span></code></dt><dd><p>specify zero or an ORing of the flags
CRYPTO_TFM_REQ_MAY_BACKLOG the request queue may back log and
increase the wait queue beyond the initial maximum size;
CRYPTO_TFM_REQ_MAY_SLEEP the request processing may sleep</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">crypto_completion_t</span> <span class="pre">compl</span></code></dt><dd><p>callback function pointer to be registered with the request handle</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span> <span class="pre">data</span></code></dt><dd><p>The data pointer refers to memory that is not used by the kernel
crypto API, but provided to the callback function for it to use. Here,
the caller can provide a reference to memory the callback function can
operate on. As the callback function is invoked asynchronously to the
related functionality, it may need to access data structures of the
related functionality which can be referenced using this pointer. The
callback function can access the memory via the “data” field in the
crypto_async_request data structure provided to the callback function.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Setting the callback function that is triggered once the cipher operation
completes</p>
<p>The callback function is registered with the aead_request handle and
must comply with the following template:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void callback_function(struct crypto_async_request *req, int error)
</pre></div>
</div>
<dl class="function">
<dt id="c.aead_request_set_crypt">
void <code class="sig-name descname">aead_request_set_crypt</code><span class="sig-paren">(</span>struct <a class="reference internal" href="#c.aead_request" title="aead_request">aead_request</a> *<em> req</em>, struct scatterlist *<em> src</em>, struct scatterlist *<em> dst</em>, unsigned int<em> cryptlen</em>, u8 *<em> iv</em><span class="sig-paren">)</span><a class="headerlink" href="#c.aead_request_set_crypt" title="Permalink to this definition">¶</a></dt>
<dd><p>set data buffers</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">aead_request</span> <span class="pre">*</span> <span class="pre">req</span></code></dt><dd><p>request handle</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">scatterlist</span> <span class="pre">*</span> <span class="pre">src</span></code></dt><dd><p>source scatter / gather list</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">scatterlist</span> <span class="pre">*</span> <span class="pre">dst</span></code></dt><dd><p>destination scatter / gather list</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">cryptlen</span></code></dt><dd><p>number of bytes to process from <strong>src</strong></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">*</span> <span class="pre">iv</span></code></dt><dd><p>IV for the cipher operation which must comply with the IV size defined
by <a class="reference internal" href="#c.crypto_aead_ivsize" title="crypto_aead_ivsize"><code class="xref c c-func docutils literal notranslate"><span class="pre">crypto_aead_ivsize()</span></code></a></p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Setting the source data and destination data scatter / gather lists which
hold the associated data concatenated with the plaintext or ciphertext. See
below for the authentication tag.</p>
<p>For encryption, the source is treated as the plaintext and the
destination is the ciphertext. For a decryption operation, the use is
reversed - the source is the ciphertext and the destination is the plaintext.</p>
<p>The memory structure for cipher operation has the following structure:</p>
<ul class="simple">
<li><p>AEAD encryption input:  assoc data || plaintext</p></li>
<li><p>AEAD encryption output: assoc data || cipherntext || auth tag</p></li>
<li><p>AEAD decryption input:  assoc data || ciphertext || auth tag</p></li>
<li><p>AEAD decryption output: assoc data || plaintext</p></li>
</ul>
<p>Albeit the kernel requires the presence of the AAD buffer, however,
the kernel does not fill the AAD buffer in the output case. If the
caller wants to have that data buffer filled, the caller must either
use an in-place cipher operation (i.e. same memory location for
input/output memory location).</p>
<dl class="function">
<dt id="c.aead_request_set_ad">
void <code class="sig-name descname">aead_request_set_ad</code><span class="sig-paren">(</span>struct <a class="reference internal" href="#c.aead_request" title="aead_request">aead_request</a> *<em> req</em>, unsigned int<em> assoclen</em><span class="sig-paren">)</span><a class="headerlink" href="#c.aead_request_set_ad" title="Permalink to this definition">¶</a></dt>
<dd><p>set associated data information</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">aead_request</span> <span class="pre">*</span> <span class="pre">req</span></code></dt><dd><p>request handle</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">assoclen</span></code></dt><dd><p>number of bytes in associated data</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Setting the AD information.  This function sets the length of
the associated data.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api-digest.html" class="btn btn-neutral float-right" title="Message Digest Algorithm Definitions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="api-skcipher.html" class="btn btn-neutral float-left" title="Block Cipher Algorithm Definitions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
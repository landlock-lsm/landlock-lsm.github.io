

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Linux NCR53C8XX/SYM53C8XX drivers README file &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="WorkBiT NinjaSCSI-3/32Bi driver for Linux" href="NinjaSCSI.html" />
    <link rel="prev" title="Notes on Management Module" href="megaraid.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.9.0-rc8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devicetree/index.html">Open Firmware and Device Tree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Linux SCSI Subsystem</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="53c700.html">The 53c700 Driver Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="aacraid.html">AACRAID Driver for Linux (take two)</a></li>
<li class="toctree-l2"><a class="reference internal" href="advansys.html">AdvanSys Driver Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="aha152x.html">Adaptec AHA-1520/1522 SCSI driver for Linux (aha152x)</a></li>
<li class="toctree-l2"><a class="reference internal" href="aic79xx.html">Adaptec Ultra320 Family Manager Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="aic7xxx.html">Adaptec Aic7xxx Fast -&gt; Ultra160 Family Manager Set v7.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="arcmsr_spec.html">ARECA FIRMWARE SPEC</a></li>
<li class="toctree-l2"><a class="reference internal" href="arcmsr_spec.html#usage-of-iop331-adapter">Usage of IOP331 adapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="arcmsr_spec.html#rs-232-interface-for-areca-raid-controller">RS-232 Interface for Areca Raid Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="bfa.html">Linux driver for Brocade FC/FCOE adapters</a></li>
<li class="toctree-l2"><a class="reference internal" href="bnx2fc.html">Operating FCoE using bnx2fc</a></li>
<li class="toctree-l2"><a class="reference internal" href="BusLogic.html">BusLogic MultiMaster and FlashPoint SCSI Driver for Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="cxgb3i.html">Chelsio S3 iSCSI Driver for Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="dc395x.html">README file for the dc395x SCSI driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="dpti.html">Adaptec dpti driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="FlashPoint.html">The BusLogic FlashPoint SCSI Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="g_NCR5380.html">README file for the Linux g_NCR5380 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="hpsa.html">HPSA - Hewlett Packard Smart Array driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="hptiop.html">Highpoint RocketRAID 3xxx/4xxx Adapter Driver (hptiop)</a></li>
<li class="toctree-l2"><a class="reference internal" href="libsas.html">SAS Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="link_power_management_policy.html">Link Power Managent Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="lpfc.html">LPFC Driver Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="megaraid.html">Notes on Management Module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">The Linux NCR53C8XX/SYM53C8XX drivers README file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-chips-and-scsi-features">2. Supported chips and SCSI features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advantages-of-the-enhanced-896-driver">3. Advantages of the enhanced 896 driver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#optimized-scsi-scripts">3.1 Optimized SCSI SCRIPTS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#new-features-of-the-sym53c896-64-bit-pci-dual-lvd-scsi-controller">3.2 New features of the SYM53C896 (64 bit PCI dual LVD SCSI controller)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#memory-mapped-i-o-versus-normal-i-o">4. Memory mapped I/O versus normal I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tagged-command-queueing">5. Tagged command queueing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parity-checking">6. Parity checking</a></li>
<li class="toctree-l3"><a class="reference internal" href="#profiling-information">7. Profiling information</a></li>
<li class="toctree-l3"><a class="reference internal" href="#control-commands">8. Control commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#set-minimum-synchronous-period-factor">8.1 Set minimum synchronous period factor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-wide-size">8.2 Set wide size</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-maximum-number-of-concurrent-tagged-commands">8.3 Set maximum number of concurrent tagged commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-order-type-for-tagged-command">8.4 Set order type for tagged command</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-debug-mode">8.5 Set debug mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clear-profile-counters">8.6 Clear profile counters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-flag-no-disc">8.7 Set flag (no_disc)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-verbose-level">8.8 Set verbose level</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reset-all-logical-units-of-a-target">8.9 Reset all logical units of a target</a></li>
<li class="toctree-l4"><a class="reference internal" href="#abort-all-tasks-of-all-logical-units-of-a-target">8.10 Abort all tasks of all logical units of a target</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-parameters">9. Configuration parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boot-setup-commands">10. Boot setup commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#syntax">10.1 Syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="#available-arguments">10.2 Available arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pci-configuration-fix-up-boot-option">10.4 PCI configuration fix-up boot option</a></li>
<li class="toctree-l4"><a class="reference internal" href="#serial-nvram-support-boot-option">10.5 Serial NVRAM support boot option</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#some-constants-and-flags-of-the-ncr53c8xx-h-header-file">11. Some constants and flags of the ncr53c8xx.h header file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation">12. Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#architecture-dependent-features">13. Architecture dependent features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#known-problems">14. Known problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tagged-commands-with-iomega-jaz-device">14.1 Tagged commands with Iomega Jaz device</a></li>
<li class="toctree-l4"><a class="reference internal" href="#device-names-change-when-another-controller-is-added">14.2 Device names change when another controller is added</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-only-8-bit-devices-with-a-wide-scsi-controller">14.3 Using only 8 bit devices with a WIDE SCSI controller</a></li>
<li class="toctree-l4"><a class="reference internal" href="#possible-data-corruption-during-a-memory-write-and-invalidate">14.4 Possible data corruption during a Memory Write and Invalidate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#scsi-problem-troubleshooting">15. SCSI problem troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#problem-tracking">15.1 Problem tracking</a></li>
<li class="toctree-l4"><a class="reference internal" href="#understanding-hardware-error-reports">15.2 Understanding hardware error reports</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#synchronous-transfer-negotiation-tables">16. Synchronous transfer negotiation tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">17. Serial NVRAM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#features">17.1 Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#symbios-nvram-layout">17.2 Symbios NVRAM layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="#default-set-up-is-identical-for-53c810a-and-53c875-nvram">default set up is identical for 53c810a and 53c875 NVRAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">default set up is identical for 53c810a and 53c875 NVRAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">default set up is identical for 53c810a and 53c875 NVRAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tekram-nvram-layout">17.3 Tekram NVRAM layout</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#support-for-big-endian">18. Support for Big Endian</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#big-endian-cpu">18.1 Big Endian CPU</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ncr-chip-in-big-endian-mode-of-operations">18.2 NCR chip in Big Endian mode of operations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="NinjaSCSI.html">WorkBiT NinjaSCSI-3/32Bi driver for Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="ppa.html">Terse where to get ZIP Drive help info</a></li>
<li class="toctree-l2"><a class="reference internal" href="qlogicfas.html">Qlogic FASXXX Family Driver Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="scsi-changer.html">README for the SCSI media changer driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="scsi_eh.html">SCSI EH</a></li>
<li class="toctree-l2"><a class="reference internal" href="scsi_fc_transport.html">SCSI FC Tansport</a></li>
<li class="toctree-l2"><a class="reference internal" href="scsi-generic.html">Notes on Linux SCSI Generic (sg) driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="scsi_mid_low_api.html">SCSI mid_level - lower_level driver interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="scsi-parameters.html">SCSI Kernel Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="scsi.html">SCSI subsystem documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="sd-parameters.html">Linux SCSI Disk Driver (sd) Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="smartpqi.html">SMARTPQI - Microsemi Smart PQI Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="st.html">The SCSI Tape Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="sym53c500_cs.html">The sym53c500_cs Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="sym53c8xx_2.html">The Linux SYM-2 driver documentation file</a></li>
<li class="toctree-l2"><a class="reference internal" href="tcm_qla2xxx.html">tcm_qla2xxx Driver Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="ufs.html">Universal Flash Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="wd719x.html">Driver for Western Digital WD7193, WD7197 and WD7296 SCSI cards</a></li>
<li class="toctree-l2"><a class="reference internal" href="scsi_transport_srp/figures.html">SCSI RDMA (SRP) transport class diagram</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mhi/index.html">MHI</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arm/index.html">ARM Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arm64/index.html">ARM64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ia64/index.html">IA-64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../m68k/index.html">m68k Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mips/index.html">MIPS-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nios2/nios2.html">Linux on the Nios II architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openrisc/index.html">OpenRISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parisc/index.html">PA-RISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../powerpc/index.html">powerpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../riscv/index.html">RISC-V architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../s390/index.html">s390 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sparc/index.html">Sparc Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../x86/index.html">x86-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtensa/index.html">Xtensa Architecture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/ext4/index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html">Unsorted Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#atomic-types">Atomic Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#atomic-bitops">Atomic bitops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html#memory-barriers">Memory Barriers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../watch_queue.html">General notification mechanism</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Linux SCSI Subsystem</a> &raquo;</li>
        
      <li>The Linux NCR53C8XX/SYM53C8XX drivers README file</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/scsi/ncr53c8xx.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-linux-ncr53c8xx-sym53c8xx-drivers-readme-file">
<h1>The Linux NCR53C8XX/SYM53C8XX drivers README file<a class="headerlink" href="#the-linux-ncr53c8xx-sym53c8xx-drivers-readme-file" title="Permalink to this headline">¶</a></h1>
<p>Written by Gerard Roudier &lt;<a class="reference external" href="mailto:groudier&#37;&#52;&#48;free&#46;fr">groudier<span>&#64;</span>free<span>&#46;</span>fr</a>&gt;</p>
<p>21 Rue Carnot</p>
<p>95170 DEUIL LA BARRE - FRANCE</p>
<p>29 May 1999</p>
<div class="section" id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The initial Linux ncr53c8xx driver has been a port of the ncr driver from
FreeBSD that has been achieved in November 1995 by:</p>
<blockquote>
<div><ul class="simple">
<li>Gerard Roudier              &lt;<a class="reference external" href="mailto:groudier&#37;&#52;&#48;free&#46;fr">groudier<span>&#64;</span>free<span>&#46;</span>fr</a>&gt;</li>
</ul>
</div></blockquote>
<p>The original driver has been written for 386bsd and FreeBSD by:</p>
<blockquote>
<div><ul class="simple">
<li>Wolfgang Stanglmeier        &lt;<a class="reference external" href="mailto:wolf&#37;&#52;&#48;cologne&#46;de">wolf<span>&#64;</span>cologne<span>&#46;</span>de</a>&gt;</li>
<li>Stefan Esser                &lt;<a class="reference external" href="mailto:se&#37;&#52;&#48;mi&#46;Uni-Koeln&#46;de">se<span>&#64;</span>mi<span>&#46;</span>Uni-Koeln<span>&#46;</span>de</a>&gt;</li>
</ul>
</div></blockquote>
<p>It is now available as a bundle of 2 drivers:</p>
<ul class="simple">
<li>ncr53c8xx generic driver that supports all the SYM53C8XX family including
the earliest 810 rev. 1, the latest 896 (2 channel LVD SCSI controller) and
the new 895A (1 channel LVD SCSI controller).</li>
<li>sym53c8xx enhanced driver (a.k.a. 896 drivers) that drops support of oldest
chips in order to gain advantage of new features, as LOAD/STORE instructions
available since the 810A and hardware phase mismatch available with the
896 and the 895A.</li>
</ul>
<p>You can find technical information about the NCR 8xx family in the
PCI-HOWTO written by Michael Will and in the SCSI-HOWTO written by
Drew Eckhardt.</p>
<p>Information about new chips is available at LSILOGIC web server:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://www.lsilogic.com/">http://www.lsilogic.com/</a></li>
</ul>
</div></blockquote>
<p>SCSI standard documentations are available at SYMBIOS ftp server:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="ftp://ftp.symbios.com/">ftp://ftp.symbios.com/</a></li>
</ul>
</div></blockquote>
<p>Useful SCSI tools written by Eric Youngdale are available at tsx-11:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="ftp://tsx-11.mit.edu/pub/linux/ALPHA/scsi/scsiinfo-X.Y.tar.gz">ftp://tsx-11.mit.edu/pub/linux/ALPHA/scsi/scsiinfo-X.Y.tar.gz</a></li>
<li><a class="reference external" href="ftp://tsx-11.mit.edu/pub/linux/ALPHA/scsi/scsidev-X.Y.tar.gz">ftp://tsx-11.mit.edu/pub/linux/ALPHA/scsi/scsidev-X.Y.tar.gz</a></li>
</ul>
</div></blockquote>
<p>These tools are not ALPHA but quite clean and work quite well.
It is essential you have the ‘scsiinfo’ package.</p>
<p>This short documentation describes the features of the generic and enhanced
drivers, configuration parameters and control commands available through
the proc SCSI file system read / write operations.</p>
<p>This driver has been tested OK with linux/i386, Linux/Alpha and Linux/PPC.</p>
<p>Latest driver version and patches are available at:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="ftp://ftp.tux.org/pub/people/gerard-roudier">ftp://ftp.tux.org/pub/people/gerard-roudier</a></li>
</ul>
</div></blockquote>
<p>or</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="ftp://ftp.symbios.com/mirror/ftp.tux.org/pub/tux/roudier/drivers">ftp://ftp.symbios.com/mirror/ftp.tux.org/pub/tux/roudier/drivers</a></li>
</ul>
</div></blockquote>
<p>I am not a native speaker of English and there are probably lots of
mistakes in this README file. Any help will be welcome.</p>
</div>
<div class="section" id="supported-chips-and-scsi-features">
<h2>2. Supported chips and SCSI features<a class="headerlink" href="#supported-chips-and-scsi-features" title="Permalink to this headline">¶</a></h2>
<p>The following features are supported for all chips:</p>
<blockquote>
<div><ul class="simple">
<li>Synchronous negotiation</li>
<li>Disconnection</li>
<li>Tagged command queuing</li>
<li>SCSI parity checking</li>
<li>Master parity checking</li>
</ul>
</div></blockquote>
<p>“Wide negotiation” is supported for chips that allow it.  The
following table shows some characteristics of NCR 8xx family chips
and what drivers support them.</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="15%" />
<col width="7%" />
<col width="15%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Chip</td>
<td>On board
SDMS BIOS</td>
<td>Wide</td>
<td>SCSI std.</td>
<td>Max. sync</td>
<td>Supported by
the generic
driver</td>
<td>Supported by
the enhanced
driver</td>
</tr>
<tr class="row-even"><td>810</td>
<td>N</td>
<td>N</td>
<td>FAST10</td>
<td>10 MB/s</td>
<td>Y</td>
<td>N</td>
</tr>
<tr class="row-odd"><td>810A</td>
<td>N</td>
<td>N</td>
<td>FAST10</td>
<td>10 MB/s</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-even"><td>815</td>
<td>Y</td>
<td>N</td>
<td>FAST10</td>
<td>10 MB/s</td>
<td>Y</td>
<td>N</td>
</tr>
<tr class="row-odd"><td>825</td>
<td>Y</td>
<td>Y</td>
<td>FAST10</td>
<td>20 MB/s</td>
<td>Y</td>
<td>N</td>
</tr>
<tr class="row-even"><td>825A</td>
<td>Y</td>
<td>Y</td>
<td>FAST10</td>
<td>20 MB/s</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-odd"><td>860</td>
<td>N</td>
<td>N</td>
<td>FAST20</td>
<td>20 MB/s</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-even"><td>875</td>
<td>Y</td>
<td>Y</td>
<td>FAST20</td>
<td>40 MB/s</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-odd"><td>876</td>
<td>Y</td>
<td>Y</td>
<td>FAST20</td>
<td>40 MB/s</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-even"><td>895</td>
<td>Y</td>
<td>Y</td>
<td>FAST40</td>
<td>80 MB/s</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-odd"><td>895A</td>
<td>Y</td>
<td>Y</td>
<td>FAST40</td>
<td>80 MB/s</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-even"><td>896</td>
<td>Y</td>
<td>Y</td>
<td>FAST40</td>
<td>80 MB/s</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-odd"><td>897</td>
<td>Y</td>
<td>Y</td>
<td>FAST40</td>
<td>80 MB/s</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-even"><td>1510D</td>
<td>Y</td>
<td>Y</td>
<td>FAST40</td>
<td>80 MB/s</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-odd"><td>1010</td>
<td>Y</td>
<td>Y</td>
<td>FAST80</td>
<td>160 MB/s</td>
<td>N</td>
<td>Y</td>
</tr>
<tr class="row-even"><td>1010_66
<a class="footnote-reference" href="#id2" id="id1">[1]</a></td>
<td>Y</td>
<td>Y</td>
<td>FAST80</td>
<td>160 MB/s</td>
<td>N</td>
<td>Y</td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Chip supports 33MHz and 66MHz PCI buses.</td></tr>
</tbody>
</table>
<p>Summary of other supported features:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Module:</th><td class="field-body">allow to load the driver</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Memory mapped I/O:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">increases performance</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Profiling information:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">read operations from the proc SCSI file system</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Control commands:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">write operations to the proc SCSI file system</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Debugging information:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">written to syslog (expert only)</td>
</tr>
<tr class="field-even field"><th class="field-name">Serial NVRAM:</th><td class="field-body">Symbios and Tekram formats</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Scatter / gather</li>
<li>Shared interrupt</li>
<li>Boot setup commands</li>
</ul>
</div>
<div class="section" id="advantages-of-the-enhanced-896-driver">
<h2>3. Advantages of the enhanced 896 driver<a class="headerlink" href="#advantages-of-the-enhanced-896-driver" title="Permalink to this headline">¶</a></h2>
<div class="section" id="optimized-scsi-scripts">
<h3>3.1 Optimized SCSI SCRIPTS<a class="headerlink" href="#optimized-scsi-scripts" title="Permalink to this headline">¶</a></h3>
<p>The 810A, 825A, 875, 895, 896 and 895A support new SCSI SCRIPTS instructions
named LOAD and STORE that allow to move up to 1 DWORD from/to an IO register
to/from memory much faster that the MOVE MEMORY instruction that is supported
by the 53c7xx and 53c8xx family.
The LOAD/STORE instructions support absolute and DSA relative addressing
modes.  The SCSI SCRIPTS had been entirely rewritten using LOAD/STORE instead
of MOVE MEMORY instructions.</p>
</div>
<div class="section" id="new-features-of-the-sym53c896-64-bit-pci-dual-lvd-scsi-controller">
<h3>3.2 New features of the SYM53C896 (64 bit PCI dual LVD SCSI controller)<a class="headerlink" href="#new-features-of-the-sym53c896-64-bit-pci-dual-lvd-scsi-controller" title="Permalink to this headline">¶</a></h3>
<p>The 896 and the 895A allows handling of the phase mismatch context from
SCRIPTS (avoids the phase mismatch interrupt that stops the SCSI processor
until the C code has saved the context of the transfer).
Implementing this without using LOAD/STORE instructions would be painful
and I didn’t even want to try it.</p>
<p>The 896 chip supports 64 bit PCI transactions and addressing, while the
895A supports 32 bit PCI transactions and 64 bit addressing.
The SCRIPTS processor of these chips is not true 64 bit, but uses segment
registers for bit 32-63. Another interesting feature is that LOAD/STORE
instructions that address the on-chip RAM (8k) remain internal to the chip.</p>
<p>Due to the use of LOAD/STORE SCRIPTS instructions, this driver does not
support the following chips:</p>
<ul class="simple">
<li>SYM53C810 revision &lt; 0x10 (16)</li>
<li>SYM53C815 all revisions</li>
<li>SYM53C825 revision &lt; 0x10 (16)</li>
</ul>
</div>
</div>
<div class="section" id="memory-mapped-i-o-versus-normal-i-o">
<h2>4. Memory mapped I/O versus normal I/O<a class="headerlink" href="#memory-mapped-i-o-versus-normal-i-o" title="Permalink to this headline">¶</a></h2>
<p>Memory mapped I/O has less latency than normal I/O.  Since
linux-1.3.x, memory mapped I/O is used rather than normal I/O.  Memory
mapped I/O seems to work fine on most hardware configurations, but
some poorly designed motherboards may break this feature.</p>
<p>The configuration option CONFIG_SCSI_NCR53C8XX_IOMAPPED forces the
driver to use normal I/O in all cases.</p>
</div>
<div class="section" id="tagged-command-queueing">
<h2>5. Tagged command queueing<a class="headerlink" href="#tagged-command-queueing" title="Permalink to this headline">¶</a></h2>
<p>Queuing more than 1 command at a time to a device allows it to perform
optimizations based on actual head positions and its mechanical
characteristics. This feature may also reduce average command latency.
In order to really gain advantage of this feature, devices must have
a reasonable cache size (No miracle is to be expected for a low-end
hard disk with 128 KB or less).
Some known SCSI devices do not properly support tagged command queuing.
Generally, firmware revisions that fix this kind of problems are available
at respective vendor web/ftp sites.
All I can say is that the hard disks I use on my machines behave well with
this driver with tagged command queuing enabled:</p>
<ul class="simple">
<li>IBM S12 0662</li>
<li>Conner 1080S</li>
<li>Quantum Atlas I</li>
<li>Quantum Atlas II</li>
</ul>
<p>If your controller has NVRAM, you can configure this feature per target
from the user setup tool. The Tekram Setup program allows to tune the
maximum number of queued commands up to 32. The Symbios Setup only allows
to enable or disable this feature.</p>
<p>The maximum number of simultaneous tagged commands queued to a device
is currently set to 8 by default.  This value is suitable for most SCSI
disks.  With large SCSI disks (&gt;= 2GB, cache &gt;= 512KB, average seek time
&lt;= 10 ms), using a larger value may give better performances.</p>
<p>The sym53c8xx driver supports up to 255 commands per device, and the
generic ncr53c8xx driver supports up to 64, but using more than 32 is
generally not worth-while, unless you are using a very large disk or disk
array. It is noticeable that most of recent hard disks seem not to accept
more than 64 simultaneous commands. So, using more than 64 queued commands
is probably just resource wasting.</p>
<p>If your controller does not have NVRAM or if it is managed by the SDMS
BIOS/SETUP, you can configure tagged queueing feature and device queue
depths from the boot command-line. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ncr53c8xx=tags:4/t2t3q15-t4q7/t1u0q32
</pre></div>
</div>
<p>will set tagged commands queue depths as follow:</p>
<ul class="simple">
<li>target 2  all luns  on controller 0 –&gt; 15</li>
<li>target 3  all luns  on controller 0 –&gt; 15</li>
<li>target 4  all luns  on controller 0 –&gt;  7</li>
<li>target 1  lun 0     on controller 1 –&gt; 32</li>
<li>all other target/lun                –&gt;  4</li>
</ul>
<p>In some special conditions, some SCSI disk firmwares may return a
QUEUE FULL status for a SCSI command. This behaviour is managed by the
driver using the following heuristic:</p>
<ul class="simple">
<li>Each time a QUEUE FULL status is returned, tagged queue depth is reduced
to the actual number of disconnected commands.</li>
<li>Every 1000 successfully completed SCSI commands, if allowed by the
current limit, the maximum number of queueable commands is incremented.</li>
</ul>
<p>Since QUEUE FULL status reception and handling is resource wasting, the
driver notifies by default this problem to user by indicating the actual
number of commands used and their status, as well as its decision on the
device queue depth change.
The heuristic used by the driver in handling QUEUE FULL ensures that the
impact on performances is not too bad. You can get rid of the messages by
setting verbose level to zero, as follow:</p>
<dl class="docutils">
<dt>1st method:</dt>
<dd>boot your system using ‘ncr53c8xx=verb:0’ option.</dd>
<dt>2nd method:</dt>
<dd>apply “setverbose 0” control command to the proc fs entry
corresponding to your controller after boot-up.</dd>
</dl>
</div>
<div class="section" id="parity-checking">
<h2>6. Parity checking<a class="headerlink" href="#parity-checking" title="Permalink to this headline">¶</a></h2>
<p>The driver supports SCSI parity checking and PCI bus master parity
checking.  These features must be enabled in order to ensure safe data
transfers.  However, some flawed devices or mother boards will have
problems with parity. You can disable either PCI parity or SCSI parity
checking by entering appropriate options from the boot command line.
(See 10: Boot setup commands).</p>
</div>
<div class="section" id="profiling-information">
<h2>7. Profiling information<a class="headerlink" href="#profiling-information" title="Permalink to this headline">¶</a></h2>
<p>Profiling information is available through the proc SCSI file system.
Since gathering profiling information may impact performances, this
feature is disabled by default and requires a compilation configuration
option to be set to Y.</p>
<p>The device associated with a host has the following pathname:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/proc/scsi/ncr53c8xx/N     (N=0,1,2 ....)
</pre></div>
</div>
<p>Generally, only 1 board is used on hardware configuration, and that device is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/proc/scsi/ncr53c8xx/0
</pre></div>
</div>
<p>However, if the driver has been made as module, the number of the
hosts is incremented each time the driver is loaded.</p>
<p>In order to display profiling information, just enter:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cat /proc/scsi/ncr53c8xx/0
</pre></div>
</div>
<p>and you will get something like the following text:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>General information:
Chip NCR53C810, device id 0x1, revision id 0x2
IO port address 0x6000, IRQ number 10
Using memory mapped IO at virtual address 0x282c000
Synchronous transfer period 25, max commands per lun 4
Profiling information:
num_trans    = 18014
num_kbytes   = 671314
num_disc     = 25763
num_break    = 1673
num_int      = 1685
num_fly      = 18038
ms_setup     = 4940
ms_data      = 369940
ms_disc      = 183090
ms_post      = 1320
</pre></div>
</div>
<p>General information is easy to understand. The device ID and the
revision ID identify the SCSI chip as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="42%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Chip</th>
<th class="head">Device id</th>
<th class="head">Revision Id</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>810</td>
<td>0x1</td>
<td>&lt;  0x10</td>
</tr>
<tr class="row-odd"><td>810A</td>
<td>0x1</td>
<td>&gt;= 0x10</td>
</tr>
<tr class="row-even"><td>815</td>
<td>0x4</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>825</td>
<td>0x3</td>
<td>&lt;  0x10</td>
</tr>
<tr class="row-even"><td>860</td>
<td>0x6</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>825A</td>
<td>0x3</td>
<td>&gt;= 0x10</td>
</tr>
<tr class="row-even"><td>875</td>
<td>0xf</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>895</td>
<td>0xc</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<p>The profiling information is updated upon completion of SCSI commands.
A data structure is allocated and zeroed when the host adapter is
attached. So, if the driver is a module, the profile counters are
cleared each time the driver is loaded.  The “clearprof” command
allows you to clear these counters at any time.</p>
<p>The following counters are available:</p>
<p>(“num” prefix means “number of”,
“ms” means milli-seconds)</p>
<dl class="docutils">
<dt>num_trans</dt>
<dd>Number of completed commands
Example above: 18014 completed commands</dd>
<dt>num_kbytes</dt>
<dd>Number of kbytes transferred
Example above: 671 MB transferred</dd>
<dt>num_disc</dt>
<dd>Number of SCSI disconnections
Example above: 25763 SCSI disconnections</dd>
<dt>num_break</dt>
<dd>number of script interruptions (phase mismatch)
Example above: 1673 script interruptions</dd>
<dt>num_int</dt>
<dd>Number of interrupts other than “on the fly”
Example above: 1685 interruptions not “on the fly”</dd>
<dt>num_fly</dt>
<dd>Number of interrupts “on the fly”
Example above: 18038 interruptions “on the fly”</dd>
<dt>ms_setup</dt>
<dd>Elapsed time for SCSI commands setups
Example above: 4.94 seconds</dd>
<dt>ms_data</dt>
<dd>Elapsed time for data transfers
Example above: 369.94 seconds spent for data transfer</dd>
<dt>ms_disc</dt>
<dd>Elapsed time for SCSI disconnections
Example above: 183.09 seconds spent disconnected</dd>
<dt>ms_post</dt>
<dd>Elapsed time for command post processing
(time from SCSI status get to command completion call)
Example above: 1.32 seconds spent for post processing</dd>
</dl>
<p>Due to the 1/100 second tick of the system clock, “ms_post” time may
be wrong.</p>
<p>In the example above, we got 18038 interrupts “on the fly” and only
1673 script breaks generally due to disconnections inside a segment
of the scatter list.</p>
</div>
<div class="section" id="control-commands">
<h2>8. Control commands<a class="headerlink" href="#control-commands" title="Permalink to this headline">¶</a></h2>
<p>Control commands can be sent to the driver with write operations to
the proc SCSI file system. The generic command syntax is the
following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>echo &quot;&lt;verb&gt; &lt;parameters&gt;&quot; &gt;/proc/scsi/ncr53c8xx/0
(assumes controller number is 0)
</pre></div>
</div>
<p>Using “all” for “&lt;target&gt;” parameter with the commands below will
apply to all targets of the SCSI chain (except the controller).</p>
<p>Available commands:</p>
<div class="section" id="set-minimum-synchronous-period-factor">
<h3>8.1 Set minimum synchronous period factor<a class="headerlink" href="#set-minimum-synchronous-period-factor" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>setsync &lt;target&gt; &lt;period factor&gt;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">target:</th><td class="field-body">target number</td>
</tr>
<tr class="field-even field"><th class="field-name">period:</th><td class="field-body">minimum synchronous period.
Maximum speed = 1000/(4*period factor) except for special
cases below.</td>
</tr>
</tbody>
</table>
<p>Specify a period of 255, to force asynchronous transfer mode.</p>
<blockquote>
<div><ul class="simple">
<li>10 means 25 nano-seconds synchronous period</li>
<li>11 means 30 nano-seconds synchronous period</li>
<li>12 means 50 nano-seconds synchronous period</li>
</ul>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="set-wide-size">
<h3>8.2 Set wide size<a class="headerlink" href="#set-wide-size" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>setwide &lt;target&gt; &lt;size&gt;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">target:</th><td class="field-body">target number</td>
</tr>
<tr class="field-even field"><th class="field-name">size:</th><td class="field-body">0=8 bits, 1=16bits</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="set-maximum-number-of-concurrent-tagged-commands">
<h3>8.3 Set maximum number of concurrent tagged commands<a class="headerlink" href="#set-maximum-number-of-concurrent-tagged-commands" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>settags &lt;target&gt; &lt;tags&gt;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">target:</th><td class="field-body">target number</td>
</tr>
<tr class="field-even field"><th class="field-name">tags:</th><td class="field-body">number of concurrent tagged commands
must not be greater than SCSI_NCR_MAX_TAGS (default: 8)</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="set-order-type-for-tagged-command">
<h3>8.4 Set order type for tagged command<a class="headerlink" href="#set-order-type-for-tagged-command" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>setorder &lt;order&gt;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">order:</th><td class="field-body"><p class="first">3 possible values:</p>
<dl class="last docutils">
<dt>simple:</dt>
<dd><p class="first last">use SIMPLE TAG for all operations (read and write)</p>
</dd>
<dt>ordered:</dt>
<dd><p class="first last">use ORDERED TAG for all operations</p>
</dd>
<dt>default:</dt>
<dd><p class="first last">use default tag type,
SIMPLE  TAG for read  operations
ORDERED TAG for write operations</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="set-debug-mode">
<h3>8.5 Set debug mode<a class="headerlink" href="#set-debug-mode" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>setdebug &lt;list of debug flags&gt;</p>
<p>Available debug flags:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alloc</td>
<td>print info about memory allocations (ccb, lcb)</td>
</tr>
<tr class="row-even"><td>queue</td>
<td>print info about insertions into the command start queue</td>
</tr>
<tr class="row-odd"><td>result</td>
<td>print sense data on CHECK CONDITION status</td>
</tr>
<tr class="row-even"><td>scatter</td>
<td>print info about the scatter process</td>
</tr>
<tr class="row-odd"><td>scripts</td>
<td>print info about the script binding process</td>
</tr>
<tr class="row-even"><td>tiny</td>
<td>print minimal debugging information</td>
</tr>
<tr class="row-odd"><td>timing</td>
<td>print timing information of the NCR chip</td>
</tr>
<tr class="row-even"><td>nego</td>
<td>print information about SCSI negotiations</td>
</tr>
<tr class="row-odd"><td>phase</td>
<td>print information on script interruptions</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Use “setdebug” with no argument to reset debug flags.</p>
</div></blockquote>
</div>
<div class="section" id="clear-profile-counters">
<h3>8.6 Clear profile counters<a class="headerlink" href="#clear-profile-counters" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>clearprof</p>
<p>The profile counters are automatically cleared when the amount of
data transferred reaches 1000 GB in order to avoid overflow.
The “clearprof” command allows you to clear these counters at any time.</p>
</div></blockquote>
</div>
<div class="section" id="set-flag-no-disc">
<h3>8.7 Set flag (no_disc)<a class="headerlink" href="#set-flag-no-disc" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>setflag &lt;target&gt; &lt;flag&gt;</p>
<p>target:    target number</p>
<p>For the moment, only one flag is available:</p>
<blockquote>
<div>no_disc:   not allow target to disconnect.</div></blockquote>
<p>Do not specify any flag in order to reset the flag. For example:</p>
<dl class="docutils">
<dt>setflag 4</dt>
<dd>will reset no_disc flag for target 4, so will allow it disconnections.</dd>
<dt>setflag all</dt>
<dd>will allow disconnection for all devices on the SCSI bus.</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="set-verbose-level">
<h3>8.8 Set verbose level<a class="headerlink" href="#set-verbose-level" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>setverbose #level</p>
<p>The driver default verbose level is 1. This command allows to change
th driver verbose level after boot-up.</p>
</div></blockquote>
</div>
<div class="section" id="reset-all-logical-units-of-a-target">
<h3>8.9 Reset all logical units of a target<a class="headerlink" href="#reset-all-logical-units-of-a-target" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>resetdev &lt;target&gt;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">target:</th><td class="field-body">target number</td>
</tr>
</tbody>
</table>
<p>The driver will try to send a BUS DEVICE RESET message to the target.
(Only supported by the SYM53C8XX driver and provided for test purpose)</p>
</div></blockquote>
</div>
<div class="section" id="abort-all-tasks-of-all-logical-units-of-a-target">
<h3>8.10 Abort all tasks of all logical units of a target<a class="headerlink" href="#abort-all-tasks-of-all-logical-units-of-a-target" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>cleardev &lt;target&gt;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">target:</th><td class="field-body">target number</td>
</tr>
</tbody>
</table>
<p>The driver will try to send a ABORT message to all the logical units
of the target.</p>
<p>(Only supported by the SYM53C8XX driver and provided for test purpose)</p>
</div></blockquote>
</div>
</div>
<div class="section" id="configuration-parameters">
<h2>9. Configuration parameters<a class="headerlink" href="#configuration-parameters" title="Permalink to this headline">¶</a></h2>
<p>If the firmware of all your devices is perfect enough, all the
features supported by the driver can be enabled at start-up.  However,
if only one has a flaw for some SCSI feature, you can disable the
support by the driver of this feature at linux start-up and enable
this feature after boot-up only for devices that support it safely.</p>
<dl class="docutils">
<dt>CONFIG_SCSI_NCR53C8XX_IOMAPPED       (default answer: n)</dt>
<dd><p class="first">Answer “y” if you suspect your mother board to not allow memory mapped I/O.</p>
<p class="last">May slow down performance a little.  This option is required by
Linux/PPC and is used no matter what you select here.  Linux/PPC
suffers no performance loss with this option since all IO is memory
mapped anyway.</p>
</dd>
<dt>CONFIG_SCSI_NCR53C8XX_DEFAULT_TAGS    (default answer: 8)</dt>
<dd>Default tagged command queue depth.</dd>
<dt>CONFIG_SCSI_NCR53C8XX_MAX_TAGS         (default answer: 8)</dt>
<dd>This option allows you to specify the maximum number of tagged commands
that can be queued to a device. The maximum supported value is 32.</dd>
<dt>CONFIG_SCSI_NCR53C8XX_SYNC            (default answer: 5)</dt>
<dd>This option allows you to specify the frequency in MHz the driver
will use at boot time for synchronous data transfer negotiations.
This frequency can be changed later with the “setsync” control command.
0 means “asynchronous data transfers”.</dd>
<dt>CONFIG_SCSI_NCR53C8XX_FORCE_SYNC_NEGO (default answer: n)</dt>
<dd><p class="first">Force synchronous negotiation for all SCSI-2 devices.</p>
<p class="last">Some SCSI-2 devices do not report this feature in byte 7 of inquiry
response but do support it properly (TAMARACK scanners for example).</p>
</dd>
<dt>CONFIG_SCSI_NCR53C8XX_NO_DISCONNECT   (default and only reasonable answer: n)</dt>
<dd>If you suspect a device of yours does not properly support disconnections,
you can answer “y”. Then, all SCSI devices will never disconnect the bus
even while performing long SCSI operations.</dd>
<dt>CONFIG_SCSI_NCR53C8XX_SYMBIOS_COMPAT</dt>
<dd><p class="first">Genuine SYMBIOS boards use GPIO0 in output for controller LED and GPIO3
bit as a flag indicating singled-ended/differential interface.
If all the boards of your system are genuine SYMBIOS boards or use
BIOS and drivers from SYMBIOS, you would want to enable this option.</p>
<p class="last">This option must NOT be enabled if your system has at least one 53C8XX
based scsi board with a vendor-specific BIOS.
For example, Tekram DC-390/U, DC-390/W and DC-390/F scsi controllers
use a vendor-specific BIOS and are known to not use SYMBIOS compatible
GPIO wiring. So, this option must not be enabled if your system has
such a board installed.</p>
</dd>
<dt>CONFIG_SCSI_NCR53C8XX_NVRAM_DETECT</dt>
<dd>Enable support for reading the serial NVRAM data on Symbios and
some Symbios compatible cards, and Tekram DC390W/U/F cards. Useful for
systems with more than one Symbios compatible controller where at least
one has a serial NVRAM, or for a system with a mixture of Symbios and
Tekram cards. Enables setting the boot order of host adaptors
to something other than the default order or “reverse probe” order.
Also enables Symbios and Tekram cards to be distinguished so
CONFIG_SCSI_NCR53C8XX_SYMBIOS_COMPAT may be set in a system with a
mixture of Symbios and Tekram cards so the Symbios cards can make use of
the full range of Symbios features, differential, led pin, without
causing problems for the Tekram card(s).</dd>
</dl>
</div>
<div class="section" id="boot-setup-commands">
<h2>10. Boot setup commands<a class="headerlink" href="#boot-setup-commands" title="Permalink to this headline">¶</a></h2>
<div class="section" id="syntax">
<h3>10.1 Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h3>
<p>Setup commands can be passed to the driver either at boot time or as a
string variable using ‘insmod’.</p>
<p>A boot setup command for the ncr53c8xx (sym53c8xx) driver begins with the
driver name “ncr53c8xx=”(sym53c8xx). The kernel syntax parser then expects
an optional list of integers separated with comma followed by an optional
list of comma-separated strings. Example of boot setup command under lilo
prompt:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>lilo: linux root=/dev/hda2 ncr53c8xx=tags:4,sync:10,debug:0x200
</pre></div>
</div>
<ul class="simple">
<li>enable tagged commands, up to 4 tagged commands queued.</li>
<li>set synchronous negotiation speed to 10 Mega-transfers / second.</li>
<li>set DEBUG_NEGO flag.</li>
</ul>
<p>Since comma seems not to be allowed when defining a string variable using
‘insmod’, the driver also accepts &lt;space&gt; as option separator.
The following command will install driver module with the same options as
above:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>insmod ncr53c8xx.o ncr53c8xx=&quot;tags:4 sync:10 debug:0x200&quot;
</pre></div>
</div>
<p>For the moment, the integer list of arguments is discarded by the driver.
It will be used in the future in order to allow a per controller setup.</p>
<p>Each string argument must be specified as “keyword:value”. Only lower-case
characters and digits are allowed.</p>
<p>In a system that contains multiple 53C8xx adapters insmod will install the
specified driver on each adapter. To exclude a chip use the ‘excl’ keyword.</p>
<p>The sequence of commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>insmod sym53c8xx sym53c8xx=excl:0x1400
insmod ncr53c8xx
</pre></div>
</div>
<p>installs the sym53c8xx driver on all adapters except the one at IO port
address 0x1400 and then installs the ncr53c8xx driver to the adapter at IO
port address 0x1400.</p>
</div>
<div class="section" id="available-arguments">
<h3>10.2 Available arguments<a class="headerlink" href="#available-arguments" title="Permalink to this headline">¶</a></h3>
<div class="section" id="master-parity-checking">
<h4>10.2.1  Master parity checking<a class="headerlink" href="#master-parity-checking" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>mpar:y</td>
<td>enabled</td>
</tr>
<tr class="row-even"><td>mpar:n</td>
<td>disabled</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="scsi-parity-checking">
<h4>10.2.2  Scsi parity checking<a class="headerlink" href="#scsi-parity-checking" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>spar:y</td>
<td>enabled</td>
</tr>
<tr class="row-even"><td>spar:n</td>
<td>disabled</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="scsi-disconnections">
<h4>10.2.3  Scsi disconnections<a class="headerlink" href="#scsi-disconnections" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>disc:y</td>
<td>enabled</td>
</tr>
<tr class="row-even"><td>disc:n</td>
<td>disabled</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="special-features">
<h4>10.2.4  Special features<a class="headerlink" href="#special-features" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>Only apply to 810A, 825A, 860, 875 and 895 controllers.
Have no effect with other ones.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>specf:y</td>
<td>(or 1) enabled</td>
</tr>
<tr class="row-even"><td>specf:n</td>
<td>(or 0) disabled</td>
</tr>
<tr class="row-odd"><td>specf:3</td>
<td>enabled except Memory Write And Invalidate</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The default driver setup is ‘specf:3’. As a consequence, option ‘specf:y’
must be specified in the boot setup command to enable Memory Write And
Invalidate.</p>
</div></blockquote>
</div>
<div class="section" id="ultra-scsi-support">
<h4>10.2.5  Ultra SCSI support<a class="headerlink" href="#ultra-scsi-support" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>Only apply to 860, 875, 895, 895a, 896, 1010 and 1010_66 controllers.
Have no effect with other ones.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>ultra:n</td>
<td>All ultra speeds enabled</td>
</tr>
<tr class="row-even"><td>ultra:2</td>
<td>Ultra2 enabled</td>
</tr>
<tr class="row-odd"><td>ultra:1</td>
<td>Ultra enabled</td>
</tr>
<tr class="row-even"><td>ultra:0</td>
<td>Ultra speeds disabled</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="default-number-of-tagged-commands">
<h4>10.2.6  Default number of tagged commands<a class="headerlink" href="#default-number-of-tagged-commands" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>tags:0     (or tags:1 )</td>
<td>tagged command queuing disabled</td>
</tr>
<tr class="row-even"><td>tags:#tags (#tags  &gt; 1)</td>
<td>tagged command queuing enabled</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>#tags will be truncated to the max queued commands configuration parameter.
This option also allows to specify a command queue depth for each device
that support tagged command queueing.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ncr53c8xx=tags:10/t2t3q16-t5q24/t1u2q32
</pre></div>
</div>
<p>will set devices queue depth as follow:</p>
<blockquote>
<div><ul class="simple">
<li>controller #0 target #2 and target #3                  -&gt; 16 commands,</li>
<li>controller #0 target #5                                -&gt; 24 commands,</li>
<li>controller #1 target #1 logical unit #2                -&gt; 32 commands,</li>
<li>all other logical units (all targets, all controllers) -&gt; 10 commands.</li>
</ul>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="default-synchronous-period-factor">
<h4>10.2.7  Default synchronous period factor<a class="headerlink" href="#default-synchronous-period-factor" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>sync:255</td>
<td>disabled (asynchronous transfer mode)</td>
</tr>
<tr class="row-even"><td>sync:#factor</td>
<td><table border="1" class="first last docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>#factor = 10</td>
<td>Ultra-2 SCSI 40 Mega-transfers / second</td>
</tr>
<tr class="row-even"><td>#factor = 11</td>
<td>Ultra-2 SCSI 33 Mega-transfers / second</td>
</tr>
<tr class="row-odd"><td>#factor &lt; 25</td>
<td>Ultra   SCSI 20 Mega-transfers / second</td>
</tr>
<tr class="row-even"><td>#factor &lt; 50</td>
<td>Fast    SCSI-2</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<blockquote>
<div>In all cases, the driver will use the minimum transfer period supported by
controllers according to NCR53C8XX chip type.</div></blockquote>
</div>
<div class="section" id="negotiate-synchronous-with-all-devices">
<h4>10.2.8  Negotiate synchronous with all devices<a class="headerlink" href="#negotiate-synchronous-with-all-devices" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>(force sync nego)</p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>fsn:y</td>
<td>enabled</td>
</tr>
<tr class="row-even"><td>fsn:n</td>
<td>disabled</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="verbosity-level">
<h4>10.2.9  Verbosity level<a class="headerlink" href="#verbosity-level" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>verb:0</td>
<td>minimal</td>
</tr>
<tr class="row-even"><td>verb:1</td>
<td>normal</td>
</tr>
<tr class="row-odd"><td>verb:2</td>
<td>too much</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="debug-mode">
<h4>10.2.10 Debug mode<a class="headerlink" href="#debug-mode" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>debug:0</td>
<td>clear debug flags</td>
</tr>
<tr class="row-even"><td>debug:#x</td>
<td><p class="first">set debug flags</p>
<blockquote class="last">
<div><p>#x is an integer value combining the following power-of-2 values:</p>
<table border="1" class="docutils">
<colgroup>
<col width="68%" />
<col width="32%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>DEBUG_ALLOC</td>
<td>0x1</td>
</tr>
<tr class="row-even"><td>DEBUG_PHASE</td>
<td>0x2</td>
</tr>
<tr class="row-odd"><td>DEBUG_POLL</td>
<td>0x4</td>
</tr>
<tr class="row-even"><td>DEBUG_QUEUE</td>
<td>0x8</td>
</tr>
<tr class="row-odd"><td>DEBUG_RESULT</td>
<td>0x10</td>
</tr>
<tr class="row-even"><td>DEBUG_SCATTER</td>
<td>0x20</td>
</tr>
<tr class="row-odd"><td>DEBUG_SCRIPT</td>
<td>0x40</td>
</tr>
<tr class="row-even"><td>DEBUG_TINY</td>
<td>0x80</td>
</tr>
<tr class="row-odd"><td>DEBUG_TIMING</td>
<td>0x100</td>
</tr>
<tr class="row-even"><td>DEBUG_NEGO</td>
<td>0x200</td>
</tr>
<tr class="row-odd"><td>DEBUG_TAGS</td>
<td>0x400</td>
</tr>
<tr class="row-even"><td>DEBUG_FREEZE</td>
<td>0x800</td>
</tr>
<tr class="row-odd"><td>DEBUG_RESTART</td>
<td>0x1000</td>
</tr>
</tbody>
</table>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<blockquote>
<div>You can play safely with DEBUG_NEGO. However, some of these flags may
generate bunches of syslog messages.</div></blockquote>
</div>
<div class="section" id="burst-max">
<h4>10.2.11 Burst max<a class="headerlink" href="#burst-max" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>burst:0</td>
<td>burst disabled</td>
</tr>
<tr class="row-even"><td>burst:255</td>
<td>get burst length from initial IO register settings.</td>
</tr>
<tr class="row-odd"><td>burst:#x</td>
<td><p class="first">burst enabled (1&lt;&lt;#x burst transfers max)</p>
<p>#x is an integer value which is log base 2 of the burst transfers
max.</p>
<p>The NCR53C875 and NCR53C825A support up to 128 burst transfers
(#x = 7).</p>
<p>Other chips only support up to 16 (#x = 4).</p>
<p class="last">This is a maximum value. The driver set the burst length according
to chip and revision ids. By default the driver uses the maximum
value supported by the chip.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="led-support">
<h4>10.2.12 LED support<a class="headerlink" href="#led-support" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>led:1</td>
<td>enable  LED support</td>
</tr>
<tr class="row-even"><td>led:0</td>
<td>disable LED support</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Donnot enable LED support if your scsi board does not use SDMS BIOS.
(See ‘Configuration parameters’)</p>
</div></blockquote>
</div>
<div class="section" id="max-wide">
<h4>10.2.13 Max wide<a class="headerlink" href="#max-wide" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>wide:1</td>
<td>wide scsi enabled</td>
</tr>
<tr class="row-even"><td>wide:0</td>
<td>wide scsi disabled</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Some scsi boards use a 875 (ultra wide) and only supply narrow connectors.
If you have connected a wide device with a 50 pins to 68 pins cable
converter, any accepted wide negotiation will break further data transfers.
In such a case, using “wide:0” in the bootup command will be helpful.</p>
</div></blockquote>
</div>
<div class="section" id="differential-mode">
<h4>10.2.14 Differential mode<a class="headerlink" href="#differential-mode" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>diff:0</td>
<td>never set up diff mode</td>
</tr>
<tr class="row-even"><td>diff:1</td>
<td>set up diff mode if BIOS set it</td>
</tr>
<tr class="row-odd"><td>diff:2</td>
<td>always set up diff mode</td>
</tr>
<tr class="row-even"><td>diff:3</td>
<td>set diff mode if GPIO3 is not set</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="irq-mode">
<h4>10.2.15 IRQ mode<a class="headerlink" href="#irq-mode" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>irqm:0</td>
<td>always open drain</td>
</tr>
<tr class="row-even"><td>irqm:1</td>
<td>same as initial settings (assumed BIOS settings)</td>
</tr>
<tr class="row-odd"><td>irqm:2</td>
<td>always totem pole</td>
</tr>
<tr class="row-even"><td>irqm:0x10</td>
<td>driver will not use IRQF_SHARED flag when requesting irq</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(Bits 0x10 and 0x20 can be combined with hardware irq mode option)</p>
</div></blockquote>
</div>
<div class="section" id="reverse-probe">
<h4>10.2.16 Reverse probe<a class="headerlink" href="#reverse-probe" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>revprob:n</td>
<td>probe chip ids from the PCI configuration in this order:
810, 815, 820, 860, 875, 885, 895, 896</td>
</tr>
<tr class="row-even"><td>revprob:y</td>
<td>probe chip ids in the reverse order.</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="fix-up-pci-configuration-space">
<h4>10.2.17 Fix up PCI configuration space<a class="headerlink" href="#fix-up-pci-configuration-space" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><blockquote>
<div>pcifix:&lt;option bits&gt;</div></blockquote>
<p>Available option bits:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="95%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x0</td>
<td>No attempt to fix PCI configuration space registers values.</td>
</tr>
<tr class="row-even"><td>0x1</td>
<td>Set PCI cache-line size register if not set.</td>
</tr>
<tr class="row-odd"><td>0x2</td>
<td>Set write and invalidate bit in PCI command register.</td>
</tr>
<tr class="row-even"><td>0x4</td>
<td>Increase if necessary PCI latency timer according to burst max.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Use ‘pcifix:7’ in order to allow the driver to fix up all PCI features.</p>
</div></blockquote>
</div>
<div class="section" id="serial-nvram">
<h4>10.2.18 Serial NVRAM<a class="headerlink" href="#serial-nvram" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>nvram:n</td>
<td>do not look for serial NVRAM</td>
</tr>
<tr class="row-even"><td>nvram:y</td>
<td>test controllers for onboard serial NVRAM</td>
</tr>
</tbody>
</table>
<p>(alternate binary form)
mvram=&lt;bits options&gt;</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x01</td>
<td>look for NVRAM  (equivalent to nvram=y)</td>
</tr>
<tr class="row-even"><td>0x02</td>
<td>ignore NVRAM “Synchronous negotiation” parameters for all devices</td>
</tr>
<tr class="row-odd"><td>0x04</td>
<td>ignore NVRAM “Wide negotiation”  parameter for all devices</td>
</tr>
<tr class="row-even"><td>0x08</td>
<td>ignore NVRAM “Scan at boot time” parameter for all devices</td>
</tr>
<tr class="row-odd"><td>0x80</td>
<td>also attach controllers set to OFF in the NVRAM (sym53c8xx only)</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="check-scsi-bus">
<h4>10.2.19 Check SCSI BUS<a class="headerlink" href="#check-scsi-bus" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><blockquote>
<div>buschk:&lt;option bits&gt;</div></blockquote>
<p>Available option bits:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x0:</td>
<td>No check.</td>
</tr>
<tr class="row-even"><td>0x1:</td>
<td>Check and do not attach the controller on error.</td>
</tr>
<tr class="row-odd"><td>0x2:</td>
<td>Check and just warn on error.</td>
</tr>
<tr class="row-even"><td>0x4:</td>
<td>Disable SCSI bus integrity checking.</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="exclude-a-host-from-being-attached">
<h4>10.2.20 Exclude a host from being attached<a class="headerlink" href="#exclude-a-host-from-being-attached" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><blockquote>
<div>excl=&lt;io_address&gt;</div></blockquote>
<p>Prevent host at a given io address from being attached.
For example ‘ncr53c8xx=excl:0xb400,excl:0xc000’ indicate to the
ncr53c8xx driver not to attach hosts at address 0xb400 and 0xc000.</p>
</div></blockquote>
</div>
<div class="section" id="suggest-a-default-scsi-id-for-hosts">
<h4>10.2.21 Suggest a default SCSI id for hosts<a class="headerlink" href="#suggest-a-default-scsi-id-for-hosts" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>hostid:255</td>
<td>no id suggested.</td>
</tr>
<tr class="row-even"><td>hostid:#x</td>
<td>(0 &lt; x &lt; 7) x suggested for hosts SCSI id.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>If a host SCSI id is available from the NVRAM, the driver will ignore
any value suggested as boot option. Otherwise, if a suggested value
different from 255 has been supplied, it will use it. Otherwise, it will
try to deduce the value previously set in the hardware and use value
7 if the hardware value is zero.</p>
</div></blockquote>
</div>
<div class="section" id="enable-use-of-immediate-arbitration">
<h4>10.2.22 Enable use of IMMEDIATE ARBITRATION<a class="headerlink" href="#enable-use-of-immediate-arbitration" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>(only supported by the sym53c8xx driver. See 10.7 for more details)</div></blockquote>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>iarb:0</td>
<td>do not use this feature.</td>
</tr>
<tr class="row-even"><td>iarb:#x</td>
<td><p class="first">use this feature according to bit fields as follow:</p>
<table border="1" class="last docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>bit 0 (1)</td>
<td>enable IARB each time the initiator has been reselected
when it arbitrated for the SCSI BUS.</td>
</tr>
<tr class="row-even"><td>(#x &gt;&gt; 4)</td>
<td>maximum number of successive settings of IARB if the
initiator win arbitration and it has other commands
to send to a device.</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Boot fail safe</dt>
<dd><blockquote class="first">
<div>safe:y      load the following assumed fail safe initial setup</div></blockquote>
<table border="1" class="last docutils">
<colgroup>
<col width="43%" />
<col width="39%" />
<col width="18%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>master parity</td>
<td>disabled</td>
<td>mpar:n</td>
</tr>
<tr class="row-even"><td>scsi parity</td>
<td>enabled</td>
<td>spar:y</td>
</tr>
<tr class="row-odd"><td>disconnections</td>
<td>not allowed</td>
<td>disc:n</td>
</tr>
<tr class="row-even"><td>special features</td>
<td>disabled</td>
<td>specf:n</td>
</tr>
<tr class="row-odd"><td>ultra scsi</td>
<td>disabled</td>
<td>ultra:n</td>
</tr>
<tr class="row-even"><td>force sync negotiation</td>
<td>disabled</td>
<td>fsn:n</td>
</tr>
<tr class="row-odd"><td>reverse probe</td>
<td>disabled</td>
<td>revprob:n</td>
</tr>
<tr class="row-even"><td>PCI fix up</td>
<td>disabled</td>
<td>pcifix:0</td>
</tr>
<tr class="row-odd"><td>serial NVRAM</td>
<td>enabled</td>
<td>nvram:y</td>
</tr>
<tr class="row-even"><td>verbosity level</td>
<td>2</td>
<td>verb:2</td>
</tr>
<tr class="row-odd"><td>tagged command queuing</td>
<td>disabled</td>
<td>tags:0</td>
</tr>
<tr class="row-even"><td>synchronous negotiation</td>
<td>disabled</td>
<td>sync:255</td>
</tr>
<tr class="row-odd"><td>debug flags</td>
<td>none</td>
<td>debug:0</td>
</tr>
<tr class="row-even"><td>burst length</td>
<td>from BIOS settings</td>
<td>burst:255</td>
</tr>
<tr class="row-odd"><td>LED support</td>
<td>disabled</td>
<td>led:0</td>
</tr>
<tr class="row-even"><td>wide support</td>
<td>disabled</td>
<td>wide:0</td>
</tr>
<tr class="row-odd"><td>settle time</td>
<td>10 seconds</td>
<td>settle:10</td>
</tr>
<tr class="row-even"><td>differential support</td>
<td>from BIOS settings</td>
<td>diff:1</td>
</tr>
<tr class="row-odd"><td>irq mode</td>
<td>from BIOS settings</td>
<td>irqm:1</td>
</tr>
<tr class="row-even"><td>SCSI BUS check</td>
<td>do not attach on error</td>
<td>buschk:1</td>
</tr>
<tr class="row-odd"><td>immediate arbitration</td>
<td>disabled</td>
<td>iarb:0</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
<div class="section" id="advised-boot-setup-commands">
<h4>10.3 Advised boot setup commands<a class="headerlink" href="#advised-boot-setup-commands" title="Permalink to this headline">¶</a></h4>
<p>If the driver has been configured with default options, the equivalent
boot setup is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ncr53c8xx=mpar:y,spar:y,disc:y,specf:3,fsn:n,ultra:2,fsn:n,revprob:n,verb:1\
          tags:0,sync:50,debug:0,burst:7,led:0,wide:1,settle:2,diff:0,irqm:0
</pre></div>
</div>
<p>For an installation diskette or a safe but not fast system,
boot setup can be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ncr53c8xx=safe:y,mpar:y,disc:y
ncr53c8xx=safe:y,disc:y
ncr53c8xx=safe:y,mpar:y
ncr53c8xx=safe:y
</pre></div>
</div>
<p>My personal system works flawlessly with the following equivalent setup:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ncr53c8xx=mpar:y,spar:y,disc:y,specf:1,fsn:n,ultra:2,fsn:n,revprob:n,verb:1\
          tags:32,sync:12,debug:0,burst:7,led:1,wide:1,settle:2,diff:0,irqm:0
</pre></div>
</div>
<p>The driver prints its actual setup when verbosity level is 2. You can try
“ncr53c8xx=verb:2” to get the “static” setup of the driver, or add “verb:2”
to your boot setup command in order to check the actual setup the driver is
using.</p>
</div>
</div>
<div class="section" id="pci-configuration-fix-up-boot-option">
<h3>10.4 PCI configuration fix-up boot option<a class="headerlink" href="#pci-configuration-fix-up-boot-option" title="Permalink to this headline">¶</a></h3>
<p>pcifix:&lt;option bits&gt;</p>
<p>Available option bits:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="95%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x1</td>
<td>Set PCI cache-line size register if not set.</td>
</tr>
<tr class="row-even"><td>0x2</td>
<td>Set write and invalidate bit in PCI command register.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Use ‘pcifix:3’ in order to allow the driver to fix both PCI features.</p>
<p>These options only apply to new SYMBIOS chips 810A, 825A, 860, 875
and 895 and are only supported for Pentium and 486 class processors.
Recent SYMBIOS 53C8XX scsi processors are able to use PCI read multiple
and PCI write and invalidate commands. These features require the
cache line size register to be properly set in the PCI configuration
space of the chips. On the other hand, chips will use PCI write and
invalidate commands only if the corresponding bit is set to 1 in the
PCI command register.</p>
<p>Not all PCI bioses set the PCI cache line register and the PCI write and
invalidate bit in the PCI configuration space of 53C8XX chips.
Optimized PCI accesses may be broken for some PCI/memory controllers or
make problems with some PCI boards.</p>
<p>This fix-up worked flawlessly on my previous system.
(MB Triton HX / 53C875 / 53C810A)
I use these options at my own risks as you will do if you decide to
use them too.</p>
</div>
<div class="section" id="serial-nvram-support-boot-option">
<h3>10.5 Serial NVRAM support boot option<a class="headerlink" href="#serial-nvram-support-boot-option" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>nvram:n</td>
<td>do not look for serial NVRAM</td>
</tr>
<tr class="row-even"><td>nvram:y</td>
<td>test controllers for onboard serial NVRAM</td>
</tr>
</tbody>
</table>
<p>This option can also been entered as an hexadecimal value that allows
to control what information the driver will get from the NVRAM and what
information it will ignore.
For details see ‘17. Serial NVRAM support’.</p>
<p>When this option is enabled, the driver tries to detect all boards using
a Serial NVRAM. This memory is used to hold user set up parameters.</p>
<p>The parameters the driver is able to get from the NVRAM depend on the
data format used, as follow:</p>
<table border="1" class="docutils">
<colgroup>
<col width="49%" />
<col width="29%" />
<col width="22%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>&#160;</td>
<td>Tekram format</td>
<td>Symbios format</td>
</tr>
<tr class="row-even"><td>General and host parameters</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><ul class="first last simple">
<li>Boot order</li>
</ul>
</td>
<td>N</td>
<td>Y</td>
</tr>
<tr class="row-even"><td><ul class="first last simple">
<li>Host SCSI ID</li>
</ul>
</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-odd"><td><ul class="first last simple">
<li>SCSI parity checking</li>
</ul>
</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-even"><td><ul class="first last simple">
<li>Verbose boot messages</li>
</ul>
</td>
<td>N</td>
<td>Y</td>
</tr>
<tr class="row-odd"><td colspan="3">SCSI devices parameters</td>
</tr>
<tr class="row-even"><td><ul class="first last simple">
<li>Synchronous transfer speed</li>
</ul>
</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-odd"><td><ul class="first last simple">
<li>Wide 16 / Narrow</li>
</ul>
</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-even"><td><ul class="first last simple">
<li>Tagged Command Queuing
enabled</li>
</ul>
</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-odd"><td><ul class="first last simple">
<li>Disconnections enabled</li>
</ul>
</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr class="row-even"><td><ul class="first last simple">
<li>Scan at boot time</li>
</ul>
</td>
<td>N</td>
<td>Y</td>
</tr>
</tbody>
</table>
<p>In order to speed up the system boot, for each device configured without
the “scan at boot time” option, the driver forces an error on the
first TEST UNIT READY command received for this device.</p>
<p>Some SDMS BIOS revisions seem to be unable to boot cleanly with very fast
hard disks. In such a situation you cannot configure the NVRAM with
optimized parameters value.</p>
<p>The ‘nvram’ boot option can be entered in hexadecimal form in order
to ignore some options configured in the NVRAM, as follow:</p>
<p>mvram=&lt;bits options&gt;</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x01</td>
<td>look for NVRAM  (equivalent to nvram=y)</td>
</tr>
<tr class="row-even"><td>0x02</td>
<td>ignore NVRAM “Synchronous negotiation” parameters for all devices</td>
</tr>
<tr class="row-odd"><td>0x04</td>
<td>ignore NVRAM “Wide negotiation”  parameter for all devices</td>
</tr>
<tr class="row-even"><td>0x08</td>
<td>ignore NVRAM “Scan at boot time” parameter for all devices</td>
</tr>
<tr class="row-odd"><td>0x80</td>
<td>also attach controllers set to OFF in the NVRAM (sym53c8xx only)</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Option 0x80 is only supported by the sym53c8xx driver and is disabled by
default. Result is that, by default (option not set), the sym53c8xx driver
will not attach controllers set to OFF in the NVRAM.</p>
<p>The ncr53c8xx always tries to attach all the controllers. Option 0x80 has
not been added to the ncr53c8xx driver, since it has been reported to
confuse users who use this driver since a long time. If you desire a
controller not to be attached by the ncr53c8xx driver at Linux boot, you
must use the ‘excl’ driver boot option.</p>
<div class="section" id="scsi-bus-checking-boot-option">
<h4>10.6 SCSI BUS checking boot option.<a class="headerlink" href="#scsi-bus-checking-boot-option" title="Permalink to this headline">¶</a></h4>
<p>When this option is set to a non-zero value, the driver checks SCSI lines
logic state, 100 micro-seconds after having asserted the SCSI RESET line.
The driver just reads SCSI lines and checks all lines read FALSE except RESET.
Since SCSI devices shall release the BUS at most 800 nano-seconds after SCSI
RESET has been asserted, any signal to TRUE may indicate a SCSI BUS problem.
Unfortunately, the following common SCSI BUS problems are not detected:</p>
<ul class="simple">
<li>Only 1 terminator installed.</li>
<li>Misplaced terminators.</li>
<li>Bad quality terminators.</li>
</ul>
<p>On the other hand, either bad cabling, broken devices, not conformant
devices, … may cause a SCSI signal to be wrong when te driver reads it.</p>
</div>
<div class="section" id="immediate-arbitration-boot-option">
<h4>10.7 IMMEDIATE ARBITRATION boot option<a class="headerlink" href="#immediate-arbitration-boot-option" title="Permalink to this headline">¶</a></h4>
<p>This option is only supported by the SYM53C8XX driver (not by the NCR53C8XX).</p>
<p>SYMBIOS 53C8XX chips are able to arbitrate for the SCSI BUS as soon as they
have detected an expected disconnection (BUS FREE PHASE). For this process
to be started, bit 1 of SCNTL1 IO register must be set when the chip is
connected to the SCSI BUS.</p>
<p>When this feature has been enabled for the current connection, the chip has
every chance to win arbitration if only devices with lower priority are
competing for the SCSI BUS. By the way, when the chip is using SCSI id 7,
then it will for sure win the next SCSI BUS arbitration.</p>
<p>Since, there is no way to know what devices are trying to arbitrate for the
BUS, using this feature can be extremely unfair. So, you are not advised
to enable it, or at most enable this feature for the case the chip lost
the previous arbitration (boot option ‘iarb:1’).</p>
<p>This feature has the following advantages:</p>
<ol class="loweralpha simple">
<li>Allow the initiator with ID 7 to win arbitration when it wants so.</li>
<li>Overlap at least 4 micro-seconds of arbitration time with the execution
of SCRIPTS that deal with the end of the current connection and that
starts the next job.</li>
</ol>
<p>Hmmm… But (a) may just prevent other devices from reselecting the initiator,
and delay data transfers or status/completions, and (b) may just waste
SCSI BUS bandwidth if the SCRIPTS execution lasts more than 4 micro-seconds.</p>
<p>The use of IARB needs the SCSI_NCR_IARB_SUPPORT option to have been defined
at compile time and the ‘iarb’ boot option to have been set to a non zero
value at boot time. It is not that useful for real work, but can be used
to stress SCSI devices or for some applications that can gain advantage of
it. By the way, if you experience badnesses like ‘unexpected disconnections’,
‘bad reselections’, etc… when using IARB on heavy IO load, you should not
be surprised, because force-feeding anything and blocking its arse at the
same time cannot work for a long time. :-))</p>
</div>
</div>
</div>
<div class="section" id="some-constants-and-flags-of-the-ncr53c8xx-h-header-file">
<h2>11. Some constants and flags of the ncr53c8xx.h header file<a class="headerlink" href="#some-constants-and-flags-of-the-ncr53c8xx-h-header-file" title="Permalink to this headline">¶</a></h2>
<p>Some of these are defined from the configuration parameters.  To
change other “defines”, you must edit the header file.  Do that only
if you know what you are doing.</p>
<dl class="docutils">
<dt>SCSI_NCR_SETUP_SPECIAL_FEATURES (default: defined)</dt>
<dd><p class="first">If defined, the driver will enable some special features according
to chip and revision id.</p>
<p>For 810A, 860, 825A, 875 and 895 scsi chips, this option enables
support of features that reduce load of PCI bus and memory accesses
during  scsi transfer processing: burst op-code fetch, read multiple,
read line, prefetch, cache line, write and invalidate,
burst 128 (875 only), large dma fifo (875 only), offset 16 (875 only).
Can be changed by the following boot setup command:</p>
<div class="last highlight-none notranslate"><div class="highlight"><pre><span></span>ncr53c8xx=specf:n
</pre></div>
</div>
</dd>
<dt>SCSI_NCR_IOMAPPED               (default: not defined)</dt>
<dd>If defined, normal I/O is forced.</dd>
<dt>SCSI_NCR_SHARE_IRQ              (default: defined)</dt>
<dd>If defined, request shared IRQ.</dd>
<dt>SCSI_NCR_MAX_TAGS               (default: 8)</dt>
<dd><p class="first">Maximum number of simultaneous tagged commands to a device.</p>
<p class="last">Can be changed by “settags &lt;target&gt; &lt;maxtags&gt;”</p>
</dd>
<dt>SCSI_NCR_SETUP_DEFAULT_SYNC     (default: 50)</dt>
<dd><p class="first">Transfer period factor the driver will use at boot time for synchronous
negotiation. 0 means asynchronous.</p>
<p class="last">Can be changed by “setsync &lt;target&gt; &lt;period factor&gt;”</p>
</dd>
<dt>SCSI_NCR_SETUP_DEFAULT_TAGS     (default: 8)</dt>
<dd><p class="first">Default number of simultaneous tagged commands to a device.</p>
<p class="last">&lt; 1 means tagged command queuing disabled at start-up.</p>
</dd>
<dt>SCSI_NCR_ALWAYS_SIMPLE_TAG      (default: defined)</dt>
<dd><p class="first">Use SIMPLE TAG for read and write commands.</p>
<p class="last">Can be changed by “setorder &lt;ordered|simple|default&gt;”</p>
</dd>
<dt>SCSI_NCR_SETUP_DISCONNECTION    (default: defined)</dt>
<dd>If defined, targets are allowed to disconnect.</dd>
<dt>SCSI_NCR_SETUP_FORCE_SYNC_NEGO  (default: not defined)</dt>
<dd><p class="first">If defined, synchronous negotiation is tried for all SCSI-2 devices.</p>
<p class="last">Can be changed by “setsync &lt;target&gt; &lt;period&gt;”</p>
</dd>
<dt>SCSI_NCR_SETUP_MASTER_PARITY    (default: defined)</dt>
<dd>If defined, master parity checking is enabled.</dd>
<dt>SCSI_NCR_SETUP_SCSI_PARITY      (default: defined)</dt>
<dd>If defined, SCSI parity checking is enabled.</dd>
<dt>SCSI_NCR_PROFILE_SUPPORT        (default: not defined)</dt>
<dd>If defined, profiling information is gathered.</dd>
<dt>SCSI_NCR_MAX_SCATTER            (default: 128)</dt>
<dd>Scatter list size of the driver ccb.</dd>
<dt>SCSI_NCR_MAX_TARGET             (default: 16)</dt>
<dd>Max number of targets per host.</dd>
<dt>SCSI_NCR_MAX_HOST               (default: 2)</dt>
<dd>Max number of host controllers.</dd>
<dt>SCSI_NCR_SETTLE_TIME            (default: 2)</dt>
<dd>Number of seconds the driver will wait after reset.</dd>
<dt>SCSI_NCR_TIMEOUT_ALERT          (default: 3)</dt>
<dd><p class="first">If a pending command will time out after this amount of seconds,
an ordered tag is used for the next command.</p>
<p class="last">Avoids timeouts for unordered tagged commands.</p>
</dd>
<dt>SCSI_NCR_CAN_QUEUE              (default: 7*SCSI_NCR_MAX_TAGS)</dt>
<dd>Max number of commands that can be queued to a host.</dd>
<dt>SCSI_NCR_CMD_PER_LUN            (default: SCSI_NCR_MAX_TAGS)</dt>
<dd>Max number of commands queued to a host for a device.</dd>
<dt>SCSI_NCR_SG_TABLESIZE           (default: SCSI_NCR_MAX_SCATTER-1)</dt>
<dd>Max size of the Linux scatter/gather list.</dd>
<dt>SCSI_NCR_MAX_LUN        (default: 8)</dt>
<dd>Max number of LUNs per target.</dd>
</dl>
</div>
<div class="section" id="installation">
<h2>12. Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>This driver is part of the linux kernel distribution.
Driver files are located in the sub-directory “drivers/scsi” of the
kernel source tree.</p>
<p>Driver files:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>README.ncr53c8xx        : this file
ChangeLog.ncr53c8xx     : change log
ncr53c8xx.h             : definitions
ncr53c8xx.c             : the driver code
</pre></div>
</div>
<p>New driver versions are made available separately in order to allow testing
changes and new features prior to including them into the linux kernel
distribution. The following URL provides information on latest available
patches:</p>
<blockquote>
<div><a class="reference external" href="ftp://ftp.tux.org/pub/people/gerard-roudier/README">ftp://ftp.tux.org/pub/people/gerard-roudier/README</a></div></blockquote>
</div>
<div class="section" id="architecture-dependent-features">
<h2>13. Architecture dependent features<a class="headerlink" href="#architecture-dependent-features" title="Permalink to this headline">¶</a></h2>
<p>&lt;Not yet written&gt;</p>
</div>
<div class="section" id="known-problems">
<h2>14. Known problems<a class="headerlink" href="#known-problems" title="Permalink to this headline">¶</a></h2>
<div class="section" id="tagged-commands-with-iomega-jaz-device">
<h3>14.1 Tagged commands with Iomega Jaz device<a class="headerlink" href="#tagged-commands-with-iomega-jaz-device" title="Permalink to this headline">¶</a></h3>
<p>I have not tried this device, however it has been reported to me the
following: This device is capable of Tagged command queuing. However
while spinning up, it rejects Tagged commands. This behaviour is
conforms to 6.8.2 of SCSI-2 specifications. The current behaviour of
the driver in that situation is not satisfying. So do not enable
Tagged command queuing for devices that are able to spin down.  The
other problem that may appear is timeouts. The only way to avoid
timeouts seems to edit linux/drivers/scsi/sd.c and to increase the
current timeout values.</p>
</div>
<div class="section" id="device-names-change-when-another-controller-is-added">
<h3>14.2 Device names change when another controller is added<a class="headerlink" href="#device-names-change-when-another-controller-is-added" title="Permalink to this headline">¶</a></h3>
<p>When you add a new NCR53C8XX chip based controller to a system that already
has one or more controllers of this family, it may happen that the order
the driver registers them to the kernel causes problems due to device
name changes.
When at least one controller uses NvRAM, SDMS BIOS version 4 allows you to
define the order the BIOS will scan the scsi boards. The driver attaches
controllers according to BIOS information if NvRAM detect option is set.</p>
<p>If your controllers do not have NvRAM, you can:</p>
<ul class="simple">
<li>Ask the driver to probe chip ids in reverse order from the boot command
line: ncr53c8xx=revprob:y</li>
<li>Make appropriate changes in the fstab.</li>
<li>Use the ‘scsidev’ tool from Eric Youngdale.</li>
</ul>
</div>
<div class="section" id="using-only-8-bit-devices-with-a-wide-scsi-controller">
<h3>14.3 Using only 8 bit devices with a WIDE SCSI controller<a class="headerlink" href="#using-only-8-bit-devices-with-a-wide-scsi-controller" title="Permalink to this headline">¶</a></h3>
<p>When only 8 bit NARROW devices are connected to a 16 bit WIDE SCSI controller,
you must ensure that lines of the wide part of the SCSI BUS are pulled-up.
This can be achieved by ENABLING the WIDE TERMINATOR portion of the SCSI
controller card.</p>
<p>The TYAN 1365 documentation revision 1.2 is not correct about such settings.
(page 10, figure 3.3).</p>
</div>
<div class="section" id="possible-data-corruption-during-a-memory-write-and-invalidate">
<h3>14.4 Possible data corruption during a Memory Write and Invalidate<a class="headerlink" href="#possible-data-corruption-during-a-memory-write-and-invalidate" title="Permalink to this headline">¶</a></h3>
<p>This problem is described in SYMBIOS DEL 397, Part Number 69-039241, ITEM 4.</p>
<p>In some complex situations, 53C875 chips revision &lt;= 3 may start a PCI
Write and Invalidate Command at a not cache-line-aligned 4 DWORDS boundary.
This is only possible when Cache Line Size is 8 DWORDS or greater.
Pentium systems use a 8 DWORDS cache line size and so are concerned by
this chip bug, unlike i486 systems that use a 4 DWORDS cache line size.</p>
<p>When this situation occurs, the chip may complete the Write and Invalidate
command after having only filled part of the last cache line involved in
the transfer, leaving to data corruption the remainder of this cache line.</p>
<p>Not using Write And Invalidate obviously gets rid of this chip bug, and so
it is now the default setting of the driver.
However, for people like me who want to enable this feature, I have added
part of a work-around suggested by SYMBIOS. This work-around resets the
addressing logic when the DATA IN phase is entered and so prevents the bug
from being triggered for the first SCSI MOVE of the phase. This work-around
should be enough according to the following:</p>
<p>The only driver internal data structure that is greater than 8 DWORDS  and
that is moved by the SCRIPTS processor is the ‘CCB header’ that contains
the context of the SCSI transfer. This data structure is aligned on 8 DWORDS
boundary (Pentium Cache Line Size), and so is immune to this chip bug, at
least on Pentium systems.</p>
<p>But the conditions of this bug can be met when a SCSI read command is
performed using a buffer that is 4 DWORDS but not cache-line aligned.
This cannot happen under Linux when scatter/gather lists are used since
they only refer to system buffers that are well aligned. So, a work around
may only be needed under Linux when a scatter/gather list is not used and
when the SCSI DATA IN phase is reentered after a phase mismatch.</p>
</div>
</div>
<div class="section" id="scsi-problem-troubleshooting">
<h2>15. SCSI problem troubleshooting<a class="headerlink" href="#scsi-problem-troubleshooting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="problem-tracking">
<h3>15.1 Problem tracking<a class="headerlink" href="#problem-tracking" title="Permalink to this headline">¶</a></h3>
<p>Most SCSI problems are due to a non conformant SCSI bus or to buggy
devices.  If unfortunately you have SCSI problems, you can check the
following things:</p>
<ul class="simple">
<li>SCSI bus cables</li>
<li>terminations at both end of the SCSI chain</li>
<li>linux syslog messages (some of them may help you)</li>
</ul>
<p>If you do not find the source of problems, you can configure the
driver with no features enabled.</p>
<ul class="simple">
<li>only asynchronous data transfers</li>
<li>tagged commands disabled</li>
<li>disconnections not allowed</li>
</ul>
<p>Now, if your SCSI bus is ok, your system have every chance to work
with this safe configuration but performances will not be optimal.</p>
<p>If it still fails, then you can send your problem description to
appropriate mailing lists or news-groups.  Send me a copy in order to
be sure I will receive it.  Obviously, a bug in the driver code is
possible.</p>
<blockquote>
<div>My email address: Gerard Roudier &lt;<a class="reference external" href="mailto:groudier&#37;&#52;&#48;free&#46;fr">groudier<span>&#64;</span>free<span>&#46;</span>fr</a>&gt;</div></blockquote>
<p>Allowing disconnections is important if you use several devices on
your SCSI bus but often causes problems with buggy devices.
Synchronous data transfers increases throughput of fast devices like
hard disks.  Good SCSI hard disks with a large cache gain advantage of
tagged commands queuing.</p>
<p>Try to enable one feature at a time with control commands.  For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>echo &quot;setsync all 25&quot; &gt;/proc/scsi/ncr53c8xx/0
</pre></div>
</div>
<p>Will enable fast synchronous data transfer negotiation for all targets.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>echo &quot;setflag 3&quot; &gt;/proc/scsi/ncr53c8xx/0
</pre></div>
</div>
<p>Will reset flags (no_disc) for target 3, and so will allow it to disconnect
the SCSI Bus.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>echo &quot;settags 3 8&quot; &gt;/proc/scsi/ncr53c8xx/0
</pre></div>
</div>
<p>Will enable tagged command queuing for target 3 if that device supports it.</p>
<p>Once you have found the device and the feature that cause problems, just
disable that feature for that device.</p>
</div>
<div class="section" id="understanding-hardware-error-reports">
<h3>15.2 Understanding hardware error reports<a class="headerlink" href="#understanding-hardware-error-reports" title="Permalink to this headline">¶</a></h3>
<p>When the driver detects an unexpected error condition, it may display a
message of the following pattern:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sym53c876-0:1: ERROR (0:48) (1-21-65) (f/95) @ (script 7c0:19000000).
sym53c876-0: script cmd = 19000000
sym53c876-0: regdump: da 10 80 95 47 0f 01 07 75 01 81 21 80 01 09 00.
</pre></div>
</div>
<p>Some fields in such a message may help you understand the cause of the
problem, as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sym53c876-0:1: ERROR (0:48) (1-21-65) (f/95) @ (script 7c0:19000000).
............A.........B.C....D.E..F....G.H.......I.....J...K.......
</pre></div>
</div>
<dl class="docutils">
<dt>Field A <span class="classifier-delimiter">:</span> <span class="classifier">target number.</span></dt>
<dd>SCSI ID of the device the controller was talking with at the moment the
error occurs.</dd>
<dt>Field B <span class="classifier-delimiter">:</span> <span class="classifier">DSTAT io register (DMA STATUS)</span></dt>
<dd><table border="1" class="first docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Bit 0x40</td>
<td>MDPE Master Data Parity Error
Data parity error detected on the PCI BUS.</td>
</tr>
<tr class="row-even"><td>Bit 0x20</td>
<td>BF   Bus Fault
PCI bus fault condition detected</td>
</tr>
<tr class="row-odd"><td>Bit 0x01</td>
<td>IID  Illegal Instruction Detected
Set by the chip when it detects an Illegal Instruction format
on some condition that makes an instruction illegal.</td>
</tr>
<tr class="row-even"><td>Bit 0x80</td>
<td>DFE Dma Fifo Empty
Pure status bit that does not indicate an error.</td>
</tr>
</tbody>
</table>
<p class="last">If the reported DSTAT value contains a combination of MDPE (0x40),
BF (0x20), then the cause may be likely due to a PCI BUS problem.</p>
</dd>
<dt>Field C <span class="classifier-delimiter">:</span> <span class="classifier">SIST io register (SCSI Interrupt Status)</span></dt>
<dd><table border="1" class="first docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Bit 0x08</td>
<td>SGE  SCSI GROSS ERROR
Indicates that the chip detected a severe error condition
on the SCSI BUS that prevents the SCSI protocol from functioning
properly.</td>
</tr>
<tr class="row-even"><td>Bit 0x04</td>
<td>UDC  Unexpected Disconnection
Indicates that the device released the SCSI BUS when the chip
was not expecting this to happen. A device may behave so to
indicate the SCSI initiator that an error condition not reportable
using the SCSI protocol has occurred.</td>
</tr>
<tr class="row-odd"><td>Bit 0x02</td>
<td>RST  SCSI BUS Reset
Generally SCSI targets do not reset the SCSI BUS, although any
device on the BUS can reset it at any time.</td>
</tr>
<tr class="row-even"><td>Bit 0x01</td>
<td>PAR  Parity
SCSI parity error detected.</td>
</tr>
</tbody>
</table>
<p class="last">On a faulty SCSI BUS, any error condition among SGE (0x08), UDC (0x04) and
PAR (0x01) may be detected by the chip. If your SCSI system sometimes
encounters such error conditions, especially SCSI GROSS ERROR, then a SCSI
BUS problem is likely the cause of these errors.</p>
</dd>
</dl>
<p>For fields D,E,F,G and H, you may look into the sym53c8xx_defs.h file
that contains some minimal comments on IO register bits.</p>
<dl class="docutils">
<dt>Field D <span class="classifier-delimiter">:</span> <span class="classifier">SOCL  Scsi Output Control Latch</span></dt>
<dd>This register reflects the state of the SCSI control lines the
chip want to drive or compare against.</dd>
<dt>Field E <span class="classifier-delimiter">:</span> <span class="classifier">SBCL  Scsi Bus Control Lines</span></dt>
<dd>Actual value of control lines on the SCSI BUS.</dd>
<dt>Field F <span class="classifier-delimiter">:</span> <span class="classifier">SBDL  Scsi Bus Data Lines</span></dt>
<dd>Actual value of data lines on the SCSI BUS.</dd>
<dt>Field G <span class="classifier-delimiter">:</span> <span class="classifier">SXFER  SCSI Transfer</span></dt>
<dd>Contains the setting of the Synchronous Period for output and
the current Synchronous offset (offset 0 means asynchronous).</dd>
<dt>Field H <span class="classifier-delimiter">:</span> <span class="classifier">SCNTL3 Scsi Control Register 3</span></dt>
<dd>Contains the setting of timing values for both asynchronous and
synchronous data transfers.</dd>
</dl>
<p>Understanding Fields I, J, K and dumps requires to have good knowledge of
SCSI standards, chip cores functionnals and internal driver data structures.
You are not required to decode and understand them, unless you want to help
maintain the driver code.</p>
</div>
</div>
<div class="section" id="synchronous-transfer-negotiation-tables">
<h2>16. Synchronous transfer negotiation tables<a class="headerlink" href="#synchronous-transfer-negotiation-tables" title="Permalink to this headline">¶</a></h2>
<p>Tables below have been created by calling the routine the driver uses
for synchronisation negotiation timing calculation and chip setting.
The first table corresponds to Ultra chips 53875 and 53C860 with 80 MHz
clock and 5 clock divisors.
The second one has been calculated by setting the scsi clock to 40 Mhz
and using 4 clock divisors and so applies to all NCR53C8XX chips in fast
SCSI-2 mode.</p>
<p>Periods are in nano-seconds and speeds are in Mega-transfers per second.
1 Mega-transfers/second means 1 MB/s with 8 bits SCSI and 2 MB/s with
Wide16 SCSI.</p>
<p>16.1 Synchronous timings for 53C895, 53C875 and 53C860 SCSI controllers</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="14%" />
<col width="21%" />
<col width="14%" />
<col width="13%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td colspan="3">Negotiated</td>
<td colspan="2">NCR settings</td>
<td rowspan="2">&#160;</td>
</tr>
<tr class="row-even"><td>Factor</td>
<td>Period</td>
<td>Speed</td>
<td>Period</td>
<td>Speed</td>
</tr>
<tr class="row-odd"><td>10</td>
<td>25</td>
<td>40.000</td>
<td>25</td>
<td>40.000</td>
<td>(53C895 only)</td>
</tr>
<tr class="row-even"><td>11</td>
<td>30.2</td>
<td>33.112</td>
<td>31.25</td>
<td>32.000</td>
<td>(53C895 only)</td>
</tr>
<tr class="row-odd"><td>12</td>
<td>50</td>
<td>20.000</td>
<td>50</td>
<td>20.000</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>13</td>
<td>52</td>
<td>19.230</td>
<td>62</td>
<td>16.000</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>14</td>
<td>56</td>
<td>17.857</td>
<td>62</td>
<td>16.000</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>15</td>
<td>60</td>
<td>16.666</td>
<td>62</td>
<td>16.000</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>16</td>
<td>64</td>
<td>15.625</td>
<td>75</td>
<td>13.333</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>17</td>
<td>68</td>
<td>14.705</td>
<td>75</td>
<td>13.333</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>18</td>
<td>72</td>
<td>13.888</td>
<td>75</td>
<td>13.333</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>19</td>
<td>76</td>
<td>13.157</td>
<td>87</td>
<td>11.428</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>20</td>
<td>80</td>
<td>12.500</td>
<td>87</td>
<td>11.428</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>21</td>
<td>84</td>
<td>11.904</td>
<td>87</td>
<td>11.428</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>22</td>
<td>88</td>
<td>11.363</td>
<td>93</td>
<td>10.666</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>23</td>
<td>92</td>
<td>10.869</td>
<td>93</td>
<td>10.666</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>24</td>
<td>96</td>
<td>10.416</td>
<td>100</td>
<td>10.000</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>25</td>
<td>100</td>
<td>10.000</td>
<td>100</td>
<td>10.000</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>26</td>
<td>104</td>
<td>9.615</td>
<td>112</td>
<td>8.888</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>27</td>
<td>108</td>
<td>9.259</td>
<td>112</td>
<td>8.888</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>28</td>
<td>112</td>
<td>8.928</td>
<td>112</td>
<td>8.888</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>29</td>
<td>116</td>
<td>8.620</td>
<td>125</td>
<td>8.000</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>30</td>
<td>120</td>
<td>8.333</td>
<td>125</td>
<td>8.000</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>31</td>
<td>124</td>
<td>8.064</td>
<td>125</td>
<td>8.000</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>32</td>
<td>128</td>
<td>7.812</td>
<td>131</td>
<td>7.619</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>33</td>
<td>132</td>
<td>7.575</td>
<td>150</td>
<td>6.666</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>34</td>
<td>136</td>
<td>7.352</td>
<td>150</td>
<td>6.666</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>35</td>
<td>140</td>
<td>7.142</td>
<td>150</td>
<td>6.666</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>36</td>
<td>144</td>
<td>6.944</td>
<td>150</td>
<td>6.666</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>37</td>
<td>148</td>
<td>6.756</td>
<td>150</td>
<td>6.666</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>38</td>
<td>152</td>
<td>6.578</td>
<td>175</td>
<td>5.714</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>39</td>
<td>156</td>
<td>6.410</td>
<td>175</td>
<td>5.714</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>40</td>
<td>160</td>
<td>6.250</td>
<td>175</td>
<td>5.714</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>41</td>
<td>164</td>
<td>6.097</td>
<td>175</td>
<td>5.714</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>42</td>
<td>168</td>
<td>5.952</td>
<td>175</td>
<td>5.714</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>43</td>
<td>172</td>
<td>5.813</td>
<td>175</td>
<td>5.714</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>44</td>
<td>176</td>
<td>5.681</td>
<td>187</td>
<td>5.333</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>45</td>
<td>180</td>
<td>5.555</td>
<td>187</td>
<td>5.333</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>46</td>
<td>184</td>
<td>5.434</td>
<td>187</td>
<td>5.333</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>47</td>
<td>188</td>
<td>5.319</td>
<td>200</td>
<td>5.000</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>48</td>
<td>192</td>
<td>5.208</td>
<td>200</td>
<td>5.000</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>49</td>
<td>196</td>
<td>5.102</td>
<td>200</td>
<td>5.000</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<p>16.2 Synchronous timings for fast SCSI-2 53C8XX controllers</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="19%" />
<col width="29%" />
<col width="19%" />
<col width="17%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td colspan="3">Negotiated</td>
<td colspan="2">NCR settings</td>
</tr>
<tr class="row-even"><td>Factor</td>
<td>Period</td>
<td>Speed</td>
<td>Period</td>
<td>Speed</td>
</tr>
<tr class="row-odd"><td>25</td>
<td>100</td>
<td>10.000</td>
<td>100</td>
<td>10.000</td>
</tr>
<tr class="row-even"><td>26</td>
<td>104</td>
<td>9.615</td>
<td>125</td>
<td>8.000</td>
</tr>
<tr class="row-odd"><td>27</td>
<td>108</td>
<td>9.259</td>
<td>125</td>
<td>8.000</td>
</tr>
<tr class="row-even"><td>28</td>
<td>112</td>
<td>8.928</td>
<td>125</td>
<td>8.000</td>
</tr>
<tr class="row-odd"><td>29</td>
<td>116</td>
<td>8.620</td>
<td>125</td>
<td>8.000</td>
</tr>
<tr class="row-even"><td>30</td>
<td>120</td>
<td>8.333</td>
<td>125</td>
<td>8.000</td>
</tr>
<tr class="row-odd"><td>31</td>
<td>124</td>
<td>8.064</td>
<td>125</td>
<td>8.000</td>
</tr>
<tr class="row-even"><td>32</td>
<td>128</td>
<td>7.812</td>
<td>131</td>
<td>7.619</td>
</tr>
<tr class="row-odd"><td>33</td>
<td>132</td>
<td>7.575</td>
<td>150</td>
<td>6.666</td>
</tr>
<tr class="row-even"><td>34</td>
<td>136</td>
<td>7.352</td>
<td>150</td>
<td>6.666</td>
</tr>
<tr class="row-odd"><td>35</td>
<td>140</td>
<td>7.142</td>
<td>150</td>
<td>6.666</td>
</tr>
<tr class="row-even"><td>36</td>
<td>144</td>
<td>6.944</td>
<td>150</td>
<td>6.666</td>
</tr>
<tr class="row-odd"><td>37</td>
<td>148</td>
<td>6.756</td>
<td>150</td>
<td>6.666</td>
</tr>
<tr class="row-even"><td>38</td>
<td>152</td>
<td>6.578</td>
<td>175</td>
<td>5.714</td>
</tr>
<tr class="row-odd"><td>39</td>
<td>156</td>
<td>6.410</td>
<td>175</td>
<td>5.714</td>
</tr>
<tr class="row-even"><td>40</td>
<td>160</td>
<td>6.250</td>
<td>175</td>
<td>5.714</td>
</tr>
<tr class="row-odd"><td>41</td>
<td>164</td>
<td>6.097</td>
<td>175</td>
<td>5.714</td>
</tr>
<tr class="row-even"><td>42</td>
<td>168</td>
<td>5.952</td>
<td>175</td>
<td>5.714</td>
</tr>
<tr class="row-odd"><td>43</td>
<td>172</td>
<td>5.813</td>
<td>175</td>
<td>5.714</td>
</tr>
<tr class="row-even"><td>44</td>
<td>176</td>
<td>5.681</td>
<td>187</td>
<td>5.333</td>
</tr>
<tr class="row-odd"><td>45</td>
<td>180</td>
<td>5.555</td>
<td>187</td>
<td>5.333</td>
</tr>
<tr class="row-even"><td>46</td>
<td>184</td>
<td>5.434</td>
<td>187</td>
<td>5.333</td>
</tr>
<tr class="row-odd"><td>47</td>
<td>188</td>
<td>5.319</td>
<td>200</td>
<td>5.000</td>
</tr>
<tr class="row-even"><td>48</td>
<td>192</td>
<td>5.208</td>
<td>200</td>
<td>5.000</td>
</tr>
<tr class="row-odd"><td>49</td>
<td>196</td>
<td>5.102</td>
<td>200</td>
<td>5.000</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id3">
<h2>17. Serial NVRAM<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>(added by Richard Waltham: <a class="reference external" href="mailto:dormouse&#37;&#52;&#48;farsrobt&#46;demon&#46;co&#46;uk">dormouse<span>&#64;</span>farsrobt<span>&#46;</span>demon<span>&#46;</span>co<span>&#46;</span>uk</a>)</p>
<div class="section" id="features">
<h3>17.1 Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h3>
<p>Enabling serial NVRAM support enables detection of the serial NVRAM included
on Symbios and some Symbios compatible host adaptors, and Tekram boards. The
serial NVRAM is used by Symbios and Tekram to hold set up parameters for the
host adaptor and its attached drives.</p>
<p>The Symbios NVRAM also holds data on the boot order of host adaptors in a
system with more than one host adaptor. This enables the order of scanning
the cards for drives to be changed from the default used during host adaptor
detection.</p>
<p>This can be done to a limited extent at the moment using “reverse probe” but
this only changes the order of detection of different types of cards. The
NVRAM boot order settings can do this as well as change the order the same
types of cards are scanned in, something “reverse probe” cannot do.</p>
<p>Tekram boards using Symbios chips, DC390W/F/U, which have NVRAM are detected
and this is used to distinguish between Symbios compatible and Tekram host
adaptors. This is used to disable the Symbios compatible “diff” setting
incorrectly set on Tekram boards if the CONFIG_SCSI_53C8XX_SYMBIOS_COMPAT
configuration parameter is set enabling both Symbios and Tekram boards to be
used together with the Symbios cards using all their features, including
“diff” support. (“led pin” support for Symbios compatible cards can remain
enabled when using Tekram cards. It does nothing useful for Tekram host
adaptors but does not cause problems either.)</p>
</div>
<div class="section" id="symbios-nvram-layout">
<h3>17.2 Symbios NVRAM layout<a class="headerlink" href="#symbios-nvram-layout" title="Permalink to this headline">¶</a></h3>
<p>typical data at NVRAM address 0x100 (53c810a NVRAM):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>00 00
64 01
8e 0b

00 30 00 00 00 00 07 00 00 00 00 00 00 00 07 04 10 04 00 00

04 00 0f 00 00 10 00 50 00 00 01 00 00 62
04 00 03 00 00 10 00 58 00 00 01 00 00 63
04 00 01 00 00 10 00 48 00 00 01 00 00 61
00 00 00 00 00 00 00 00 00 00 00 00 00 00

0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00

0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00

00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00

00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00

00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00

fe fe
00 00
00 00
</pre></div>
</div>
<p>NVRAM layout details</p>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">NVRAM Address</th>
<th class="head">&#160;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0x000-0x0ff</td>
<td>not used</td>
</tr>
<tr class="row-odd"><td>0x100-0x26f</td>
<td>initialised data</td>
</tr>
<tr class="row-even"><td>0x270-0x7ff</td>
<td>not used</td>
</tr>
</tbody>
</table>
<p>general layout:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>header  -   6 bytes,
data    - 356 bytes (checksum is byte sum of this data)
trailer -   6 bytes
          ---
total     368 bytes
</pre></div>
</div>
<p>data area layout:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>controller set up  -  20 bytes
boot configuration -  56 bytes (4x14 bytes)
device set up      - 128 bytes (16x8 bytes)
unused (spare?)    - 152 bytes (19x8 bytes)
                     ---
total                356 bytes
</pre></div>
</div>
<p>header:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>00 00   - ?? start marker
64 01   - byte count (lsb/msb excludes header/trailer)
8e 0b   - checksum (lsb/msb excludes header/trailer)
</pre></div>
</div>
<p>controller set up:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>00 30 00 00 00 00 07 00 00 00 00 00 00 00 07 04 10 04 00 00
                |     |           |     |
                |     |           |      -- host ID
                |     |           |
                |     |            --Removable Media Support
                |     |               0x00 = none
                |     |               0x01 = Bootable Device
                |     |               0x02 = All with Media
                |     |
                |      --flag bits 2
                |        0x00000001= scan order hi-&gt;low
                |            (default 0x00 - scan low-&gt;hi)
                    --flag bits 1
                    0x00000001 scam enable
                    0x00000010 parity enable
                    0x00000100 verbose boot msgs
</pre></div>
</div>
<p>remaining bytes unknown - they do not appear to change in my
current set up for any of the controllers.</p>
<p>default set up is identical for 53c810a and 53c875 NVRAM
(Removable Media added Symbios BIOS version 4.09)</p>
<p>boot configuration</p>
<p>boot order set by order of the devices in this table:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>04 00 0f 00 00 10 00 50 00 00 01 00 00 62 -- 1st controller
04 00 03 00 00 10 00 58 00 00 01 00 00 63    2nd controller
04 00 01 00 00 10 00 48 00 00 01 00 00 61    3rd controller
00 00 00 00 00 00 00 00 00 00 00 00 00 00    4th controller
    |  |  |  |     |        |     |  |
    |  |  |  |     |        |      ---- PCI io port adr
    |  |  |  |     |         --0x01 init/scan at boot time
    |  |  |  |      --PCI device/function number (0xdddddfff)
    |  |   ----- ?? PCI vendor ID (lsb/msb)
        ----PCI device ID (lsb/msb)

?? use of this data is a guess but seems reasonable
</pre></div>
</div>
<p>remaining bytes unknown - they do not appear to change in my
current set up</p>
</div>
<div class="section" id="default-set-up-is-identical-for-53c810a-and-53c875-nvram">
<h3>default set up is identical for 53c810a and 53c875 NVRAM<a class="headerlink" href="#default-set-up-is-identical-for-53c810a-and-53c875-nvram" title="Permalink to this headline">¶</a></h3>
<p>device set up (up to 16 devices - includes controller):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>0f 00 08 08 64 00 0a 00 - id 0
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00

0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00
0f 00 08 08 64 00 0a 00 - id 15
|     |  |  |     |  |
|     |  |  |      ----timeout (lsb/msb)
|     |  |   --synch period (0x?? 40 Mtrans/sec- fast 40) (probably 0x28)
|     |  |                  (0x30 20 Mtrans/sec- fast 20)
|     |  |                  (0x64 10 Mtrans/sec- fast )
|     |  |                  (0xc8  5 Mtrans/sec)
|     |  |                  (0x00  asynchronous)
|     |   -- ?? max sync offset (0x08 in NVRAM on 53c810a)
|     |                         (0x10 in NVRAM on 53c875)
|      --device bus width (0x08 narrow)
|                         (0x10 16 bit wide)
--flag bits
    0x00000001 - disconnect enabled
    0x00000010 - scan at boot time
    0x00000100 - scan luns
    0x00001000 - queue tags enabled
</pre></div>
</div>
<p>remaining bytes unknown - they do not appear to change in my
current set up</p>
<p>?? use of this data is a guess but seems reasonable
(but it could be max bus width)</p>
<p>default set up for 53c810a NVRAM
default set up for 53c875 NVRAM</p>
<blockquote>
<div><ul class="simple">
<li>bus width     - 0x10</li>
<li>sync offset ? - 0x10</li>
<li>sync period   - 0x30</li>
</ul>
</div></blockquote>
<p>?? spare device space (32 bit bus ??)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>00 00 00 00 00 00 00 00  (19x8bytes)
.
.
00 00 00 00 00 00 00 00
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h3>default set up is identical for 53c810a and 53c875 NVRAM<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>trailer:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>fe fe   - ? end marker ?
00 00
00 00
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3>default set up is identical for 53c810a and 53c875 NVRAM<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="tekram-nvram-layout">
<h3>17.3 Tekram NVRAM layout<a class="headerlink" href="#tekram-nvram-layout" title="Permalink to this headline">¶</a></h3>
<p>nvram 64x16 (1024 bit)</p>
<p>Drive settings:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Drive ID 0-15 (addr 0x0yyyy0 = device setup, yyyy = ID)
            (addr 0x0yyyy1 = 0x0000)

    x x x x  x x x x  x x x x  x x x x
            | | |      | |  | | | |
            | | |      | |  | | |  ----- parity check   0 - off
            | | |      | |  | | |                       1 - on
            | | |      | |  | | |
            | | |      | |  | |  ------- sync neg       0 - off
            | | |      | |  | |                         1 - on
            | | |      | |  | |
            | | |      | |  |  --------- disconnect     0 - off
            | | |      | |  |                           1 - on
            | | |      | |  |
            | | |      | |   ----------- start cmd      0 - off
            | | |      | |                              1 - on
            | | |      | |
            | | |      |  -------------- tagged cmds    0 - off
            | | |      |                                1 - on
            | | |      |
            | | |       ---------------- wide neg       0 - off
            | | |                                       1 - on
            | | |
                --------------------------- sync rate      0 - 10.0 Mtrans/sec
                                                        1 -  8.0
                                                        2 -  6.6
                                                        3 -  5.7
                                                        4 -  5.0
                                                        5 -  4.0
                                                        6 -  3.0
                                                        7 -  2.0
                                                        7 -  2.0
                                                        8 - 20.0
                                                        9 - 16.7
                                                        a - 13.9
                                                        b - 11.9
</pre></div>
</div>
<p>Global settings</p>
<p>Host flags 0 (addr 0x100000, 32):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>x x x x  x x x x  x x x x  x x x x
| | | |  | | | |           | | | |
| | | |  | | | |            ----------- host ID    0x00 - 0x0f
| | | |  | | | |
| | | |  | | |  ----------------------- support for    0 - off
| | | |  | | |                          &gt; 2 drives     1 - on
| | | |  | | |
| | | |  | |  ------------------------- support drives 0 - off
| | | |  | |                            &gt; 1Gbytes      1 - on
| | | |  | |
| | | |  |  --------------------------- bus reset on   0 - off
| | | |  |                                power on     1 - on
| | | |  |
| | | |   ----------------------------- active neg     0 - off
| | | |                                                1 - on
| | | |
| | |  -------------------------------- imm seek       0 - off
| | |                                                  1 - on
| | |
| |  ---------------------------------- scan luns      0 - off
| |                                                    1 - on
| |
 -------------------------------------- removable      0 - disable
                                        as BIOS dev    1 - boot device
                                                       2 - all
</pre></div>
</div>
<p>Host flags 1 (addr 0x100001, 33):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>x x x x  x x x x  x x x x  x x x x
           | | |             | | |
           | | |              --------- boot delay     0 -   3 sec
           | | |                                       1 -   5
           | | |                                       2 -  10
           | | |                                       3 -  20
           | | |                                       4 -  30
           | | |                                       5 -  60
           | | |                                       6 - 120
           | | |
            --------------------------- max tag cmds   0 -  2
                                                       1 -  4
                                                       2 -  8
                                                       3 - 16
                                                       4 - 32
</pre></div>
</div>
<p>Host flags 2 (addr 0x100010, 34):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>x x x x  x x x x  x x x x  x x x x
                                 |
                                  ----- F2/F6 enable   0 - off ???
                                                       1 - on  ???
</pre></div>
</div>
<p>checksum (addr 0x111111)</p>
<p>checksum = 0x1234 - (sum addr 0-63)</p>
<hr class="docutils" />
<p>default nvram data:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>0x0037 0x0000 0x0037 0x0000 0x0037 0x0000 0x0037 0x0000
0x0037 0x0000 0x0037 0x0000 0x0037 0x0000 0x0037 0x0000
0x0037 0x0000 0x0037 0x0000 0x0037 0x0000 0x0037 0x0000
0x0037 0x0000 0x0037 0x0000 0x0037 0x0000 0x0037 0x0000

0x0f07 0x0400 0x0001 0x0000 0x0000 0x0000 0x0000 0x0000
0x0000 0x0000 0x0000 0x0000 0x0000 0x0000 0x0000 0x0000
0x0000 0x0000 0x0000 0x0000 0x0000 0x0000 0x0000 0x0000
0x0000 0x0000 0x0000 0x0000 0x0000 0x0000 0x0000 0xfbbc
</pre></div>
</div>
</div>
</div>
<div class="section" id="support-for-big-endian">
<h2>18. Support for Big Endian<a class="headerlink" href="#support-for-big-endian" title="Permalink to this headline">¶</a></h2>
<p>The PCI local bus has been primarily designed for x86 architecture.
As a consequence, PCI devices generally expect DWORDS using little endian
byte ordering.</p>
<div class="section" id="big-endian-cpu">
<h3>18.1 Big Endian CPU<a class="headerlink" href="#big-endian-cpu" title="Permalink to this headline">¶</a></h3>
<p>In order to support NCR chips on a Big Endian architecture the driver has to
perform byte reordering each time it is needed. This feature has been
added to the driver by Cort &lt;<a class="reference external" href="mailto:cort&#37;&#52;&#48;cs&#46;nmt&#46;edu">cort<span>&#64;</span>cs<span>&#46;</span>nmt<span>&#46;</span>edu</a>&gt; and is available in driver
version 2.5 and later ones. For the moment Big Endian support has only
been tested on Linux/PPC (PowerPC).</p>
</div>
<div class="section" id="ncr-chip-in-big-endian-mode-of-operations">
<h3>18.2 NCR chip in Big Endian mode of operations<a class="headerlink" href="#ncr-chip-in-big-endian-mode-of-operations" title="Permalink to this headline">¶</a></h3>
<p>It can be read in SYMBIOS documentation that some chips support a special
Big Endian mode, on paper: 53C815, 53C825A, 53C875, 53C875N, 53C895.
This mode of operations is not software-selectable, but needs pin named
BigLit to be pulled-up. Using this mode, most of byte reorderings should
be avoided when the driver is running on a Big Endian CPU.
Driver version 2.5 is also, in theory, ready for this feature.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="NinjaSCSI.html" class="btn btn-neutral float-right" title="WorkBiT NinjaSCSI-3/32Bi driver for Linux" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="megaraid.html" class="btn btn-neutral float-left" title="Notes on Management Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
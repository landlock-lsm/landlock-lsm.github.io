

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Notes on Maya44 USB Audio Support &mdash; The Linux Kernel 5.2.0-rc5+ documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Software Interface ALSA-DSP MADI Driver" href="hdspm.html" />
    <link rel="prev" title="ALSA BT87x Driver" href="bt87x.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.2.0-rc5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../media/index.html">Linux Media Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Linux Sound Subsystem Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../kernel-api/index.html">ALSA Kernel API Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../designs/index.html">Designs and Implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../soc/index.html">ALSA SoC Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alsa-configuration.html">Advanced Linux Sound Architecture - Driver Configuration guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hd-audio/index.html">HD-Audio</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Card-Specific Information</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="joystick.html">Analog Joystick Support on ALSA Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="cmipci.html">Brief Notes on C-Media 8338/8738/8768/8770 Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="sb-live-mixer.html">Sound Blaster Live mixer / default DSP code</a></li>
<li class="toctree-l3"><a class="reference internal" href="audigy-mixer.html">Sound Blaster Audigy mixer / default DSP code</a></li>
<li class="toctree-l3"><a class="reference internal" href="emu10k1-jack.html">Low latency, multichannel audio with JACK and the emu10k1/emu10k2</a></li>
<li class="toctree-l3"><a class="reference internal" href="via82xx-mixer.html">VIA82xx mixer</a></li>
<li class="toctree-l3"><a class="reference internal" href="audiophile-usb.html">Guide to using M-Audio Audiophile USB with ALSA and Jack</a></li>
<li class="toctree-l3"><a class="reference internal" href="mixart.html">Alsa driver for Digigram miXart8 and miXart8AES/EBU soundcards</a></li>
<li class="toctree-l3"><a class="reference internal" href="bt87x.html">ALSA BT87x Driver</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Notes on Maya44 USB Audio Support</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#state-of-development">STATE OF DEVELOPMENT</a></li>
<li class="toctree-l4"><a class="reference internal" href="#driver-details">DRIVER DETAILS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sampling-rates">SAMPLING RATES</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sound-devices">SOUND DEVICES</a></li>
<li class="toctree-l4"><a class="reference internal" href="#naming-of-mixer-controls">NAMING OF MIXER CONTROLS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hdspm.html">Software Interface ALSA-DSP MADI Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="serial-u16550.html">Serial UART 16450/16550 MIDI driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="img-spdif-in.html">Imagination Technologies SPDIF Input Controllers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../x86/index.html">x86-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../x86/index.html">x86-specific Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../filesystems/ext4/index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Linux Sound Subsystem Documentation</a> &raquo;</li>
        
          <li><a href="index.html">Card-Specific Information</a> &raquo;</li>
        
      <li>Notes on Maya44 USB Audio Support</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/sound/cards/maya44.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="notes-on-maya44-usb-audio-support">
<h1>Notes on Maya44 USB Audio Support<a class="headerlink" href="#notes-on-maya44-usb-audio-support" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The following is the original document of Rainer’s patch that the
current maya44 code based on.  Some contents might be obsoleted, but I
keep here as reference – tiwai</p>
</div>
<p>Feb 14, 2008</p>
<p>Rainer Zimmermann &lt;<a class="reference external" href="mailto:mail&#37;&#52;&#48;lightshed&#46;de">mail<span>&#64;</span>lightshed<span>&#46;</span>de</a>&gt;</p>
<div class="section" id="state-of-development">
<h2>STATE OF DEVELOPMENT<a class="headerlink" href="#state-of-development" title="Permalink to this headline">¶</a></h2>
<p>This driver is being developed on the initiative of Piotr Makowski (<a class="reference external" href="mailto:oponek&#37;&#52;&#48;gmail&#46;com">oponek<span>&#64;</span>gmail<span>&#46;</span>com</a>) and financed by Lars Bergmann.
Development is carried out by Rainer Zimmermann (<a class="reference external" href="mailto:mail&#37;&#52;&#48;lightshed&#46;de">mail<span>&#64;</span>lightshed<span>&#46;</span>de</a>).</p>
<p>ESI provided a sample Maya44 card for the development work.</p>
<p>However, unfortunately it has turned out difficult to get detailed programming information, so I (Rainer Zimmermann) had to find out some card-specific information by experiment and conjecture. Some information (in particular, several GPIO bits) is still missing.</p>
<p>This is the first testing version of the Maya44 driver released to the alsa-devel mailing list (Feb 5, 2008).</p>
<p>The following functions work, as tested by Rainer Zimmermann and Piotr Makowski:</p>
<ul class="simple">
<li>playback and capture at all sampling rates</li>
<li>input/output level</li>
<li>crossmixing</li>
<li>line/mic switch</li>
<li>phantom power switch</li>
<li>analogue monitor a.k.a bypass</li>
</ul>
<p>The following functions <em>should</em> work, but are not fully tested:</p>
<ul class="simple">
<li>Channel 3+4 analogue - S/PDIF input switching</li>
<li>S/PDIF output</li>
<li>all inputs/outputs on the M/IO/DIO extension card</li>
<li>internal/external clock selection</li>
</ul>
<p><em>In particular, we would appreciate testing of these functions by anyone who has access to an M/IO/DIO extension card.</em></p>
<p>Things that do not seem to work:</p>
<ul class="simple">
<li>The level meters (“multi track”) in ‘alsamixer’ do not seem to react to signals in (if this is a bug, it would probably be in the existing ICE1724 code).</li>
<li>Ardour 2.1 seems to work only via JACK, not using ALSA directly or via OSS. This still needs to be tracked down.</li>
</ul>
</div>
<div class="section" id="driver-details">
<h2>DRIVER DETAILS<a class="headerlink" href="#driver-details" title="Permalink to this headline">¶</a></h2>
<p>the following files were added:</p>
<ul class="simple">
<li>pci/ice1724/maya44.c - Maya44 specific code</li>
<li>pci/ice1724/maya44.h</li>
<li>pci/ice1724/ice1724.patch</li>
<li>pci/ice1724/ice1724.h.patch - PROPOSED patch to ice1724.h (see SAMPLING RATES)</li>
<li>i2c/other/wm8776.c - low-level access routines for Wolfson WM8776 codecs</li>
<li>include/wm8776.h</li>
</ul>
<p>Note that the wm8776.c code is meant to be card-independent and does not actually register the codec with the ALSA infrastructure.
This is done in maya44.c, mainly because some of the WM8776 controls are used in Maya44-specific ways, and should be named appropriately.</p>
<p>the following files were created in pci/ice1724, simply #including the corresponding file from the alsa-kernel tree:</p>
<ul class="simple">
<li>wtm.h</li>
<li>vt1720_mobo.h</li>
<li>revo.h</li>
<li>prodigy192.h</li>
<li>pontis.h</li>
<li>phase.h</li>
<li>maya44.h</li>
<li>juli.h</li>
<li>aureon.h</li>
<li>amp.h</li>
<li>envy24ht.h</li>
<li>se.h</li>
<li>prodigy_hifi.h</li>
</ul>
<p><em>I hope this is the correct way to do things.</em></p>
</div>
<div class="section" id="sampling-rates">
<h2>SAMPLING RATES<a class="headerlink" href="#sampling-rates" title="Permalink to this headline">¶</a></h2>
<p>The Maya44 card (or more exactly, the Wolfson WM8776 codecs) allow a maximum sampling rate of 192 kHz for playback and 92 kHz for capture.</p>
<p>As the ICE1724 chip only allows one global sampling rate, this is handled as follows:</p>
<ul class="simple">
<li>setting the sampling rate on any open PCM device on the maya44 card will always set the <em>global</em> sampling rate for all playback and capture channels.</li>
<li>In the current state of the driver, setting rates of up to 192 kHz is permitted even for capture devices.</li>
</ul>
<p><em>AVOID CAPTURING AT RATES ABOVE 96kHz</em>, even though it may appear to work. The codec cannot actually capture at such rates, meaning poor quality.</p>
<p>I propose some additional code for limiting the sampling rate when setting on a capture pcm device. However because of the global sampling rate, this logic would be somewhat problematic.</p>
<p>The proposed code (currently deactivated) is in ice1712.h.patch, ice1724.c and maya44.c (in pci/ice1712).</p>
</div>
<div class="section" id="sound-devices">
<h2>SOUND DEVICES<a class="headerlink" href="#sound-devices" title="Permalink to this headline">¶</a></h2>
<p>PCM devices correspond to inputs/outputs as follows (assuming Maya44 is card #0):</p>
<ul class="simple">
<li>hw:0,0 input - stereo, analog input 1+2</li>
<li>hw:0,0 output - stereo, analog output 1+2</li>
<li>hw:0,1 input - stereo, analog input 3+4 OR S/PDIF input</li>
<li>hw:0,1 output - stereo, analog output 3+4 (and SPDIF out)</li>
</ul>
</div>
<div class="section" id="naming-of-mixer-controls">
<h2>NAMING OF MIXER CONTROLS<a class="headerlink" href="#naming-of-mixer-controls" title="Permalink to this headline">¶</a></h2>
<p>(for more information about the signal flow, please refer to the block diagram on p.24 of the ESI Maya44 manual, or in the ESI windows software).</p>
<dl class="docutils">
<dt>PCM</dt>
<dd>(digital) output level for channel 1+2</dd>
<dt>PCM 1</dt>
<dd>same for channel 3+4</dd>
<dt>Mic Phantom+48V</dt>
<dd><p class="first">switch for +48V phantom power for electrostatic microphones on input 1/2.</p>
<p class="last">Make sure this is not turned on while any other source is connected to input 1/2.
It might damage the source and/or the maya44 card.</p>
</dd>
<dt>Mic/Line input</dt>
<dd>if switch is on, input jack 1/2 is microphone input (mono), otherwise line input (stereo).</dd>
<dt>Bypass</dt>
<dd>analogue bypass from ADC input to output for channel 1+2. Same as “Monitor” in the windows driver.</dd>
<dt>Bypass 1</dt>
<dd>same for channel 3+4.</dd>
<dt>Crossmix</dt>
<dd>cross-mixer from channels 1+2 to channels 3+4</dd>
<dt>Crossmix 1</dt>
<dd>cross-mixer from channels 3+4 to channels 1+2</dd>
<dt>IEC958 Output</dt>
<dd><p class="first">switch for S/PDIF output.</p>
<p class="last">This is not supported by the ESI windows driver.
S/PDIF should output the same signal as channel 3+4. [untested!]</p>
</dd>
<dt>Digitial output selectors</dt>
<dd>These switches allow a direct digital routing from the ADCs to the DACs.
Each switch determines where the digital input data to one of the DACs comes from.
They are not supported by the ESI windows driver.
For normal operation, they should all be set to “PCM out”.</dd>
<dt>H/W</dt>
<dd>Output source channel 1</dd>
<dt>H/W 1</dt>
<dd>Output source channel 2</dd>
<dt>H/W 2</dt>
<dd>Output source channel 3</dd>
<dt>H/W 3</dt>
<dd>Output source channel 4</dd>
<dt>H/W 4 … H/W 9</dt>
<dd><p class="first">unknown function, left in to enable testing.</p>
<p class="last">Possibly some of these control S/PDIF output(s).
If these turn out to be unused, they will go away in later driver versions.</p>
</dd>
</dl>
<p>Selectable values for each of the digital output selectors are:</p>
<dl class="docutils">
<dt>PCM out</dt>
<dd>DAC output of the corresponding channel (default setting)</dd>
<dt>Input 1 … Input 4</dt>
<dd>direct routing from ADC output of the selected input channel</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hdspm.html" class="btn btn-neutral float-right" title="Software Interface ALSA-DSP MADI Driver" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="bt87x.html" class="btn btn-neutral float-left" title="ALSA BT87x Driver" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
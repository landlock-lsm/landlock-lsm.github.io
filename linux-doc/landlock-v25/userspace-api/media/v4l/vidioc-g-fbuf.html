

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>7.30. ioctl VIDIOC_G_FBUF, VIDIOC_S_FBUF &mdash; The Linux Kernel 5.10.0-rc6+ documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="7.31. ioctl VIDIOC_G_FMT, VIDIOC_S_FMT, VIDIOC_TRY_FMT" href="vidioc-g-fmt.html" />
    <link rel="prev" title="7.29. ioctl VIDIOC_G_EXT_CTRLS, VIDIOC_S_EXT_CTRLS, VIDIOC_TRY_EXT_CTRLS" href="vidioc-g-ext-ctrls.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.10.0-rc6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devicetree/index.html">Open Firmware and Device Tree</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">The Linux kernel user-space API guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../no_new_privs.html">No New Privileges Flag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../seccomp_filter.html">Seccomp BPF (SECure COMPuting with filters)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../landlock.html">Landlock: unprivileged access control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../unshare.html">unshare system call</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec_ctrl.html">Speculation Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../accelerators/ocxl.html">OpenCAPI (Open Coherent Accelerator Processor Interface)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ioctl/index.html">IOCTLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../iommu.html">IOMMU Userspace API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Linux Media Infrastructure userspace API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="v4l2.html">Part I - Video for Linux API</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="common.html">1. Common API Elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="pixfmt.html">2. Image Formats</a></li>
<li class="toctree-l4"><a class="reference internal" href="io.html">3. Input/Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="devices.html">4. Interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="libv4l.html">5. Libv4l Userspace Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="compat.html">6. Changes</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="user-func.html">7. Function Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="common-defs.html">8. Common definitions for V4L2 and V4L2 subdev interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="videodev.html">9. Video For Linux Two Header File</a></li>
<li class="toctree-l4"><a class="reference internal" href="capture-example.html">10. Video Capture Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="v4l2grab-example.html">11. Video Grabber example using libv4l</a></li>
<li class="toctree-l4"><a class="reference internal" href="biblio.html">12. References</a></li>
<li class="toctree-l4"><a class="reference internal" href="v4l2.html#revision-and-copyright">Revision and Copyright</a></li>
<li class="toctree-l4"><a class="reference internal" href="v4l2.html#revision-history">Revision History</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dvb/dvbapi.html">Part II - Digital TV API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rc/remote_controllers.html">Part III - Remote Controller API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mediactl/media-controller.html">Part IV - Media Controller API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cec/cec-api.html">Part V - Consumer Electronics Control API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gen-errors.html">Generic Error Codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fdl-appendix.html">GNU Free Documentation License</a></li>
<li class="toctree-l3"><a class="reference internal" href="../drivers/index.html">Video4Linux (V4L)  driver-specific documentation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mhi/index.html">MHI</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../arm/index.html">ARM Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../arm64/index.html">ARM64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ia64/index.html">IA-64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../m68k/index.html">m68k Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mips/index.html">MIPS-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nios2/nios2.html">Linux on the Nios II architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../openrisc/index.html">OpenRISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../parisc/index.html">PA-RISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../powerpc/index.html">powerpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../riscv/index.html">RISC-V architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../s390/index.html">s390 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sparc/index.html">Sparc Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../x86/index.html">x86-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../xtensa/index.html">Xtensa Architecture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../filesystems/ext4/index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../staging/index.html">Unsorted Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../staging/index.html#atomic-types">Atomic Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../staging/index.html#atomic-bitops">Atomic bitops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../staging/index.html#memory-barriers">Memory Barriers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../watch_queue.html">General notification mechanism</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">The Linux kernel user-space API guide</a> &raquo;</li>
        
          <li><a href="../index.html">Linux Media Infrastructure userspace API</a> &raquo;</li>
        
          <li><a href="v4l2.html">Part I - Video for Linux API</a> &raquo;</li>
        
          <li><a href="user-func.html"><span class="section-number">7. </span>Function Reference</a> &raquo;</li>
        
      <li><span class="section-number">7.30. </span>ioctl VIDIOC_G_FBUF, VIDIOC_S_FBUF</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/userspace-api/media/v4l/vidioc-g-fbuf.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ioctl-vidioc-g-fbuf-vidioc-s-fbuf">
<span id="vidioc-g-fbuf"></span><h1><span class="section-number">7.30. </span>ioctl VIDIOC_G_FBUF, VIDIOC_S_FBUF<a class="headerlink" href="#ioctl-vidioc-g-fbuf-vidioc-s-fbuf" title="Permalink to this headline">¶</a></h1>
<div class="section" id="name">
<h2><span class="section-number">7.30.1. </span>Name<a class="headerlink" href="#name" title="Permalink to this headline">¶</a></h2>
<p>VIDIOC_G_FBUF - VIDIOC_S_FBUF - Get or set frame buffer overlay parameters</p>
</div>
<div class="section" id="synopsis">
<h2><span class="section-number">7.30.2. </span>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<dl class="c macro">
<dt id="c.V4L.VIDIOC_G_FBUF">
<code class="sig-name descname">VIDIOC_G_FBUF</code><a class="headerlink" href="#c.V4L.VIDIOC_G_FBUF" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">ioctl(int</span> <span class="pre">fd,</span> <span class="pre">VIDIOC_G_FBUF,</span> <span class="pre">struct</span> <span class="pre">v4l2_framebuffer</span> <span class="pre">*argp)</span></code></p>
<dl class="c macro">
<dt id="c.V4L.VIDIOC_S_FBUF">
<code class="sig-name descname">VIDIOC_S_FBUF</code><a class="headerlink" href="#c.V4L.VIDIOC_S_FBUF" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">ioctl(int</span> <span class="pre">fd,</span> <span class="pre">VIDIOC_S_FBUF,</span> <span class="pre">const</span> <span class="pre">struct</span> <span class="pre">v4l2_framebuffer</span> <span class="pre">*argp)</span></code></p>
</div>
<div class="section" id="arguments">
<h2><span class="section-number">7.30.3. </span>Arguments<a class="headerlink" href="#arguments" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">fd</span></code></dt><dd><p>File descriptor returned by <a class="reference internal" href="func-open.html#c.V4L.open" title="open"><code class="xref c c-func docutils literal notranslate"><span class="pre">open()</span></code></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">argp</span></code></dt><dd><p>Pointer to struct <a class="reference internal" href="#c.V4L.v4l2_framebuffer" title="v4l2_framebuffer"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_framebuffer</span></code></a>.</p>
</dd>
</dl>
</div>
<div class="section" id="description">
<h2><span class="section-number">7.30.4. </span>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Applications can use the <a class="reference internal" href="#vidioc-g-fbuf"><span class="std std-ref">VIDIOC_G_FBUF</span></a> and <a class="reference internal" href="#vidioc-g-fbuf"><span class="std std-ref">VIDIOC_S_FBUF</span></a> ioctl
to get and set the framebuffer parameters for a
<a class="reference internal" href="dev-overlay.html#overlay"><span class="std std-ref">Video Overlay</span></a> or <a class="reference internal" href="dev-osd.html#osd"><span class="std std-ref">Video Output Overlay</span></a>
(OSD). The type of overlay is implied by the device type (capture or
output device) and can be determined with the
<a class="reference internal" href="vidioc-querycap.html#vidioc-querycap"><span class="std std-ref">ioctl VIDIOC_QUERYCAP</span></a> ioctl. One <code class="docutils literal notranslate"><span class="pre">/dev/videoN</span></code>
device must not support both kinds of overlay.</p>
<p>The V4L2 API distinguishes destructive and non-destructive overlays. A
destructive overlay copies captured video images into the video memory
of a graphics card. A non-destructive overlay blends video images into a
VGA signal or graphics into a video signal. <em>Video Output Overlays</em> are
always non-destructive.</p>
<p>To get the current parameters applications call the <a class="reference internal" href="#vidioc-g-fbuf"><span class="std std-ref">VIDIOC_G_FBUF</span></a>
ioctl with a pointer to a struct <a class="reference internal" href="#c.V4L.v4l2_framebuffer" title="v4l2_framebuffer"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_framebuffer</span></code></a>
structure. The driver fills all fields of the structure or returns an
EINVAL error code when overlays are not supported.</p>
<p>To set the parameters for a <em>Video Output Overlay</em>, applications must
initialize the <code class="docutils literal notranslate"><span class="pre">flags</span></code> field of a struct
<a class="reference internal" href="#c.V4L.v4l2_framebuffer" title="v4l2_framebuffer"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_framebuffer</span></code></a>. Since the framebuffer is
implemented on the TV card all other parameters are determined by the
driver. When an application calls <a class="reference internal" href="#vidioc-g-fbuf"><span class="std std-ref">VIDIOC_S_FBUF</span></a> with a pointer to
this structure, the driver prepares for the overlay and returns the
framebuffer parameters as <a class="reference internal" href="#vidioc-g-fbuf"><span class="std std-ref">VIDIOC_G_FBUF</span></a> does, or it returns an error
code.</p>
<p>To set the parameters for a <em>non-destructive Video Overlay</em>,
applications must initialize the <code class="docutils literal notranslate"><span class="pre">flags</span></code> field, the <code class="docutils literal notranslate"><span class="pre">fmt</span></code>
substructure, and call <a class="reference internal" href="#vidioc-g-fbuf"><span class="std std-ref">VIDIOC_S_FBUF</span></a>. Again the driver prepares for
the overlay and returns the framebuffer parameters as <a class="reference internal" href="#vidioc-g-fbuf"><span class="std std-ref">VIDIOC_G_FBUF</span></a>
does, or it returns an error code.</p>
<p>For a <em>destructive Video Overlay</em> applications must additionally provide
a <code class="docutils literal notranslate"><span class="pre">base</span></code> address. Setting up a DMA to a random memory location can
jeopardize the system security, its stability or even damage the
hardware, therefore only the superuser can set the parameters for a
destructive video overlay.</p>
<dl class="c type">
<dt id="c.V4L.v4l2_framebuffer">
<em class="property">type </em><code class="sig-name descname">v4l2_framebuffer</code><a class="headerlink" href="#c.V4L.v4l2_framebuffer" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<table class="longtable docutils align-default" id="id2">
<caption><span class="caption-text">struct v4l2_framebuffer</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 40%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">capability</span></code></p></td>
<td></td>
<td><p>Overlay capability flags set by the driver, see
<a class="reference internal" href="#framebuffer-cap"><span class="std std-ref">Frame Buffer Capability Flags</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">flags</span></code></p></td>
<td></td>
<td><p>Overlay control flags set by application and driver, see
<a class="reference internal" href="#framebuffer-flags"><span class="std std-ref">Frame Buffer Flags</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>void *</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">base</span></code></p></td>
<td></td>
<td><p>Physical base address of the framebuffer, that is the address of
the pixel in the top left corner of the framebuffer. <a class="footnote-reference brackets" href="#f1" id="id1">1</a></p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td></td>
<td><p>This field is irrelevant to <em>non-destructive Video Overlays</em>. For
<em>destructive Video Overlays</em> applications must provide a base
address. The driver may accept only base addresses which are a
multiple of two, four or eight bytes. For <em>Video Output Overlays</em>
the driver must return a valid base address, so applications can
find the corresponding Linux framebuffer device (see
<a class="reference internal" href="dev-osd.html#osd"><span class="std std-ref">Video Output Overlay Interface</span></a>).</p></td>
</tr>
<tr class="row-odd"><td><p>struct</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fmt</span></code></p></td>
<td></td>
<td><p>Layout of the frame buffer.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">width</span></code></p></td>
<td><p>Width of the frame buffer in pixels.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">height</span></code></p></td>
<td><p>Height of the frame buffer in pixels.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pixelformat</span></code></p></td>
<td><p>The pixel format of the framebuffer.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td><p>For <em>non-destructive Video Overlays</em> this field only defines a
format for the struct <a class="reference internal" href="dev-overlay.html#c.v4l2_window" title="v4l2_window"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_window</span></code></a>
<code class="docutils literal notranslate"><span class="pre">chromakey</span></code> field.</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td></td>
<td><p>For <em>destructive Video Overlays</em> applications must initialize this
field. For <em>Video Output Overlays</em> the driver must return a valid
format.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td><p>Usually this is an RGB format (for example
<a class="reference internal" href="pixfmt-rgb.html#v4l2-pix-fmt-rgb565"><span class="std std-ref">V4L2_PIX_FMT_RGB565</span></a>) but YUV
formats (only packed YUV formats when chroma keying is used, not
including <code class="docutils literal notranslate"><span class="pre">V4L2_PIX_FMT_YUYV</span></code> and <code class="docutils literal notranslate"><span class="pre">V4L2_PIX_FMT_UYVY</span></code>) and the
<code class="docutils literal notranslate"><span class="pre">V4L2_PIX_FMT_PAL8</span></code> format are also permitted. The behavior of
the driver when an application requests a compressed format is
undefined. See <a class="reference internal" href="pixfmt.html#pixfmt"><span class="std std-ref">Image Formats</span></a> for information on pixel formats.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>enum <a class="reference internal" href="field-order.html#c.v4l2_field" title="v4l2_field"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_field</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">field</span></code></p></td>
<td><p>Drivers and applications shall ignore this field. If applicable,
the field order is selected with the
<a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a> ioctl, using the <code class="docutils literal notranslate"><span class="pre">field</span></code>
field of struct <a class="reference internal" href="dev-overlay.html#c.v4l2_window" title="v4l2_window"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_window</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bytesperline</span></code></p></td>
<td><p>Distance in bytes between the leftmost pixels in two adjacent
lines.</p></td>
</tr>
<tr class="row-even"><td colspan="4"><p></p>
<p>This field is irrelevant to <em>non-destructive Video Overlays</em>.</p>
<p>For <em>destructive Video Overlays</em> both applications and drivers can
set this field to request padding bytes at the end of each line.
Drivers however may ignore the requested value, returning
<code class="docutils literal notranslate"><span class="pre">width</span></code> times bytes-per-pixel or a larger value required by the
hardware. That implies applications can just set this field to
zero to get a reasonable default.</p>
<p>For <em>Video Output Overlays</em> the driver must return a valid value.</p>
<p>Video hardware may access padding bytes, therefore they must
reside in accessible memory. Consider for example the case where
padding bytes after the last line of an image cross a system page
boundary. Capture devices may write padding bytes, the value is
undefined. Output devices ignore the contents of padding bytes.</p>
<p>When the image format is planar the <code class="docutils literal notranslate"><span class="pre">bytesperline</span></code> value applies
to the first plane and is divided by the same factor as the
<code class="docutils literal notranslate"><span class="pre">width</span></code> field for the other planes. For example the Cb and Cr
planes of a YUV 4:2:0 image have half as many padding bytes
following each line as the Y plane. To avoid ambiguities drivers
must return a <code class="docutils literal notranslate"><span class="pre">bytesperline</span></code> value rounded up to a multiple of
the scale factor.</p>
</td>
</tr>
<tr class="row-odd"><td></td>
<td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sizeimage</span></code></p></td>
<td><p>This field is irrelevant to <em>non-destructive Video Overlays</em>. For
<em>destructive Video Overlays</em> applications must initialize this
field. For <em>Video Output Overlays</em> the driver must return a valid
format.</p>
<p>Together with <code class="docutils literal notranslate"><span class="pre">base</span></code> it defines the framebuffer memory
accessible by the driver.</p>
</td>
</tr>
<tr class="row-even"><td></td>
<td><p>enum <a class="reference internal" href="colorspaces-defs.html#c.v4l2_colorspace" title="v4l2_colorspace"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_colorspace</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">colorspace</span></code></p></td>
<td><p>This information supplements the <code class="docutils literal notranslate"><span class="pre">pixelformat</span></code> and must be set
by the driver, see <a class="reference internal" href="colorspaces.html#colorspaces"><span class="std std-ref">Colorspaces</span></a>.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>__u32</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">priv</span></code></p></td>
<td><p>Reserved. Drivers and applications must set this field to zero.</p></td>
</tr>
</tbody>
</table>
<span id="framebuffer-cap"></span><table class="docutils align-default" id="id3">
<caption><span class="caption-text">Frame Buffer Capability Flags</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 38%" />
<col style="width: 13%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_CAP_EXTERNOVERLAY</span></code></p></td>
<td><p>0x0001</p></td>
<td><p>The device is capable of non-destructive overlays. When the driver
clears this flag, only destructive overlays are supported. There
are no drivers yet which support both destructive and
non-destructive overlays. Video Output Overlays are in practice
always non-destructive.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_CAP_CHROMAKEY</span></code></p></td>
<td><p>0x0002</p></td>
<td><p>The device supports clipping by chroma-keying the images. That is,
image pixels replace pixels in the VGA or video signal only where
the latter assume a certain color. Chroma-keying makes no sense
for destructive overlays.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_CAP_LIST_CLIPPING</span></code></p></td>
<td><p>0x0004</p></td>
<td><p>The device supports clipping using a list of clip rectangles.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_CAP_BITMAP_CLIPPING</span></code></p></td>
<td><p>0x0008</p></td>
<td><p>The device supports clipping using a bit mask.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_CAP_LOCAL_ALPHA</span></code></p></td>
<td><p>0x0010</p></td>
<td><p>The device supports clipping/blending using the alpha channel of
the framebuffer or VGA signal. Alpha blending makes no sense for
destructive overlays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_CAP_GLOBAL_ALPHA</span></code></p></td>
<td><p>0x0020</p></td>
<td><p>The device supports alpha blending using a global alpha value.
Alpha blending makes no sense for destructive overlays.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_CAP_LOCAL_INV_ALPHA</span></code></p></td>
<td><p>0x0040</p></td>
<td><p>The device supports clipping/blending using the inverted alpha
channel of the framebuffer or VGA signal. Alpha blending makes no
sense for destructive overlays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_CAP_SRC_CHROMAKEY</span></code></p></td>
<td><p>0x0080</p></td>
<td><p>The device supports Source Chroma-keying. Video pixels with the
chroma-key colors are replaced by framebuffer pixels, which is
exactly opposite of <code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_CAP_CHROMAKEY</span></code></p></td>
</tr>
</tbody>
</table>
<span id="framebuffer-flags"></span><table class="longtable docutils align-default" id="id4">
<caption><span class="caption-text">Frame Buffer Flags</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 38%" />
<col style="width: 13%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_FLAG_PRIMARY</span></code></p></td>
<td><p>0x0001</p></td>
<td><p>The framebuffer is the primary graphics surface. In other words,
the overlay is destructive. This flag is typically set by any
driver that doesn’t have the <code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_CAP_EXTERNOVERLAY</span></code>
capability and it is cleared otherwise.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_FLAG_OVERLAY</span></code></p></td>
<td><p>0x0002</p></td>
<td><p>If this flag is set for a video capture device, then the driver
will set the initial overlay size to cover the full framebuffer
size, otherwise the existing overlay size (as set by
<a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a>) will be used. Only one
video capture driver (bttv) supports this flag. The use of this
flag for capture devices is deprecated. There is no way to detect
which drivers support this flag, so the only reliable method of
setting the overlay size is through
<a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a>. If this flag is set for a
video output device, then the video output overlay window is
relative to the top-left corner of the framebuffer and restricted
to the size of the framebuffer. If it is cleared, then the video
output overlay window is relative to the video output display.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_FLAG_CHROMAKEY</span></code></p></td>
<td><p>0x0004</p></td>
<td><p>Use chroma-keying. The chroma-key color is determined by the
<code class="docutils literal notranslate"><span class="pre">chromakey</span></code> field of struct <a class="reference internal" href="dev-overlay.html#c.v4l2_window" title="v4l2_window"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_window</span></code></a>
and negotiated with the <a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a>
ioctl, see <a class="reference internal" href="dev-overlay.html#overlay"><span class="std std-ref">Video Overlay Interface</span></a> and <a class="reference internal" href="dev-osd.html#osd"><span class="std std-ref">Video Output Overlay Interface</span></a>.</p></td>
</tr>
<tr class="row-even"><td colspan="3"><p> There are no flags to enable clipping using a list of
clip rectangles or a bitmap. These methods are negotiated with the
<a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a> ioctl, see <a class="reference internal" href="dev-overlay.html#overlay"><span class="std std-ref">Video Overlay Interface</span></a>
and <a class="reference internal" href="dev-osd.html#osd"><span class="std std-ref">Video Output Overlay Interface</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_FLAG_LOCAL_ALPHA</span></code></p></td>
<td><p>0x0008</p></td>
<td><p>Use the alpha channel of the framebuffer to clip or blend
framebuffer pixels with video images. The blend function is:
output = framebuffer pixel * alpha + video pixel * (1 - alpha).
The actual alpha depth depends on the framebuffer pixel format.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_FLAG_GLOBAL_ALPHA</span></code></p></td>
<td><p>0x0010</p></td>
<td><p>Use a global alpha value to blend the framebuffer with video
images. The blend function is: output = (framebuffer pixel * alpha
+ video pixel * (255 - alpha)) / 255. The alpha value is
determined by the <code class="docutils literal notranslate"><span class="pre">global_alpha</span></code> field of struct
<a class="reference internal" href="dev-overlay.html#c.v4l2_window" title="v4l2_window"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_window</span></code></a> and negotiated with the
<a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a> ioctl, see <a class="reference internal" href="dev-overlay.html#overlay"><span class="std std-ref">Video Overlay Interface</span></a>
and <a class="reference internal" href="dev-osd.html#osd"><span class="std std-ref">Video Output Overlay Interface</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_FLAG_LOCAL_INV_ALPHA</span></code></p></td>
<td><p>0x0020</p></td>
<td><p>Like <code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_FLAG_LOCAL_ALPHA</span></code>, use the alpha channel of the
framebuffer to clip or blend framebuffer pixels with video images,
but with an inverted alpha value. The blend function is: output =
framebuffer pixel * (1 - alpha) + video pixel * alpha. The actual
alpha depth depends on the framebuffer pixel format.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V4L2_FBUF_FLAG_SRC_CHROMAKEY</span></code></p></td>
<td><p>0x0040</p></td>
<td><p>Use source chroma-keying. The source chroma-key color is
determined by the <code class="docutils literal notranslate"><span class="pre">chromakey</span></code> field of struct
<a class="reference internal" href="dev-overlay.html#c.v4l2_window" title="v4l2_window"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_window</span></code></a> and negotiated with the
<a class="reference internal" href="vidioc-g-fmt.html#vidioc-g-fmt"><span class="std std-ref">VIDIOC_S_FMT</span></a> ioctl, see <a class="reference internal" href="dev-overlay.html#overlay"><span class="std std-ref">Video Overlay Interface</span></a>
and <a class="reference internal" href="dev-osd.html#osd"><span class="std std-ref">Video Output Overlay Interface</span></a>. Both chroma-keying are mutual exclusive to each
other, so same <code class="docutils literal notranslate"><span class="pre">chromakey</span></code> field of struct
<a class="reference internal" href="dev-overlay.html#c.v4l2_window" title="v4l2_window"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_window</span></code></a> is being used.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="return-value">
<h2><span class="section-number">7.30.5. </span>Return Value<a class="headerlink" href="#return-value" title="Permalink to this headline">¶</a></h2>
<p>On success 0 is returned, on error -1 and the <code class="docutils literal notranslate"><span class="pre">errno</span></code> variable is set
appropriately. The generic error codes are described at the
<a class="reference internal" href="../gen-errors.html#id1"><span class="std std-ref">Generic Error Codes</span></a> chapter.</p>
<dl class="simple">
<dt>EPERM</dt><dd><p><a class="reference internal" href="#vidioc-g-fbuf"><span class="std std-ref">VIDIOC_S_FBUF</span></a> can only be called by a privileged user to
negotiate the parameters for a destructive overlay.</p>
</dd>
<dt>EINVAL</dt><dd><p>The <a class="reference internal" href="#vidioc-g-fbuf"><span class="std std-ref">VIDIOC_S_FBUF</span></a> parameters are unsuitable.</p>
</dd>
</dl>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>A physical base address may not suit all platforms. GK notes in
theory we should pass something like PCI device + memory region +
offset instead. If you encounter problems please discuss on the
linux-media mailing list:
<a class="reference external" href="https://linuxtv.org/lists.php">https://linuxtv.org/lists.php</a>.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="vidioc-g-fmt.html" class="btn btn-neutral float-right" title="7.31. ioctl VIDIOC_G_FMT, VIDIOC_S_FMT, VIDIOC_TRY_FMT" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="vidioc-g-ext-ctrls.html" class="btn btn-neutral float-left" title="7.29. ioctl VIDIOC_G_EXT_CTRLS, VIDIOC_S_EXT_CTRLS, VIDIOC_TRY_EXT_CTRLS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright The kernel development community

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>